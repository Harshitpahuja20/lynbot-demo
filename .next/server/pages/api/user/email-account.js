"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/user/email-account";
exports.ids = ["pages/api/user/email-account"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "bcryptjs":
/*!***************************!*\
  !*** external "bcryptjs" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("bcryptjs");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Femail-account&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cuser%5Cemail-account.ts&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Femail-account&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cuser%5Cemail-account.ts&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_user_email_account_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\user\\email-account.ts */ \"(api)/./pages/api/user/email-account.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_user_email_account_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_user_email_account_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/user/email-account\",\n        pathname: \"/api/user/email-account\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_user_email_account_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnVzZXIlMkZlbWFpbC1hY2NvdW50JnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUN1c2VyJTVDZW1haWwtYWNjb3VudC50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUNpRTtBQUNqRTtBQUNBLGlFQUFlLHdFQUFLLENBQUMsNkRBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLDZEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL2x5bmNib3QtbmV4dGpzLz9mZjg3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcdXNlclxcXFxlbWFpbC1hY2NvdW50LnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdXNlci9lbWFpbC1hY2NvdW50XCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdXNlci9lbWFpbC1hY2NvdW50XCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Femail-account&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cuser%5Cemail-account.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/supabase.ts":
/*!*************************!*\
  !*** ./lib/supabase.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createClient: () => (/* binding */ getSupabaseClient),\n/* harmony export */   getSupabaseAdminClient: () => (/* binding */ getSupabaseAdminClient),\n/* harmony export */   getSupabaseClient: () => (/* binding */ getSupabaseClient),\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n\n// Client instances (lazy initialization)\nlet _supabase = null;\nlet _supabaseAdmin = null;\nfunction getSupabaseClient() {\n    if (!_supabase) {\n        const supabaseUrl = \"https://djqtqxnvgjjeeazwnyqn.supabase.co\";\n        const supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRqcXRxeG52Z2pqZWVhendueXFuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NjM4OTUsImV4cCI6MjA3NzEzOTg5NX0.zQZax1gQYZSUc30y5iGscT7J9wjVQQCZODuUrc6hPzw\";\n        if (!supabaseUrl || !supabaseAnonKey) {\n            console.warn(\"Supabase environment variables not found. Please configure Supabase integration.\");\n            // Return a mock client that won't cause errors\n            return {\n                from: ()=>({\n                        select: ()=>Promise.resolve({\n                                data: [],\n                                error: null\n                            }),\n                        insert: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        update: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        delete: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            })\n                    })\n            };\n        }\n        _supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n    }\n    return _supabase;\n}\nfunction getSupabaseAdminClient() {\n    if (!_supabaseAdmin) {\n        const supabaseUrl = \"https://djqtqxnvgjjeeazwnyqn.supabase.co\";\n        const supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n        if (!supabaseUrl || !supabaseServiceRoleKey) {\n            console.warn(\"Supabase admin environment variables not found. Please configure Supabase integration.\");\n            // Return a mock client that won't cause errors\n            return {\n                from: ()=>({\n                        select: ()=>Promise.resolve({\n                                data: [],\n                                error: null\n                            }),\n                        insert: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        update: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        delete: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            })\n                    })\n            };\n        }\n        _supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceRoleKey);\n    }\n    return _supabaseAdmin;\n}\n// Export lazy getters for backward compatibility\nconst supabase = new Proxy({}, {\n    get (target, prop) {\n        return getSupabaseClient()[prop];\n    }\n});\nconst supabaseAdmin = new Proxy({}, {\n    get (target, prop) {\n        return getSupabaseAdminClient()[prop];\n    }\n});\n// Export the client directly for compatibility with utils/supabase.ts\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvc3VwYWJhc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFxRDtBQUdyRCx5Q0FBeUM7QUFDekMsSUFBSUMsWUFBbUM7QUFDdkMsSUFBSUMsaUJBQXdDO0FBRXJDLFNBQVNDO0lBQ2QsSUFBSSxDQUFDRixXQUFXO1FBQ2QsTUFBTUcsY0FBY0MsMENBQW9DO1FBQ3hELE1BQU1HLGtCQUFrQkgsa05BQXlDO1FBRWpFLElBQUksQ0FBQ0QsZUFBZSxDQUFDSSxpQkFBaUI7WUFDcENFLFFBQVFDLElBQUksQ0FBQztZQUNiLCtDQUErQztZQUMvQyxPQUFPO2dCQUNMQyxNQUFNLElBQU87d0JBQ1hDLFFBQVEsSUFBTUMsUUFBUUMsT0FBTyxDQUFDO2dDQUFFQyxNQUFNLEVBQUU7Z0NBQUVDLE9BQU87NEJBQUs7d0JBQ3REQyxRQUFRLElBQU1KLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGQyxRQUFRLElBQU1OLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGRSxRQUFRLElBQU1QLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7b0JBQzVGO1lBQ0Y7UUFDRjtRQUVBbEIsWUFBWUQsbUVBQVlBLENBQUNJLGFBQWFJO0lBQ3hDO0lBRUEsT0FBT1A7QUFDVDtBQUVPLFNBQVNxQjtJQUNkLElBQUksQ0FBQ3BCLGdCQUFnQjtRQUNuQixNQUFNRSxjQUFjQywwQ0FBb0M7UUFDeEQsTUFBTWtCLHlCQUF5QmxCLFFBQVFDLEdBQUcsQ0FBQ2tCLHlCQUF5QjtRQUVwRSxJQUFJLENBQUNwQixlQUFlLENBQUNtQix3QkFBd0I7WUFDM0NiLFFBQVFDLElBQUksQ0FBQztZQUNiLCtDQUErQztZQUMvQyxPQUFPO2dCQUNMQyxNQUFNLElBQU87d0JBQ1hDLFFBQVEsSUFBTUMsUUFBUUMsT0FBTyxDQUFDO2dDQUFFQyxNQUFNLEVBQUU7Z0NBQUVDLE9BQU87NEJBQUs7d0JBQ3REQyxRQUFRLElBQU1KLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGQyxRQUFRLElBQU1OLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGRSxRQUFRLElBQU1QLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7b0JBQzVGO1lBQ0Y7UUFDRjtRQUVBakIsaUJBQWlCRixtRUFBWUEsQ0FBQ0ksYUFBYW1CO0lBQzdDO0lBRUEsT0FBT3JCO0FBQ1Q7QUFFQSxpREFBaUQ7QUFDMUMsTUFBTXVCLFdBQVcsSUFBSUMsTUFBTSxDQUFDLEdBQXFCO0lBQ3REQyxLQUFJQyxNQUFNLEVBQUVDLElBQUk7UUFDZCxPQUFPMUIsbUJBQW1CLENBQUMwQixLQUE2QjtJQUMxRDtBQUNGLEdBQUc7QUFFSSxNQUFNQyxnQkFBZ0IsSUFBSUosTUFBTSxDQUFDLEdBQXFCO0lBQzNEQyxLQUFJQyxNQUFNLEVBQUVDLElBQUk7UUFDZCxPQUFPUCx3QkFBd0IsQ0FBQ08sS0FBNkI7SUFDL0Q7QUFDRixHQUFHO0FBRUgsc0VBQXNFO0FBQ3pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbHluY2JvdC1uZXh0anMvLi9saWIvc3VwYWJhc2UudHM/Yzk5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xyXG5pbXBvcnQgdHlwZSB7IFN1cGFiYXNlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcclxuXHJcbi8vIENsaWVudCBpbnN0YW5jZXMgKGxhenkgaW5pdGlhbGl6YXRpb24pXHJcbmxldCBfc3VwYWJhc2U6IFN1cGFiYXNlQ2xpZW50IHwgbnVsbCA9IG51bGw7XHJcbmxldCBfc3VwYWJhc2VBZG1pbjogU3VwYWJhc2VDbGllbnQgfCBudWxsID0gbnVsbDtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTdXBhYmFzZUNsaWVudCgpOiBTdXBhYmFzZUNsaWVudCB7XHJcbiAgaWYgKCFfc3VwYWJhc2UpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xyXG4gICAgY29uc3Qgc3VwYWJhc2VBbm9uS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVk7XHJcblxyXG4gICAgaWYgKCFzdXBhYmFzZVVybCB8fCAhc3VwYWJhc2VBbm9uS2V5KSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignU3VwYWJhc2UgZW52aXJvbm1lbnQgdmFyaWFibGVzIG5vdCBmb3VuZC4gUGxlYXNlIGNvbmZpZ3VyZSBTdXBhYmFzZSBpbnRlZ3JhdGlvbi4nKTtcclxuICAgICAgLy8gUmV0dXJuIGEgbW9jayBjbGllbnQgdGhhdCB3b24ndCBjYXVzZSBlcnJvcnNcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBmcm9tOiAoKSA9PiAoe1xyXG4gICAgICAgICAgc2VsZWN0OiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBbXSwgZXJyb3I6IG51bGwgfSksXHJcbiAgICAgICAgICBpbnNlcnQ6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IG51bGwsIGVycm9yOiB7IG1lc3NhZ2U6ICdTdXBhYmFzZSBub3QgY29uZmlndXJlZCcgfSB9KSxcclxuICAgICAgICAgIHVwZGF0ZTogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogbnVsbCwgZXJyb3I6IHsgbWVzc2FnZTogJ1N1cGFiYXNlIG5vdCBjb25maWd1cmVkJyB9IH0pLFxyXG4gICAgICAgICAgZGVsZXRlOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBudWxsLCBlcnJvcjogeyBtZXNzYWdlOiAnU3VwYWJhc2Ugbm90IGNvbmZpZ3VyZWQnIH0gfSlcclxuICAgICAgICB9KVxyXG4gICAgICB9IGFzIGFueTtcclxuICAgIH1cclxuXHJcbiAgICBfc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSk7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBfc3VwYWJhc2U7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KCk6IFN1cGFiYXNlQ2xpZW50IHtcclxuICBpZiAoIV9zdXBhYmFzZUFkbWluKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcclxuICAgIGNvbnN0IHN1cGFiYXNlU2VydmljZVJvbGVLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZO1xyXG5cclxuICAgIGlmICghc3VwYWJhc2VVcmwgfHwgIXN1cGFiYXNlU2VydmljZVJvbGVLZXkpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdTdXBhYmFzZSBhZG1pbiBlbnZpcm9ubWVudCB2YXJpYWJsZXMgbm90IGZvdW5kLiBQbGVhc2UgY29uZmlndXJlIFN1cGFiYXNlIGludGVncmF0aW9uLicpO1xyXG4gICAgICAvLyBSZXR1cm4gYSBtb2NrIGNsaWVudCB0aGF0IHdvbid0IGNhdXNlIGVycm9yc1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGZyb206ICgpID0+ICh7XHJcbiAgICAgICAgICBzZWxlY3Q6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IFtdLCBlcnJvcjogbnVsbCB9KSxcclxuICAgICAgICAgIGluc2VydDogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogbnVsbCwgZXJyb3I6IHsgbWVzc2FnZTogJ1N1cGFiYXNlIG5vdCBjb25maWd1cmVkJyB9IH0pLFxyXG4gICAgICAgICAgdXBkYXRlOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBudWxsLCBlcnJvcjogeyBtZXNzYWdlOiAnU3VwYWJhc2Ugbm90IGNvbmZpZ3VyZWQnIH0gfSksXHJcbiAgICAgICAgICBkZWxldGU6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IG51bGwsIGVycm9yOiB7IG1lc3NhZ2U6ICdTdXBhYmFzZSBub3QgY29uZmlndXJlZCcgfSB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0gYXMgYW55O1xyXG4gICAgfVxyXG5cclxuICAgIF9zdXBhYmFzZUFkbWluID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZVNlcnZpY2VSb2xlS2V5KTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIF9zdXBhYmFzZUFkbWluO1xyXG59XHJcblxyXG4vLyBFeHBvcnQgbGF6eSBnZXR0ZXJzIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XHJcbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IG5ldyBQcm94eSh7fSBhcyBTdXBhYmFzZUNsaWVudCwge1xyXG4gIGdldCh0YXJnZXQsIHByb3ApIHtcclxuICAgIHJldHVybiBnZXRTdXBhYmFzZUNsaWVudCgpW3Byb3AgYXMga2V5b2YgU3VwYWJhc2VDbGllbnRdO1xyXG4gIH1cclxufSk7XHJcblxyXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VBZG1pbiA9IG5ldyBQcm94eSh7fSBhcyBTdXBhYmFzZUNsaWVudCwge1xyXG4gIGdldCh0YXJnZXQsIHByb3ApIHtcclxuICAgIHJldHVybiBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KClbcHJvcCBhcyBrZXlvZiBTdXBhYmFzZUNsaWVudF07XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIEV4cG9ydCB0aGUgY2xpZW50IGRpcmVjdGx5IGZvciBjb21wYXRpYmlsaXR5IHdpdGggdXRpbHMvc3VwYWJhc2UudHNcclxuZXhwb3J0IHsgZ2V0U3VwYWJhc2VDbGllbnQgYXMgY3JlYXRlQ2xpZW50IH07Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsIl9zdXBhYmFzZSIsIl9zdXBhYmFzZUFkbWluIiwiZ2V0U3VwYWJhc2VDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImNvbnNvbGUiLCJ3YXJuIiwiZnJvbSIsInNlbGVjdCIsIlByb21pc2UiLCJyZXNvbHZlIiwiZGF0YSIsImVycm9yIiwiaW5zZXJ0IiwibWVzc2FnZSIsInVwZGF0ZSIsImRlbGV0ZSIsImdldFN1cGFiYXNlQWRtaW5DbGllbnQiLCJzdXBhYmFzZVNlcnZpY2VSb2xlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInN1cGFiYXNlIiwiUHJveHkiLCJnZXQiLCJ0YXJnZXQiLCJwcm9wIiwic3VwYWJhc2VBZG1pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/supabase.ts\n");

/***/ }),

/***/ "(api)/./pages/api/user/email-account.ts":
/*!*****************************************!*\
  !*** ./pages/api/user/email-account.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"bcryptjs\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/supabase */ \"(api)/./lib/supabase.ts\");\n\n\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key\";\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        res.setHeader(\"Allow\", [\n            \"POST\"\n        ]);\n        return res.status(405).json({\n            success: false,\n            error: `Method ${req.method} not allowed`\n        });\n    }\n    try {\n        // Authenticate user\n        const token = req.headers.authorization?.replace(\"Bearer \", \"\");\n        if (!token) {\n            return res.status(401).json({\n                success: false,\n                error: \"Authentication required\"\n            });\n        }\n        let decoded;\n        try {\n            decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, JWT_SECRET);\n        } catch (err) {\n            console.error(\"JWT verification failed\", err);\n            return res.status(401).json({\n                success: false,\n                error: \"Invalid or expired token\"\n            });\n        }\n        const userId = decoded.id;\n        const { email, password, provider, smtpSettings, imapSettings } = req.body;\n        if (!email) {\n            return res.status(400).json({\n                success: false,\n                error: \"Email address is required\"\n            });\n        }\n        // Validate email format\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!emailRegex.test(email)) {\n            return res.status(400).json({\n                success: false,\n                error: \"Please enter a valid email address\"\n            });\n        }\n        // Normalize/validate provider (default to 'smtp' if not provided)\n        const finalProvider = provider || \"smtp\";\n        if (![\n            \"gmail\",\n            \"outlook\",\n            \"smtp\"\n        ].includes(finalProvider)) {\n            return res.status(400).json({\n                success: false,\n                error: \"Invalid email provider\"\n            });\n        }\n        // Encrypt the password if provided\n        let encryptedPassword;\n        if (password) {\n            const salt = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().genSalt(12);\n            encryptedPassword = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash(password, salt);\n        }\n        // Ensure Supabase admin client env vars are present\n        if ( false || !process.env.SUPABASE_SERVICE_ROLE_KEY) {\n            console.error(\"Supabase admin environment variables missing\");\n            return res.status(500).json({\n                success: false,\n                error: \"Supabase not configured on the server\"\n            });\n        }\n        // Find user and update email accounts\n        const supabase = (0,_lib_supabase__WEBPACK_IMPORTED_MODULE_2__.getSupabaseAdminClient)();\n        const { data: user, error: userError } = await supabase.from(\"users\").select(\"*\").eq(\"id\", userId).single();\n        if (userError || !user) {\n            console.error(\"User lookup failed\", userError);\n            return res.status(404).json({\n                success: false,\n                error: userError && (userError.message || userError) || \"User not found\"\n            });\n        }\n        // Check if email account with this email already exists\n        const existingAccountIndex = (user.email_accounts || []).findIndex((account)=>account.email === email);\n        const updatedEmailAccounts = [\n            ...user.email_accounts || []\n        ];\n        if (existingAccountIndex >= 0) {\n            // Update existing account\n            updatedEmailAccounts[existingAccountIndex] = {\n                ...updatedEmailAccounts[existingAccountIndex],\n                ...encryptedPassword && {\n                    encryptedPassword\n                },\n                provider: finalProvider,\n                ...smtpSettings && {\n                    smtpSettings\n                },\n                ...imapSettings && {\n                    imapSettings\n                },\n                isActive: true,\n                lastUsed: new Date().toISOString()\n            };\n        } else {\n            // Add new email account\n            updatedEmailAccounts.push({\n                email: email,\n                encryptedPassword: encryptedPassword,\n                provider: finalProvider,\n                ...smtpSettings && {\n                    smtpSettings\n                },\n                ...imapSettings && {\n                    imapSettings\n                },\n                isActive: true,\n                lastUsed: new Date().toISOString(),\n                lastSyncAt: new Date().toISOString(),\n                dailyLimits: {\n                    emails: 50\n                },\n                dailyUsage: {\n                    emails: 0,\n                    lastReset: new Date().toISOString()\n                },\n                accountHealth: {\n                    status: \"healthy\",\n                    lastCheck: new Date().toISOString(),\n                    restrictions: []\n                }\n            });\n        }\n        const { error: updateError } = await supabase.from(\"users\").update({\n            email_accounts: updatedEmailAccounts\n        }).eq(\"id\", userId);\n        if (updateError) {\n            console.error(\"Error updating user:\", updateError);\n            return res.status(500).json({\n                success: false,\n                error: updateError.message || \"Failed to save email account\"\n            });\n        }\n        console.log(`Email account saved for user: ${user.email}`);\n        res.json({\n            success: true,\n            message: \"Email account saved successfully\"\n        });\n    } catch (error) {\n        console.error(\"Error saving email account:\", error);\n        res.status(500).json({\n            success: false,\n            error: \"Failed to save email account\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGVBQWU7b0JBQ2J0RCxRQUFRO29CQUNSdUQsV0FBVyxJQUFJVCxPQUFPQyxXQUFXO29CQUNqQ1MsY0FBYyxFQUFFO2dCQUNsQjtZQUNGO1FBQ0Y7UUFFQSxNQUFNLEVBQUVyRCxPQUFPc0QsV0FBVyxFQUFFLEdBQUcsTUFBTTNCLFNBQ2xDSSxJQUFJLENBQUMsU0FDTHdCLE1BQU0sQ0FBQztZQUNObEIsZ0JBQWdCRztRQUNsQixHQUNDUCxFQUFFLENBQUMsTUFBTXhCO1FBRVosSUFBSTZDLGFBQWE7WUFDZjlDLFFBQVFSLEtBQUssQ0FBQyx3QkFBd0JzRDtZQUN0QyxPQUFPNUQsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFDMUJDLFNBQVM7Z0JBQ1RDLE9BQU9zRCxZQUFZbkIsT0FBTyxJQUFJO1lBQ2hDO1FBQ0Y7UUFFQTNCLFFBQVFnRCxHQUFHLENBQUMsQ0FBQyw4QkFBOEIsRUFBRTNCLEtBQUtsQixLQUFLLENBQUMsQ0FBQztRQUV6RGpCLElBQUlJLElBQUksQ0FBQztZQUNQQyxTQUFTO1lBQ1RvQyxTQUFTO1FBQ1g7SUFFRixFQUFFLE9BQU9uQyxPQUFPO1FBQ2RRLFFBQVFSLEtBQUssQ0FBQywrQkFBK0JBO1FBQzdDTixJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQ25CQyxTQUFTO1lBQ1RDLE9BQU87UUFDVDtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9seW5jYm90LW5leHRqcy8uL3BhZ2VzL2FwaS91c2VyL2VtYWlsLWFjY291bnQudHM/ZTkzZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcclxuaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QgfSBmcm9tICduZXh0JztcclxuaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xyXG5pbXBvcnQgYmNyeXB0IGZyb20gJ2JjcnlwdGpzJztcclxuaW1wb3J0IHsgZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCB9IGZyb20gJy4uLy4uLy4uL2xpYi9zdXBhYmFzZSc7XHJcblxyXG5jb25zdCBKV1RfU0VDUkVUID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAneW91ci1zZWNyZXQta2V5JztcclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcclxuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XHJcbiAgICByZXMuc2V0SGVhZGVyKCdBbGxvdycsIFsnUE9TVCddKTtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogYE1ldGhvZCAke3JlcS5tZXRob2R9IG5vdCBhbGxvd2VkYFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgLy8gQXV0aGVudGljYXRlIHVzZXJcclxuICAgIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbj8ucmVwbGFjZSgnQmVhcmVyICcsICcnKTtcclxuICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgZGVjb2RlZDogYW55O1xyXG4gICAgdHJ5IHtcclxuICAgICAgZGVjb2RlZCA9IGp3dC52ZXJpZnkodG9rZW4sIEpXVF9TRUNSRVQpIGFzIGFueTtcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdKV1QgdmVyaWZpY2F0aW9uIGZhaWxlZCcsIGVycik7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ludmFsaWQgb3IgZXhwaXJlZCB0b2tlbicgfSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB1c2VySWQgPSBkZWNvZGVkLmlkO1xyXG5cclxuICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkLCBwcm92aWRlciwgc210cFNldHRpbmdzLCBpbWFwU2V0dGluZ3MgfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgIGlmICghZW1haWwpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0VtYWlsIGFkZHJlc3MgaXMgcmVxdWlyZWQnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZhbGlkYXRlIGVtYWlsIGZvcm1hdFxyXG4gICAgY29uc3QgZW1haWxSZWdleCA9IC9eW15cXHNAXStAW15cXHNAXStcXC5bXlxcc0BdKyQvO1xyXG4gICAgaWYgKCFlbWFpbFJlZ2V4LnRlc3QoZW1haWwpKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBOb3JtYWxpemUvdmFsaWRhdGUgcHJvdmlkZXIgKGRlZmF1bHQgdG8gJ3NtdHAnIGlmIG5vdCBwcm92aWRlZClcclxuICAgIGNvbnN0IGZpbmFsUHJvdmlkZXIgPSBwcm92aWRlciB8fCAnc210cCc7XHJcbiAgICBpZiAoIVsnZ21haWwnLCAnb3V0bG9vaycsICdzbXRwJ10uaW5jbHVkZXMoZmluYWxQcm92aWRlcikpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0ludmFsaWQgZW1haWwgcHJvdmlkZXInXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEVuY3J5cHQgdGhlIHBhc3N3b3JkIGlmIHByb3ZpZGVkXHJcbiAgICBsZXQgZW5jcnlwdGVkUGFzc3dvcmQ7XHJcbiAgICBpZiAocGFzc3dvcmQpIHtcclxuICAgICAgY29uc3Qgc2FsdCA9IGF3YWl0IGJjcnlwdC5nZW5TYWx0KDEyKTtcclxuICAgICAgZW5jcnlwdGVkUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgc2FsdCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRW5zdXJlIFN1cGFiYXNlIGFkbWluIGNsaWVudCBlbnYgdmFycyBhcmUgcHJlc2VudFxyXG4gICAgaWYgKCFwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgfHwgIXByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2UgYWRtaW4gZW52aXJvbm1lbnQgdmFyaWFibGVzIG1pc3NpbmcnKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnU3VwYWJhc2Ugbm90IGNvbmZpZ3VyZWQgb24gdGhlIHNlcnZlcicgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRmluZCB1c2VyIGFuZCB1cGRhdGUgZW1haWwgYWNjb3VudHNcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBkYXRhOiB1c2VyLCBlcnJvcjogdXNlckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgndXNlcnMnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdpZCcsIHVzZXJJZClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmICh1c2VyRXJyb3IgfHwgIXVzZXIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignVXNlciBsb29rdXAgZmFpbGVkJywgdXNlckVycm9yKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogKHVzZXJFcnJvciAmJiAodXNlckVycm9yLm1lc3NhZ2UgfHwgdXNlckVycm9yKSkgfHwgJ1VzZXIgbm90IGZvdW5kJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBpZiBlbWFpbCBhY2NvdW50IHdpdGggdGhpcyBlbWFpbCBhbHJlYWR5IGV4aXN0c1xyXG4gICAgY29uc3QgZXhpc3RpbmdBY2NvdW50SW5kZXggPSAodXNlci5lbWFpbF9hY2NvdW50cyB8fCBbXSkuZmluZEluZGV4KFxyXG4gICAgICAoYWNjb3VudDogYW55KSA9PiBhY2NvdW50LmVtYWlsID09PSBlbWFpbFxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCB1cGRhdGVkRW1haWxBY2NvdW50cyA9IFsuLi4odXNlci5lbWFpbF9hY2NvdW50cyB8fCBbXSldO1xyXG5cclxuICAgIGlmIChleGlzdGluZ0FjY291bnRJbmRleCA+PSAwKSB7XHJcbiAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBhY2NvdW50XHJcbiAgICAgIHVwZGF0ZWRFbWFpbEFjY291bnRzW2V4aXN0aW5nQWNjb3VudEluZGV4XSA9IHtcclxuICAgICAgICAuLi51cGRhdGVkRW1haWxBY2NvdW50c1tleGlzdGluZ0FjY291bnRJbmRleF0sXHJcbiAgLi4uKGVuY3J5cHRlZFBhc3N3b3JkICYmIHsgZW5jcnlwdGVkUGFzc3dvcmQgfSksXHJcbiAgcHJvdmlkZXI6IGZpbmFsUHJvdmlkZXIsXHJcbiAgICAgICAgLi4uKHNtdHBTZXR0aW5ncyAmJiB7IHNtdHBTZXR0aW5ncyB9KSxcclxuICAgICAgICAuLi4oaW1hcFNldHRpbmdzICYmIHsgaW1hcFNldHRpbmdzIH0pLFxyXG4gICAgICAgIGlzQWN0aXZlOiB0cnVlLFxyXG4gICAgICAgIGxhc3RVc2VkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIEFkZCBuZXcgZW1haWwgYWNjb3VudFxyXG4gICAgICB1cGRhdGVkRW1haWxBY2NvdW50cy5wdXNoKHtcclxuICAgICAgICBlbWFpbDogZW1haWwsXHJcbiAgICAgICAgZW5jcnlwdGVkUGFzc3dvcmQ6IGVuY3J5cHRlZFBhc3N3b3JkLFxyXG4gIHByb3ZpZGVyOiBmaW5hbFByb3ZpZGVyLFxyXG4gICAgICAgIC4uLihzbXRwU2V0dGluZ3MgJiYgeyBzbXRwU2V0dGluZ3MgfSksXHJcbiAgICAgICAgLi4uKGltYXBTZXR0aW5ncyAmJiB7IGltYXBTZXR0aW5ncyB9KSxcclxuICAgICAgICBpc0FjdGl2ZTogdHJ1ZSxcclxuICAgICAgICBsYXN0VXNlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGxhc3RTeW5jQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICBkYWlseUxpbWl0czoge1xyXG4gICAgICAgICAgZW1haWxzOiA1MFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGFpbHlVc2FnZToge1xyXG4gICAgICAgICAgZW1haWxzOiAwLFxyXG4gICAgICAgICAgbGFzdFJlc2V0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFjY291bnRIZWFsdGg6IHtcclxuICAgICAgICAgIHN0YXR1czogJ2hlYWx0aHknLFxyXG4gICAgICAgICAgbGFzdENoZWNrOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICByZXN0cmljdGlvbnM6IFtdXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3VzZXJzJylcclxuICAgICAgLnVwZGF0ZSh7XHJcbiAgICAgICAgZW1haWxfYWNjb3VudHM6IHVwZGF0ZWRFbWFpbEFjY291bnRzXHJcbiAgICAgIH0pXHJcbiAgICAgIC5lcSgnaWQnLCB1c2VySWQpO1xyXG5cclxuICAgIGlmICh1cGRhdGVFcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyB1c2VyOicsIHVwZGF0ZUVycm9yKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogdXBkYXRlRXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIHNhdmUgZW1haWwgYWNjb3VudCdcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coYEVtYWlsIGFjY291bnQgc2F2ZWQgZm9yIHVzZXI6ICR7dXNlci5lbWFpbH1gKTtcclxuXHJcbiAgICByZXMuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIG1lc3NhZ2U6ICdFbWFpbCBhY2NvdW50IHNhdmVkIHN1Y2Nlc3NmdWxseSdcclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc2F2aW5nIGVtYWlsIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gc2F2ZSBlbWFpbCBhY2NvdW50J1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJqd3QiLCJiY3J5cHQiLCJnZXRTdXBhYmFzZUFkbWluQ2xpZW50IiwiSldUX1NFQ1JFVCIsInByb2Nlc3MiLCJlbnYiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic2V0SGVhZGVyIiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsInRva2VuIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJyZXBsYWNlIiwiZGVjb2RlZCIsInZlcmlmeSIsImVyciIsImNvbnNvbGUiLCJ1c2VySWQiLCJpZCIsImVtYWlsIiwicGFzc3dvcmQiLCJwcm92aWRlciIsInNtdHBTZXR0aW5ncyIsImltYXBTZXR0aW5ncyIsImJvZHkiLCJlbWFpbFJlZ2V4IiwidGVzdCIsImZpbmFsUHJvdmlkZXIiLCJpbmNsdWRlcyIsImVuY3J5cHRlZFBhc3N3b3JkIiwic2FsdCIsImdlblNhbHQiLCJoYXNoIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInN1cGFiYXNlIiwiZGF0YSIsInVzZXIiLCJ1c2VyRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJtZXNzYWdlIiwiZXhpc3RpbmdBY2NvdW50SW5kZXgiLCJlbWFpbF9hY2NvdW50cyIsImZpbmRJbmRleCIsImFjY291bnQiLCJ1cGRhdGVkRW1haWxBY2NvdW50cyIsImlzQWN0aXZlIiwibGFzdFVzZWQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJwdXNoIiwibGFzdFN5bmNBdCIsImRhaWx5TGltaXRzIiwiZW1haWxzIiwiZGFpbHlVc2FnZSIsImxhc3RSZXNldCIsImFjY291bnRIZWFsdGgiLCJsYXN0Q2hlY2siLCJyZXN0cmljdGlvbnMiLCJ1cGRhdGVFcnJvciIsInVwZGF0ZSIsImxvZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/user/email-account.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Femail-account&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cuser%5Cemail-account.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();