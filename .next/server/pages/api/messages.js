"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/messages";
exports.ids = ["pages/api/messages"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "bcryptjs":
/*!***************************!*\
  !*** external "bcryptjs" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("bcryptjs");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmessages&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cmessages%5Cindex.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmessages&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cmessages%5Cindex.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_messages_index_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\messages\\index.ts */ \"(api)/./pages/api/messages/index.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_messages_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_messages_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/messages\",\n        pathname: \"/api/messages\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_messages_index_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRm1lc3NhZ2VzJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNtZXNzYWdlcyU1Q2luZGV4LnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzZEO0FBQzdEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx5REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMseURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbHluY2JvdC1uZXh0anMvPzkwMTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxtZXNzYWdlc1xcXFxpbmRleC50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL21lc3NhZ2VzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvbWVzc2FnZXNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmessages&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cmessages%5Cindex.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/database.ts":
/*!*************************!*\
  !*** ./lib/database.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   campaignOperations: () => (/* binding */ campaignOperations),\n/* harmony export */   messageOperations: () => (/* binding */ messageOperations),\n/* harmony export */   prospectOperations: () => (/* binding */ prospectOperations),\n/* harmony export */   userOperations: () => (/* binding */ userOperations)\n/* harmony export */ });\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(api)/./lib/supabase.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"bcryptjs\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// User operations\nconst userOperations = {\n    async create (userData) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        // Clean and validate user data\n        const cleanUserData = {\n            email: userData.email.toLowerCase(),\n            password_hash: userData.password_hash,\n            first_name: userData.first_name,\n            last_name: userData.last_name,\n            company: userData.company || null,\n            role: userData.role || \"user\",\n            subscription: userData.subscription || {\n                plan: \"free\",\n                status: \"inactive\"\n            },\n            email_verified: userData.email_verified !== undefined ? userData.email_verified : false,\n            onboarding_complete: userData.onboarding_complete !== undefined ? userData.onboarding_complete : false,\n            is_active: userData.is_active !== undefined ? userData.is_active : true,\n            linkedin_accounts: userData.linkedin_accounts || [],\n            email_accounts: userData.email_accounts || [],\n            api_keys: userData.api_keys || {},\n            settings: userData.settings || {\n                timezone: \"UTC\",\n                workingHours: {\n                    start: 9,\n                    end: 18\n                },\n                workingDays: [\n                    1,\n                    2,\n                    3,\n                    4,\n                    5\n                ],\n                automation: {\n                    enabled: false,\n                    connectionRequests: {\n                        enabled: false\n                    },\n                    welcomeMessages: {\n                        enabled: false\n                    },\n                    followUpMessages: {\n                        enabled: false\n                    },\n                    profileViews: {\n                        enabled: false\n                    }\n                },\n                notifications: {\n                    email: true,\n                    webhook: false\n                }\n            },\n            usage: userData.usage || {\n                totalConnections: 0,\n                totalMessages: 0,\n                totalCampaigns: 0,\n                totalProspects: 0\n            }\n        };\n        const { data, error } = await supabase.from(\"users\").insert([\n            cleanUserData\n        ]).select().single();\n        if (error) {\n            console.error(\"Database error creating user:\", error);\n            throw new Error(`Failed to create user: ${error.message}`);\n        }\n        if (!data) {\n            throw new Error(\"User creation failed - no data returned\");\n        }\n        return data;\n    },\n    async findByEmail (email) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"users\").select(\"*\").eq(\"email\", email.toLowerCase()).single();\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async findById (id) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"users\").select(\"*\").eq(\"id\", id).single();\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async update (id, updates) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"users\").update(updates).eq(\"id\", id).select().single();\n        if (error) throw error;\n        return data;\n    },\n    async delete (id) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { error } = await supabase.from(\"users\").delete().eq(\"id\", id);\n        if (error) throw error;\n    },\n    async findAll (options = {}) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        let query = supabase.from(\"users\").select(\"id, email, first_name, last_name, company, role, subscription, is_active, last_login, created_at\", {\n            count: \"exact\"\n        });\n        if (options.search) {\n            query = query.or(`email.ilike.%${options.search}%,first_name.ilike.%${options.search}%,last_name.ilike.%${options.search}%,company.ilike.%${options.search}%`);\n        }\n        if (options.role && options.role !== \"all\") {\n            query = query.eq(\"role\", options.role);\n        }\n        if (options.status && options.status !== \"all\") {\n            const isActive = options.status === \"active\";\n            query = query.eq(\"is_active\", isActive);\n        }\n        query = query.order(\"created_at\", {\n            ascending: false\n        });\n        if (options.limit) {\n            const from = ((options.page || 1) - 1) * options.limit;\n            const to = from + options.limit - 1;\n            query = query.range(from, to);\n        }\n        const { data, error, count } = await query;\n        if (error) throw error;\n        // Ensure we return valid data structure\n        const users = Array.isArray(data) ? data : [];\n        const total = typeof count === \"number\" ? count : 0;\n        return {\n            users,\n            total\n        };\n    },\n    async comparePassword (plainPassword, hashedPassword) {\n        return bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().compare(plainPassword, hashedPassword);\n    },\n    async hashPassword (password) {\n        const salt = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().genSalt(12);\n        return bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash(password, salt);\n    }\n};\n// Campaign operations\nconst campaignOperations = {\n    async create (campaignData) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"campaigns\").insert([\n            campaignData\n        ]).select().single();\n        if (error) throw error;\n        return data;\n    },\n    async findByUserId (userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"campaigns\").select(\"*\").eq(\"user_id\", userId).order(\"created_at\", {\n            ascending: false\n        });\n        if (error) throw error;\n        return data || [];\n    },\n    async findById (id, userId) {\n        console.log(id, userId);\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"campaigns\").select(\"*\").eq(\"id\", id).eq(\"user_id\", userId).single();\n        console.log(`data ${JSON.stringify(data)}`);\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async update (id, userId, updates) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"campaigns\").update(updates).eq(\"id\", id).eq(\"user_id\", userId).select().single();\n        if (error) throw error;\n        return data;\n    },\n    async delete (id, userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { error } = await supabase.from(\"campaigns\").delete().eq(\"id\", id).eq(\"user_id\", userId);\n        if (error) throw error;\n    }\n};\n// Prospect operations\nconst prospectOperations = {\n    async create (prospectData) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"prospects\").insert([\n            prospectData\n        ]).select().single();\n        if (error) throw error;\n        return data;\n    },\n    async findByUserId (userId, options) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        let query = supabase.from(\"prospects\").select(`*,campaigns!inner(id, name)`, {\n            count: \"exact\"\n        }).eq(\"user_id\", userId);\n        if (options?.search) {\n            query = query.or(`linkedin_data->>name.ilike.%${options.search}%,linkedin_data->>company.ilike.%${options.search}%,linkedin_data->>title.ilike.%${options.search}%`);\n        }\n        if (options?.status && options.status !== \"all\") {\n            query = query.eq(\"status\", options.status);\n        }\n        if (options?.campaignId && options.campaignId !== \"all\") {\n            query = query.eq(\"campaign_id\", options.campaignId);\n        }\n        query = query.order(\"created_at\", {\n            ascending: false\n        });\n        if (options?.limit) {\n            const from = ((options.page || 1) - 1) * options.limit;\n            const to = from + options.limit - 1;\n            query = query.range(from, to);\n        }\n        const { data, error, count } = await query;\n        if (error) throw error;\n        return {\n            items: data || [],\n            total: count ?? (data ? data.length : 0)\n        };\n    },\n    async findById (id, userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"prospects\").select(`\r\n        *,\r\n        campaigns!inner(id, name)\r\n      `).eq(\"id\", id).eq(\"user_id\", userId).single();\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async update (id, userId, updates) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"prospects\").update({\n            ...updates,\n            last_updated: new Date().toISOString()\n        }).eq(\"id\", id).eq(\"user_id\", userId).select(`\r\n        *,\r\n        campaigns!inner(id, name)\r\n      `).single();\n        if (error) throw error;\n        return data;\n    },\n    async delete (id, userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { error } = await supabase.from(\"prospects\").delete().eq(\"id\", id).eq(\"user_id\", userId);\n        if (error) throw error;\n    }\n};\n// Message operations\nconst messageOperations = {\n    async create (messageData) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseClient)();\n        const { data, error } = await supabase.from(\"messages\").insert([\n            messageData\n        ]).select(`\r\n        *,\r\n        prospects!inner(id, linkedin_data)\r\n      `).single();\n        if (error) throw error;\n        return data;\n    },\n    async findByUserId (userId, options) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseClient)();\n        let query = supabase.from(\"messages\").select(`\r\n        *,\r\n        prospects!inner(id, linkedin_data)\r\n      `).eq(\"user_id\", userId);\n        if (options?.conversationId) {\n            query = query.eq(\"conversation_id\", options.conversationId);\n            query = query.order(\"created_at\", {\n                ascending: true\n            });\n        } else {\n            query = query.order(\"created_at\", {\n                ascending: false\n            });\n        }\n        if (options?.limit) {\n            const from = ((options.page || 1) - 1) * options.limit;\n            const to = from + options.limit - 1;\n            query = query.range(from, to);\n        }\n        const { data, error } = await query;\n        if (error) throw error;\n        return data || [];\n    },\n    async findById (id, userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseClient)();\n        const { data, error } = await supabase.from(\"messages\").select(`\r\n        *,\r\n        prospects!inner(id, linkedin_data)\r\n      `).eq(\"id\", id).eq(\"user_id\", userId).single();\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async update (id, userId, updates) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseClient)();\n        const { data, error } = await supabase.from(\"messages\").update(updates).eq(\"id\", id).eq(\"user_id\", userId).select(`\r\n        *,\r\n        prospects!inner(id, linkedin_data)\r\n      `).single();\n        if (error) throw error;\n        return data;\n    },\n    async markAsRead (id, userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseClient)();\n        const { data, error } = await supabase.from(\"messages\").update({\n            status: \"read\",\n            read_at: new Date().toISOString(),\n            analytics: {\n                opened: true,\n                openedAt: new Date().toISOString()\n            }\n        }).eq(\"id\", id).eq(\"user_id\", userId).eq(\"type\", \"received\").select(`\r\n        *,\r\n        prospects!inner(id, linkedin_data)\r\n      `).single();\n        if (error) throw error;\n        return data;\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvZGF0YWJhc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFzRTtBQUN6QztBQXdaN0Isa0JBQWtCO0FBQ1gsTUFBTUcsaUJBQWlCO0lBQzVCLE1BQU1DLFFBQU9DLFFBQXdEO1FBQ25FLE1BQU1DLFdBQVdMLGlFQUFzQkE7UUFFdkMsK0JBQStCO1FBQy9CLE1BQU1NLGdCQUFnQjtZQUNwQkMsT0FBT0gsU0FBU0csS0FBSyxDQUFDQyxXQUFXO1lBQ2pDQyxlQUFlTCxTQUFTSyxhQUFhO1lBQ3JDQyxZQUFZTixTQUFTTSxVQUFVO1lBQy9CQyxXQUFXUCxTQUFTTyxTQUFTO1lBQzdCQyxTQUFTUixTQUFTUSxPQUFPLElBQUk7WUFDN0JDLE1BQU1ULFNBQVNTLElBQUksSUFBSTtZQUN2QkMsY0FBY1YsU0FBU1UsWUFBWSxJQUFJO2dCQUFFQyxNQUFNO2dCQUFRQyxRQUFRO1lBQVc7WUFDMUVDLGdCQUFnQmIsU0FBU2EsY0FBYyxLQUFLQyxZQUFZZCxTQUFTYSxjQUFjLEdBQUc7WUFDbEZFLHFCQUFxQmYsU0FBU2UsbUJBQW1CLEtBQUtELFlBQVlkLFNBQVNlLG1CQUFtQixHQUFHO1lBQ2pHQyxXQUFXaEIsU0FBU2dCLFNBQVMsS0FBS0YsWUFBWWQsU0FBU2dCLFNBQVMsR0FBRztZQUNuRUMsbUJBQW1CakIsU0FBU2lCLGlCQUFpQixJQUFJLEVBQUU7WUFDbkRDLGdCQUFnQmxCLFNBQVNrQixjQUFjLElBQUksRUFBRTtZQUM3Q0MsVUFBVW5CLFNBQVNtQixRQUFRLElBQUksQ0FBQztZQUNoQ0MsVUFBVXBCLFNBQVNvQixRQUFRLElBQUk7Z0JBQzdCQyxVQUFVO2dCQUNWQyxjQUFjO29CQUFFQyxPQUFPO29CQUFHQyxLQUFLO2dCQUFHO2dCQUNsQ0MsYUFBYTtvQkFBQztvQkFBRztvQkFBRztvQkFBRztvQkFBRztpQkFBRTtnQkFDNUJDLFlBQVk7b0JBQ1ZDLFNBQVM7b0JBQ1RDLG9CQUFvQjt3QkFBRUQsU0FBUztvQkFBTTtvQkFDckNFLGlCQUFpQjt3QkFBRUYsU0FBUztvQkFBTTtvQkFDbENHLGtCQUFrQjt3QkFBRUgsU0FBUztvQkFBTTtvQkFDbkNJLGNBQWM7d0JBQUVKLFNBQVM7b0JBQU07Z0JBQ2pDO2dCQUNBSyxlQUFlO29CQUNiN0IsT0FBTztvQkFDUDhCLFNBQVM7Z0JBQ1g7WUFDRjtZQUNBQyxPQUFPbEMsU0FBU2tDLEtBQUssSUFBSTtnQkFDdkJDLGtCQUFrQjtnQkFDbEJDLGVBQWU7Z0JBQ2ZDLGdCQUFnQjtnQkFDaEJDLGdCQUFnQjtZQUNsQjtRQUNGO1FBRUEsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU12QyxTQUMzQndDLElBQUksQ0FBQyxTQUNMQyxNQUFNLENBQUM7WUFBQ3hDO1NBQWMsRUFDdEJ5QyxNQUFNLEdBQ05DLE1BQU07UUFFVCxJQUFJSixPQUFPO1lBQ1RLLFFBQVFMLEtBQUssQ0FBQyxpQ0FBaUNBO1lBQy9DLE1BQU0sSUFBSU0sTUFBTSxDQUFDLHVCQUF1QixFQUFFTixNQUFNTyxPQUFPLENBQUMsQ0FBQztRQUMzRDtRQUVBLElBQUksQ0FBQ1IsTUFBTTtZQUNULE1BQU0sSUFBSU8sTUFBTTtRQUNsQjtRQUVBLE9BQU9QO0lBQ1Q7SUFFQSxNQUFNUyxhQUFZN0MsS0FBYTtRQUM3QixNQUFNRixXQUFXTCxpRUFBc0JBO1FBQ3ZDLE1BQU0sRUFBRTJDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTXZDLFNBQzNCd0MsSUFBSSxDQUFDLFNBQ0xFLE1BQU0sQ0FBQyxLQUNQTSxFQUFFLENBQUMsU0FBUzlDLE1BQU1DLFdBQVcsSUFDN0J3QyxNQUFNO1FBRVQsSUFBSUosU0FBU0EsTUFBTVUsSUFBSSxLQUFLLFlBQVksTUFBTVY7UUFDOUMsT0FBT0Q7SUFDVDtJQUVBLE1BQU1ZLFVBQVNDLEVBQVU7UUFDdkIsTUFBTW5ELFdBQVdMLGlFQUFzQkE7UUFDdkMsTUFBTSxFQUFFMkMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNdkMsU0FDM0J3QyxJQUFJLENBQUMsU0FDTEUsTUFBTSxDQUFDLEtBQ1BNLEVBQUUsQ0FBQyxNQUFNRyxJQUNUUixNQUFNO1FBRVQsSUFBSUosU0FBU0EsTUFBTVUsSUFBSSxLQUFLLFlBQVksTUFBTVY7UUFDOUMsT0FBT0Q7SUFDVDtJQUVBLE1BQU1jLFFBQU9ELEVBQVUsRUFBRUUsT0FBc0I7UUFDN0MsTUFBTXJELFdBQVdMLGlFQUFzQkE7UUFDdkMsTUFBTSxFQUFFMkMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNdkMsU0FDM0J3QyxJQUFJLENBQUMsU0FDTFksTUFBTSxDQUFDQyxTQUNQTCxFQUFFLENBQUMsTUFBTUcsSUFDVFQsTUFBTSxHQUNOQyxNQUFNO1FBRVQsSUFBSUosT0FBTyxNQUFNQTtRQUNqQixPQUFPRDtJQUNUO0lBRUEsTUFBTWdCLFFBQU9ILEVBQVU7UUFDckIsTUFBTW5ELFdBQVdMLGlFQUFzQkE7UUFDdkMsTUFBTSxFQUFFNEMsS0FBSyxFQUFFLEdBQUcsTUFBTXZDLFNBQ3JCd0MsSUFBSSxDQUFDLFNBQ0xjLE1BQU0sR0FDTk4sRUFBRSxDQUFDLE1BQU1HO1FBRVosSUFBSVosT0FBTyxNQUFNQTtJQUNuQjtJQUVBLE1BQU1nQixTQUFRQyxVQU1WLENBQUMsQ0FBQztRQUNKLE1BQU14RCxXQUFXTCxpRUFBc0JBO1FBQ3ZDLElBQUk4RCxRQUFRekQsU0FDVHdDLElBQUksQ0FBQyxTQUNMRSxNQUFNLENBQUMsb0dBQW9HO1lBQUVnQixPQUFPO1FBQVE7UUFFL0gsSUFBSUYsUUFBUUcsTUFBTSxFQUFFO1lBQ2xCRixRQUFRQSxNQUFNRyxFQUFFLENBQUMsQ0FBQyxhQUFhLEVBQUVKLFFBQVFHLE1BQU0sQ0FBQyxvQkFBb0IsRUFBRUgsUUFBUUcsTUFBTSxDQUFDLG1CQUFtQixFQUFFSCxRQUFRRyxNQUFNLENBQUMsaUJBQWlCLEVBQUVILFFBQVFHLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDL0o7UUFFQSxJQUFJSCxRQUFRaEQsSUFBSSxJQUFJZ0QsUUFBUWhELElBQUksS0FBSyxPQUFPO1lBQzFDaUQsUUFBUUEsTUFBTVQsRUFBRSxDQUFDLFFBQVFRLFFBQVFoRCxJQUFJO1FBQ3ZDO1FBRUEsSUFBSWdELFFBQVE3QyxNQUFNLElBQUk2QyxRQUFRN0MsTUFBTSxLQUFLLE9BQU87WUFDOUMsTUFBTWtELFdBQVdMLFFBQVE3QyxNQUFNLEtBQUs7WUFDcEM4QyxRQUFRQSxNQUFNVCxFQUFFLENBQUMsYUFBYWE7UUFDaEM7UUFFQUosUUFBUUEsTUFBTUssS0FBSyxDQUFDLGNBQWM7WUFBRUMsV0FBVztRQUFNO1FBRXJELElBQUlQLFFBQVFRLEtBQUssRUFBRTtZQUNqQixNQUFNeEIsT0FBTyxDQUFDLENBQUNnQixRQUFRUyxJQUFJLElBQUksS0FBSyxLQUFLVCxRQUFRUSxLQUFLO1lBQ3RELE1BQU1FLEtBQUsxQixPQUFPZ0IsUUFBUVEsS0FBSyxHQUFHO1lBQ2xDUCxRQUFRQSxNQUFNVSxLQUFLLENBQUMzQixNQUFNMEI7UUFDNUI7UUFFQSxNQUFNLEVBQUU1QixJQUFJLEVBQUVDLEtBQUssRUFBRW1CLEtBQUssRUFBRSxHQUFHLE1BQU1EO1FBRXJDLElBQUlsQixPQUFPLE1BQU1BO1FBRWpCLHdDQUF3QztRQUN4QyxNQUFNNkIsUUFBUUMsTUFBTUMsT0FBTyxDQUFDaEMsUUFBUUEsT0FBTyxFQUFFO1FBQzdDLE1BQU1pQyxRQUFRLE9BQU9iLFVBQVUsV0FBV0EsUUFBUTtRQUVsRCxPQUFPO1lBQUVVO1lBQU9HO1FBQU07SUFDeEI7SUFFQSxNQUFNQyxpQkFBZ0JDLGFBQXFCLEVBQUVDLGNBQXNCO1FBQ2pFLE9BQU85RSx1REFBYyxDQUFDNkUsZUFBZUM7SUFDdkM7SUFFQSxNQUFNRSxjQUFhQyxRQUFnQjtRQUNqQyxNQUFNQyxPQUFPLE1BQU1sRix1REFBYyxDQUFDO1FBQ2xDLE9BQU9BLG9EQUFXLENBQUNpRixVQUFVQztJQUMvQjtBQUNGLEVBQUM7QUFFRCxzQkFBc0I7QUFDZixNQUFNRyxxQkFBcUI7SUFDaEMsTUFBTW5GLFFBQU9vRixZQUFnRTtRQUMzRSxNQUFNbEYsV0FBV0wsaUVBQXNCQTtRQUN2QyxNQUFNLEVBQUUyQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU12QyxTQUMzQndDLElBQUksQ0FBQyxhQUNMQyxNQUFNLENBQUM7WUFBQ3lDO1NBQWEsRUFDckJ4QyxNQUFNLEdBQ05DLE1BQU07UUFFVCxJQUFJSixPQUFPLE1BQU1BO1FBQ2pCLE9BQU9EO0lBQ1Q7SUFFQSxNQUFNNkMsY0FBYUMsTUFBYztRQUMvQixNQUFNcEYsV0FBV0wsaUVBQXNCQTtRQUN2QyxNQUFNLEVBQUUyQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU12QyxTQUMzQndDLElBQUksQ0FBQyxhQUNMRSxNQUFNLENBQUMsS0FDUE0sRUFBRSxDQUFDLFdBQVdvQyxRQUNkdEIsS0FBSyxDQUFDLGNBQWM7WUFBRUMsV0FBVztRQUFNO1FBRTFDLElBQUl4QixPQUFPLE1BQU1BO1FBQ2pCLE9BQU9ELFFBQVEsRUFBRTtJQUNuQjtJQUVBLE1BQU1ZLFVBQVNDLEVBQVUsRUFBRWlDLE1BQWM7UUFDdkN4QyxRQUFReUMsR0FBRyxDQUFDbEMsSUFBS2lDO1FBQ2pCLE1BQU1wRixXQUFXTCxpRUFBc0JBO1FBQ3ZDLE1BQU0sRUFBRTJDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTXZDLFNBQzNCd0MsSUFBSSxDQUFDLGFBQ0xFLE1BQU0sQ0FBQyxLQUNQTSxFQUFFLENBQUMsTUFBTUcsSUFDVEgsRUFBRSxDQUFDLFdBQVdvQyxRQUNkekMsTUFBTTtRQUVQQyxRQUFReUMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFQyxLQUFLQyxTQUFTLENBQUNqRCxNQUFNLENBQUM7UUFFNUMsSUFBSUMsU0FBU0EsTUFBTVUsSUFBSSxLQUFLLFlBQVksTUFBTVY7UUFDOUMsT0FBT0Q7SUFDVDtJQUVBLE1BQU1jLFFBQU9ELEVBQVUsRUFBRWlDLE1BQWMsRUFBRS9CLE9BQTBCO1FBQ2pFLE1BQU1yRCxXQUFXTCxpRUFBc0JBO1FBQ3ZDLE1BQU0sRUFBRTJDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTXZDLFNBQzNCd0MsSUFBSSxDQUFDLGFBQ0xZLE1BQU0sQ0FBQ0MsU0FDUEwsRUFBRSxDQUFDLE1BQU1HLElBQ1RILEVBQUUsQ0FBQyxXQUFXb0MsUUFDZDFDLE1BQU0sR0FDTkMsTUFBTTtRQUVULElBQUlKLE9BQU8sTUFBTUE7UUFDakIsT0FBT0Q7SUFDVDtJQUVBLE1BQU1nQixRQUFPSCxFQUFVLEVBQUVpQyxNQUFjO1FBQ3JDLE1BQU1wRixXQUFXTCxpRUFBc0JBO1FBQ3ZDLE1BQU0sRUFBRTRDLEtBQUssRUFBRSxHQUFHLE1BQU12QyxTQUNyQndDLElBQUksQ0FBQyxhQUNMYyxNQUFNLEdBQ05OLEVBQUUsQ0FBQyxNQUFNRyxJQUNUSCxFQUFFLENBQUMsV0FBV29DO1FBRWpCLElBQUk3QyxPQUFPLE1BQU1BO0lBQ25CO0FBQ0YsRUFBQztBQUVELHNCQUFzQjtBQUNmLE1BQU1pRCxxQkFBcUI7SUFDaEMsTUFBTTFGLFFBQU8yRixZQUFnRTtRQUMzRSxNQUFNekYsV0FBV0wsaUVBQXNCQTtRQUN2QyxNQUFNLEVBQUUyQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU12QyxTQUMzQndDLElBQUksQ0FBQyxhQUNMQyxNQUFNLENBQUM7WUFBQ2dEO1NBQWEsRUFDckIvQyxNQUFNLEdBQ05DLE1BQU07UUFFVCxJQUFJSixPQUFPLE1BQU1BO1FBQ2pCLE9BQU9EO0lBQ1Q7SUFFQSxNQUFNNkMsY0FBYUMsTUFBYyxFQUFFNUIsT0FNbEM7UUFDQyxNQUFNeEQsV0FBV0wsaUVBQXNCQTtRQUN2QyxJQUFJOEQsUUFBUXpELFNBQ1R3QyxJQUFJLENBQUMsYUFDTEUsTUFBTSxDQUFDLENBQUMsMkJBQTJCLENBQUMsRUFBRTtZQUFFZ0IsT0FBTztRQUFRLEdBQ3ZEVixFQUFFLENBQUMsV0FBV29DO1FBRWpCLElBQUk1QixTQUFTRyxRQUFRO1lBQ25CRixRQUFRQSxNQUFNRyxFQUFFLENBQUMsQ0FBQyw0QkFBNEIsRUFBRUosUUFBUUcsTUFBTSxDQUFDLGlDQUFpQyxFQUFFSCxRQUFRRyxNQUFNLENBQUMsK0JBQStCLEVBQUVILFFBQVFHLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDcks7UUFFQSxJQUFJSCxTQUFTN0MsVUFBVTZDLFFBQVE3QyxNQUFNLEtBQUssT0FBTztZQUMvQzhDLFFBQVFBLE1BQU1ULEVBQUUsQ0FBQyxVQUFVUSxRQUFRN0MsTUFBTTtRQUMzQztRQUVBLElBQUk2QyxTQUFTa0MsY0FBY2xDLFFBQVFrQyxVQUFVLEtBQUssT0FBTztZQUN2RGpDLFFBQVFBLE1BQU1ULEVBQUUsQ0FBQyxlQUFlUSxRQUFRa0MsVUFBVTtRQUNwRDtRQUVBakMsUUFBUUEsTUFBTUssS0FBSyxDQUFDLGNBQWM7WUFBRUMsV0FBVztRQUFNO1FBRXJELElBQUlQLFNBQVNRLE9BQU87WUFDbEIsTUFBTXhCLE9BQU8sQ0FBQyxDQUFDZ0IsUUFBUVMsSUFBSSxJQUFJLEtBQUssS0FBS1QsUUFBUVEsS0FBSztZQUN0RCxNQUFNRSxLQUFLMUIsT0FBT2dCLFFBQVFRLEtBQUssR0FBRztZQUNsQ1AsUUFBUUEsTUFBTVUsS0FBSyxDQUFDM0IsTUFBTTBCO1FBQzVCO1FBRUEsTUFBTSxFQUFFNUIsSUFBSSxFQUFFQyxLQUFLLEVBQUVtQixLQUFLLEVBQUUsR0FBRyxNQUFNRDtRQUNyQyxJQUFJbEIsT0FBTyxNQUFNQTtRQUNqQixPQUFPO1lBQUVvRCxPQUFPckQsUUFBUSxFQUFFO1lBQUVpQyxPQUFPYixTQUFVcEIsQ0FBQUEsT0FBT0EsS0FBS3NELE1BQU0sR0FBRztRQUFHO0lBQ3ZFO0lBRUEsTUFBTTFDLFVBQVNDLEVBQVUsRUFBRWlDLE1BQWM7UUFDdkMsTUFBTXBGLFdBQVdMLGlFQUFzQkE7UUFDdkMsTUFBTSxFQUFFMkMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNdkMsU0FDM0J3QyxJQUFJLENBQUMsYUFDTEUsTUFBTSxDQUFDLENBQUM7OztNQUdULENBQUMsRUFDQU0sRUFBRSxDQUFDLE1BQU1HLElBQ1RILEVBQUUsQ0FBQyxXQUFXb0MsUUFDZHpDLE1BQU07UUFFVCxJQUFJSixTQUFTQSxNQUFNVSxJQUFJLEtBQUssWUFBWSxNQUFNVjtRQUM5QyxPQUFPRDtJQUNUO0lBRUEsTUFBTWMsUUFBT0QsRUFBVSxFQUFFaUMsTUFBYyxFQUFFL0IsT0FBMEI7UUFDakUsTUFBTXJELFdBQVdMLGlFQUFzQkE7UUFDdkMsTUFBTSxFQUFFMkMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNdkMsU0FDM0J3QyxJQUFJLENBQUMsYUFDTFksTUFBTSxDQUFDO1lBQUUsR0FBR0MsT0FBTztZQUFFd0MsY0FBYyxJQUFJQyxPQUFPQyxXQUFXO1FBQUcsR0FDNUQvQyxFQUFFLENBQUMsTUFBTUcsSUFDVEgsRUFBRSxDQUFDLFdBQVdvQyxRQUNkMUMsTUFBTSxDQUFDLENBQUM7OztNQUdULENBQUMsRUFDQUMsTUFBTTtRQUVULElBQUlKLE9BQU8sTUFBTUE7UUFDakIsT0FBT0Q7SUFDVDtJQUVBLE1BQU1nQixRQUFPSCxFQUFVLEVBQUVpQyxNQUFjO1FBQ3JDLE1BQU1wRixXQUFXTCxpRUFBc0JBO1FBQ3ZDLE1BQU0sRUFBRTRDLEtBQUssRUFBRSxHQUFHLE1BQU12QyxTQUNyQndDLElBQUksQ0FBQyxhQUNMYyxNQUFNLEdBQ05OLEVBQUUsQ0FBQyxNQUFNRyxJQUNUSCxFQUFFLENBQUMsV0FBV29DO1FBRWpCLElBQUk3QyxPQUFPLE1BQU1BO0lBQ25CO0FBQ0YsRUFBQztBQUVELHFCQUFxQjtBQUNkLE1BQU15RCxvQkFBb0I7SUFDL0IsTUFBTWxHLFFBQU9tRyxXQUE4RDtRQUN6RSxNQUFNakcsV0FBV04sNERBQWlCQTtRQUNsQyxNQUFNLEVBQUU0QyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU12QyxTQUMzQndDLElBQUksQ0FBQyxZQUNMQyxNQUFNLENBQUM7WUFBQ3dEO1NBQVksRUFDcEJ2RCxNQUFNLENBQUMsQ0FBQzs7O01BR1QsQ0FBQyxFQUNBQyxNQUFNO1FBRVQsSUFBSUosT0FBTyxNQUFNQTtRQUNqQixPQUFPRDtJQUNUO0lBRUEsTUFBTTZDLGNBQWFDLE1BQWMsRUFBRTVCLE9BSWxDO1FBQ0MsTUFBTXhELFdBQVdOLDREQUFpQkE7UUFDbEMsSUFBSStELFFBQVF6RCxTQUNUd0MsSUFBSSxDQUFDLFlBQ0xFLE1BQU0sQ0FBQyxDQUFDOzs7TUFHVCxDQUFDLEVBQ0FNLEVBQUUsQ0FBQyxXQUFXb0M7UUFFakIsSUFBSTVCLFNBQVMwQyxnQkFBZ0I7WUFDM0J6QyxRQUFRQSxNQUFNVCxFQUFFLENBQUMsbUJBQW1CUSxRQUFRMEMsY0FBYztZQUMxRHpDLFFBQVFBLE1BQU1LLEtBQUssQ0FBQyxjQUFjO2dCQUFFQyxXQUFXO1lBQUs7UUFDdEQsT0FBTztZQUNMTixRQUFRQSxNQUFNSyxLQUFLLENBQUMsY0FBYztnQkFBRUMsV0FBVztZQUFNO1FBQ3ZEO1FBRUEsSUFBSVAsU0FBU1EsT0FBTztZQUNsQixNQUFNeEIsT0FBTyxDQUFDLENBQUNnQixRQUFRUyxJQUFJLElBQUksS0FBSyxLQUFLVCxRQUFRUSxLQUFLO1lBQ3RELE1BQU1FLEtBQUsxQixPQUFPZ0IsUUFBUVEsS0FBSyxHQUFHO1lBQ2xDUCxRQUFRQSxNQUFNVSxLQUFLLENBQUMzQixNQUFNMEI7UUFDNUI7UUFFQSxNQUFNLEVBQUU1QixJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1rQjtRQUU5QixJQUFJbEIsT0FBTyxNQUFNQTtRQUNqQixPQUFPRCxRQUFRLEVBQUU7SUFDbkI7SUFFQSxNQUFNWSxVQUFTQyxFQUFVLEVBQUVpQyxNQUFjO1FBQ3ZDLE1BQU1wRixXQUFXTiw0REFBaUJBO1FBQ2xDLE1BQU0sRUFBRTRDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTXZDLFNBQzNCd0MsSUFBSSxDQUFDLFlBQ0xFLE1BQU0sQ0FBQyxDQUFDOzs7TUFHVCxDQUFDLEVBQ0FNLEVBQUUsQ0FBQyxNQUFNRyxJQUNUSCxFQUFFLENBQUMsV0FBV29DLFFBQ2R6QyxNQUFNO1FBRVQsSUFBSUosU0FBU0EsTUFBTVUsSUFBSSxLQUFLLFlBQVksTUFBTVY7UUFDOUMsT0FBT0Q7SUFDVDtJQUVBLE1BQU1jLFFBQU9ELEVBQVUsRUFBRWlDLE1BQWMsRUFBRS9CLE9BQXlCO1FBQ2hFLE1BQU1yRCxXQUFXTiw0REFBaUJBO1FBQ2xDLE1BQU0sRUFBRTRDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTXZDLFNBQzNCd0MsSUFBSSxDQUFDLFlBQ0xZLE1BQU0sQ0FBQ0MsU0FDUEwsRUFBRSxDQUFDLE1BQU1HLElBQ1RILEVBQUUsQ0FBQyxXQUFXb0MsUUFDZDFDLE1BQU0sQ0FBQyxDQUFDOzs7TUFHVCxDQUFDLEVBQ0FDLE1BQU07UUFFVCxJQUFJSixPQUFPLE1BQU1BO1FBQ2pCLE9BQU9EO0lBQ1Q7SUFFQSxNQUFNNkQsWUFBV2hELEVBQVUsRUFBRWlDLE1BQWM7UUFDekMsTUFBTXBGLFdBQVdOLDREQUFpQkE7UUFDbEMsTUFBTSxFQUFFNEMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNdkMsU0FDM0J3QyxJQUFJLENBQUMsWUFDTFksTUFBTSxDQUFDO1lBQ056QyxRQUFRO1lBQ1J5RixTQUFTLElBQUlOLE9BQU9DLFdBQVc7WUFDL0JNLFdBQVc7Z0JBQ1RDLFFBQVE7Z0JBQ1JDLFVBQVUsSUFBSVQsT0FBT0MsV0FBVztZQUNsQztRQUNGLEdBQ0MvQyxFQUFFLENBQUMsTUFBTUcsSUFDVEgsRUFBRSxDQUFDLFdBQVdvQyxRQUNkcEMsRUFBRSxDQUFDLFFBQVEsWUFDWE4sTUFBTSxDQUFDLENBQUM7OztNQUdULENBQUMsRUFDQUMsTUFBTTtRQUVULElBQUlKLE9BQU8sTUFBTUE7UUFDakIsT0FBT0Q7SUFDVDtBQUNGLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9seW5jYm90LW5leHRqcy8uL2xpYi9kYXRhYmFzZS50cz80ZDQ5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFN1cGFiYXNlQ2xpZW50LCBnZXRTdXBhYmFzZUFkbWluQ2xpZW50IH0gZnJvbSAnLi9zdXBhYmFzZSdcclxuaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHRqcydcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNlciB7XHJcbiAgaWQ6IHN0cmluZ1xyXG4gIGVtYWlsOiBzdHJpbmdcclxuICBwYXNzd29yZF9oYXNoOiBzdHJpbmdcclxuICBmaXJzdF9uYW1lOiBzdHJpbmdcclxuICBsYXN0X25hbWU6IHN0cmluZ1xyXG4gIGNvbXBhbnk/OiBzdHJpbmdcclxuICByb2xlOiAndXNlcicgfCAnYWRtaW4nIHwgJ3ByZW1pdW0nXHJcbiAgc3Vic2NyaXB0aW9uOiB7XHJcbiAgICBwbGFuOiAnZnJlZScgfCAnZnVsbF9hY2Nlc3MnXHJcbiAgICBzdGF0dXM6ICdhY3RpdmUnIHwgJ2luYWN0aXZlJyB8ICdjYW5jZWxsZWQnIHwgJ3Bhc3RfZHVlJyB8ICd0cmlhbGluZydcclxuICAgIHN0YXJ0RGF0ZT86IHN0cmluZ1xyXG4gICAgZW5kRGF0ZT86IHN0cmluZ1xyXG4gICAgbmV4dEJpbGxpbmdEYXRlPzogc3RyaW5nXHJcbiAgICBhbW91bnQ/OiBudW1iZXJcclxuICB9XHJcbiAgbGlua2VkaW5fYWNjb3VudHM6IEFycmF5PHtcclxuICAgIGVtYWlsOiBzdHJpbmdcclxuICAgIGVuY3J5cHRlZFBhc3N3b3JkOiBzdHJpbmdcclxuICAgIGlzQWN0aXZlOiBib29sZWFuXHJcbiAgICBsYXN0TG9naW4/OiBzdHJpbmdcclxuICAgIGFjY291bnRIZWFsdGg6IHtcclxuICAgICAgc3RhdHVzOiAnaGVhbHRoeScgfCAnd2FybmluZycgfCAncmVzdHJpY3RlZCcgfCAnYmFubmVkJ1xyXG4gICAgICBsYXN0Q2hlY2s/OiBzdHJpbmdcclxuICAgICAgcmVzdHJpY3Rpb25zOiBzdHJpbmdbXVxyXG4gICAgfVxyXG4gICAgZGFpbHlMaW1pdHM6IHtcclxuICAgICAgY29ubmVjdGlvbnM6IG51bWJlclxyXG4gICAgICBtZXNzYWdlczogbnVtYmVyXHJcbiAgICAgIHByb2ZpbGVWaWV3czogbnVtYmVyXHJcbiAgICB9XHJcbiAgICBkYWlseVVzYWdlOiB7XHJcbiAgICAgIGNvbm5lY3Rpb25zOiBudW1iZXJcclxuICAgICAgbWVzc2FnZXM6IG51bWJlclxyXG4gICAgICBwcm9maWxlVmlld3M6IG51bWJlclxyXG4gICAgICBsYXN0UmVzZXQ6IHN0cmluZ1xyXG4gICAgfVxyXG4gIH0+XHJcbiAgZW1haWxfYWNjb3VudHM6IEFycmF5PHtcclxuICAgIGVtYWlsOiBzdHJpbmdcclxuICAgIGVuY3J5cHRlZFBhc3N3b3JkPzogc3RyaW5nXHJcbiAgICBwcm92aWRlcjogJ2dtYWlsJyB8ICdvdXRsb29rJyB8ICdzbXRwJ1xyXG4gICAgc210cFNldHRpbmdzPzoge1xyXG4gICAgICBob3N0OiBzdHJpbmdcclxuICAgICAgcG9ydDogbnVtYmVyXHJcbiAgICAgIHNlY3VyZTogYm9vbGVhblxyXG4gICAgfVxyXG4gICAgaW1hcFNldHRpbmdzPzoge1xyXG4gICAgICBob3N0OiBzdHJpbmdcclxuICAgICAgcG9ydDogbnVtYmVyXHJcbiAgICAgIHNlY3VyZTogYm9vbGVhblxyXG4gICAgfVxyXG4gICAgaXNBY3RpdmU6IGJvb2xlYW5cclxuICAgIGxhc3RVc2VkPzogc3RyaW5nXHJcbiAgICBsYXN0U3luY0F0Pzogc3RyaW5nXHJcbiAgICBkYWlseUxpbWl0czoge1xyXG4gICAgICBlbWFpbHM6IG51bWJlclxyXG4gICAgfVxyXG4gICAgZGFpbHlVc2FnZToge1xyXG4gICAgICBlbWFpbHM6IG51bWJlclxyXG4gICAgICBsYXN0UmVzZXQ6IHN0cmluZ1xyXG4gICAgfVxyXG4gICAgYWNjb3VudEhlYWx0aDoge1xyXG4gICAgICBzdGF0dXM6ICdoZWFsdGh5JyB8ICd3YXJuaW5nJyB8ICdyZXN0cmljdGVkJyB8ICdiYW5uZWQnXHJcbiAgICAgIGxhc3RDaGVjaz86IHN0cmluZ1xyXG4gICAgICByZXN0cmljdGlvbnM6IHN0cmluZ1tdXHJcbiAgICB9XHJcbiAgfT5cclxuICBhcGlfa2V5czoge1xyXG4gICAgb3BlbmFpPzogc3RyaW5nXHJcbiAgICBlbmNyeXB0ZWRPcGVuQUk/OiBzdHJpbmdcclxuICAgIHBlcnBsZXhpdHk/OiBzdHJpbmdcclxuICAgIGVuY3J5cHRlZFBlcnBsZXhpdHk/OiBzdHJpbmdcclxuICAgIGNsYXVkZT86IHN0cmluZ1xyXG4gICAgZW5jcnlwdGVkQ2xhdWRlPzogc3RyaW5nXHJcbiAgfVxyXG4gIHNldHRpbmdzOiB7XHJcbiAgICB0aW1lem9uZTogc3RyaW5nXHJcbiAgICB3b3JraW5nSG91cnM6IHsgc3RhcnQ6IG51bWJlcjsgZW5kOiBudW1iZXIgfVxyXG4gICAgd29ya2luZ0RheXM6IG51bWJlcltdXHJcbiAgICBhaVByb3ZpZGVyPzoge1xyXG4gICAgICBwcm92aWRlcjogJ29wZW5haScgfCAncGVycGxleGl0eScgfCAnY2xhdWRlJ1xyXG4gICAgICBtb2RlbDogc3RyaW5nXHJcbiAgICAgIHRlbXBlcmF0dXJlOiBudW1iZXJcclxuICAgICAgbWF4VG9rZW5zOiBudW1iZXJcclxuICAgIH1cclxuICAgIGF1dG9tYXRpb246IHtcclxuICAgICAgZW5hYmxlZDogYm9vbGVhblxyXG4gICAgICBjb25uZWN0aW9uUmVxdWVzdHM6IHsgZW5hYmxlZDogYm9vbGVhbiB9XHJcbiAgICAgIHdlbGNvbWVNZXNzYWdlczogeyBlbmFibGVkOiBib29sZWFuIH1cclxuICAgICAgZm9sbG93VXBNZXNzYWdlczogeyBlbmFibGVkOiBib29sZWFuIH1cclxuICAgICAgcHJvZmlsZVZpZXdzOiB7IGVuYWJsZWQ6IGJvb2xlYW4gfVxyXG4gICAgICBlbWFpbFNlbmRpbmc/OiB7IGVuYWJsZWQ6IGJvb2xlYW4gfVxyXG4gICAgfVxyXG4gICAgbm90aWZpY2F0aW9uczoge1xyXG4gICAgICBlbWFpbDogYm9vbGVhblxyXG4gICAgICB3ZWJob29rOiBib29sZWFuXHJcbiAgICB9XHJcbiAgfVxyXG4gIHVzYWdlOiB7XHJcbiAgICB0b3RhbENvbm5lY3Rpb25zOiBudW1iZXJcclxuICAgIHRvdGFsTWVzc2FnZXM6IG51bWJlclxyXG4gICAgdG90YWxDYW1wYWlnbnM6IG51bWJlclxyXG4gICAgdG90YWxQcm9zcGVjdHM6IG51bWJlclxyXG4gIH1cclxuICBpc19hY3RpdmU6IGJvb2xlYW5cclxuICBsYXN0X2xvZ2luPzogc3RyaW5nXHJcbiAgZW1haWxfdmVyaWZpZWQ6IGJvb2xlYW5cclxuICBvbmJvYXJkaW5nX2NvbXBsZXRlOiBib29sZWFuXHJcbiAgZW1haWxfdmVyaWZpY2F0aW9uX3Rva2VuPzogc3RyaW5nXHJcbiAgZW1haWxfdmVyaWZpY2F0aW9uX2V4cGlyZXM/OiBzdHJpbmdcclxuICBwYXNzd29yZF9yZXNldF90b2tlbj86IHN0cmluZ1xyXG4gIHBhc3N3b3JkX3Jlc2V0X2V4cGlyZXM/OiBzdHJpbmdcclxuICBjcmVhdGVkX2F0OiBzdHJpbmdcclxuICB1cGRhdGVkX2F0OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDYW1wYWlnbiB7XHJcbiAgaWQ6IHN0cmluZ1xyXG4gIHVzZXJfaWQ6IHN0cmluZ1xyXG4gIG5hbWU6IHN0cmluZ1xyXG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nXHJcbiAgc3RhdHVzOiAnZHJhZnQnIHwgJ2FjdGl2ZScgfCAncGF1c2VkJyB8ICdjb21wbGV0ZWQnIHwgJ2FyY2hpdmVkJ1xyXG4gIHNlYXJjaF9jcml0ZXJpYToge1xyXG4gICAga2V5d29yZHM/OiBzdHJpbmdcclxuICAgIGxvY2F0aW9uPzogc3RyaW5nXHJcbiAgICBjb21wYW55Pzogc3RyaW5nXHJcbiAgICB0aXRsZT86IHN0cmluZ1xyXG4gICAgaW5kdXN0cnk/OiBzdHJpbmdcclxuICAgIGNvbm5lY3Rpb25MZXZlbD86IHN0cmluZ1xyXG4gICAgY3VycmVudENvbXBhbnk/OiBzdHJpbmdcclxuICAgIHBhc3RDb21wYW55Pzogc3RyaW5nXHJcbiAgICBzY2hvb2w/OiBzdHJpbmdcclxuICAgIHByb2ZpbGVMYW5ndWFnZT86IHN0cmluZ1xyXG4gICAgc2VydmljZUNhdGVnb3J5Pzogc3RyaW5nXHJcbiAgICBub25wcm9maXQ/OiBzdHJpbmdcclxuICAgIHNhbGVzTmF2aWdhdG9yVXJsPzogc3RyaW5nXHJcbiAgICBjdXN0b21GaWx0ZXJzPzogYW55XHJcbiAgfVxyXG4gIG1lc3NhZ2VfdGVtcGxhdGVzOiB7XHJcbiAgICAvLyBBSS1nZW5lcmF0ZWQgY29udmVyc2F0aW9uIHN0YXJ0ZXJzIGFyZSBjb25maWd1cmVkIGhlcmVcclxuICAgIGNvbm5lY3Rpb25SZXF1ZXN0OiB7XHJcbiAgICAgIGVuYWJsZWQ6IGJvb2xlYW5cclxuICAgICAgdGVtcGxhdGU/OiBzdHJpbmdcclxuICAgICAgdG9uZTogJ3Byb2Zlc3Npb25hbCcgfCAnY2FzdWFsJyB8ICdmcmllbmRseScgfCAnZGlyZWN0J1xyXG4gICAgICB1c2VBSTogYm9vbGVhblxyXG4gICAgICBjdXN0b21Qcm9tcHQ/OiBzdHJpbmdcclxuICAgIH1cclxuICAgIHdlbGNvbWVNZXNzYWdlOiB7XHJcbiAgICAgIGVuYWJsZWQ6IGJvb2xlYW5cclxuICAgICAgdGVtcGxhdGU/OiBzdHJpbmdcclxuICAgICAgdG9uZTogJ3Byb2Zlc3Npb25hbCcgfCAnY2FzdWFsJyB8ICdmcmllbmRseScgfCAnZGlyZWN0J1xyXG4gICAgICB1c2VBSTogYm9vbGVhblxyXG4gICAgICBjdXN0b21Qcm9tcHQ/OiBzdHJpbmdcclxuICAgICAgZGVsYXk6IG51bWJlclxyXG4gICAgfVxyXG4gICAgZm9sbG93VXBTZXF1ZW5jZTogQXJyYXk8e1xyXG4gICAgICBvcmRlcjogbnVtYmVyXHJcbiAgICAgIHRlbXBsYXRlPzogc3RyaW5nXHJcbiAgICAgIHRvbmU6ICdwcm9mZXNzaW9uYWwnIHwgJ2Nhc3VhbCcgfCAnZnJpZW5kbHknIHwgJ2RpcmVjdCdcclxuICAgICAgdXNlQUk6IGJvb2xlYW5cclxuICAgICAgY3VzdG9tUHJvbXB0Pzogc3RyaW5nXHJcbiAgICAgIGRlbGF5OiBudW1iZXJcclxuICAgICAgZW5hYmxlZDogYm9vbGVhblxyXG4gICAgfT5cclxuICAgIGVtYWlsVGVtcGxhdGVzOiB7XHJcbiAgICAgIGNvbGRFbWFpbDoge1xyXG4gICAgICAgIGVuYWJsZWQ6IGJvb2xlYW5cclxuICAgICAgICB0ZW1wbGF0ZT86IHN0cmluZ1xyXG4gICAgICAgIHRvbmU6ICdwcm9mZXNzaW9uYWwnIHwgJ2Nhc3VhbCcgfCAnZnJpZW5kbHknIHwgJ2RpcmVjdCdcclxuICAgICAgICB1c2VBSTogYm9vbGVhblxyXG4gICAgICAgIGN1c3RvbVByb21wdD86IHN0cmluZ1xyXG4gICAgICAgIGRlbGF5OiBudW1iZXJcclxuICAgICAgfVxyXG4gICAgICBmb2xsb3dVcEVtYWlsOiB7XHJcbiAgICAgICAgZW5hYmxlZDogYm9vbGVhblxyXG4gICAgICAgIHRlbXBsYXRlPzogc3RyaW5nXHJcbiAgICAgICAgdG9uZTogJ3Byb2Zlc3Npb25hbCcgfCAnY2FzdWFsJyB8ICdmcmllbmRseScgfCAnZGlyZWN0J1xyXG4gICAgICAgIHVzZUFJOiBib29sZWFuXHJcbiAgICAgICAgY3VzdG9tUHJvbXB0Pzogc3RyaW5nXHJcbiAgICAgICAgZGVsYXk6IG51bWJlclxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIGF1dG9tYXRpb246IHtcclxuICAgIGVuYWJsZWQ6IGJvb2xlYW5cclxuICAgIGRhaWx5TGltaXRzOiB7XHJcbiAgICAgIGNvbm5lY3Rpb25zOiBudW1iZXJcclxuICAgICAgbWVzc2FnZXM6IG51bWJlclxyXG4gICAgICBlbWFpbHM6IG51bWJlclxyXG4gICAgfVxyXG4gICAgdGltaW5nOiB7XHJcbiAgICAgIHdvcmtpbmdIb3VyczogeyBzdGFydDogbnVtYmVyOyBlbmQ6IG51bWJlciB9XHJcbiAgICAgIHdvcmtpbmdEYXlzOiBudW1iZXJbXVxyXG4gICAgICByYW5kb21EZWxheTogeyBtaW46IG51bWJlcjsgbWF4OiBudW1iZXIgfVxyXG4gICAgfVxyXG4gICAgd2l0aGRyYXdJbnZpdGF0aW9uczoge1xyXG4gICAgICBlbmFibGVkOiBib29sZWFuXHJcbiAgICAgIGFmdGVyRGF5czogbnVtYmVyXHJcbiAgICB9XHJcbiAgICBlbWFpbFNlbmRpbmc6IHtcclxuICAgICAgZW5hYmxlZDogYm9vbGVhblxyXG4gICAgICBkYWlseUxpbWl0OiBudW1iZXJcclxuICAgIH1cclxuICB9XHJcbiAgc3RhdGlzdGljczoge1xyXG4gICAgdG90YWxQcm9zcGVjdHM6IG51bWJlclxyXG4gICAgY29ubmVjdGlvbnNTZW50OiBudW1iZXJcclxuICAgIGNvbm5lY3Rpb25zQWNjZXB0ZWQ6IG51bWJlclxyXG4gICAgbWVzc2FnZXNTZW50OiBudW1iZXJcclxuICAgIG1lc3NhZ2VzUmVwbGllZDogbnVtYmVyXHJcbiAgICBwcm9maWxlVmlld3M6IG51bWJlclxyXG4gICAgYWNjZXB0YW5jZVJhdGU6IG51bWJlclxyXG4gICAgcmVzcG9uc2VSYXRlOiBudW1iZXJcclxuICAgIGxhc3RBY3Rpdml0eT86IHN0cmluZ1xyXG4gIH1cclxuICBpbnRlZ3JhdGlvbnM6IHtcclxuICAgIHdlYmhvb2tzOiBBcnJheTx7XHJcbiAgICAgIG5hbWU6IHN0cmluZ1xyXG4gICAgICB1cmw6IHN0cmluZ1xyXG4gICAgICBldmVudHM6IHN0cmluZ1tdXHJcbiAgICAgIGVuYWJsZWQ6IGJvb2xlYW5cclxuICAgICAgc2VjcmV0Pzogc3RyaW5nXHJcbiAgICB9PlxyXG4gICAgemFwaWVyOiB7IGVuYWJsZWQ6IGJvb2xlYW47IHdlYmhvb2tVcmw/OiBzdHJpbmcgfVxyXG4gICAgbWFrZTogeyBlbmFibGVkOiBib29sZWFuOyB3ZWJob29rVXJsPzogc3RyaW5nIH1cclxuICAgIG44bjogeyBlbmFibGVkOiBib29sZWFuOyB3ZWJob29rVXJsPzogc3RyaW5nIH1cclxuICB9XHJcbiAgdGFnczogc3RyaW5nW11cclxuICBwcmlvcml0eTogbnVtYmVyXHJcbiAgaXNfYWN0aXZlOiBib29sZWFuXHJcbiAgY3JlYXRlZF9hdDogc3RyaW5nXHJcbiAgdXBkYXRlZF9hdDogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvc3BlY3Qge1xyXG4gIGlkOiBzdHJpbmdcclxuICB1c2VyX2lkOiBzdHJpbmdcclxuICBjYW1wYWlnbl9pZDogc3RyaW5nXHJcbiAgbGlua2VkaW5fZGF0YToge1xyXG4gICAgcHJvZmlsZVVybDogc3RyaW5nXHJcbiAgICBsaW5rZWRpbklkPzogc3RyaW5nXHJcbiAgICBuYW1lOiBzdHJpbmdcclxuICAgIGZpcnN0TmFtZT86IHN0cmluZ1xyXG4gICAgbGFzdE5hbWU/OiBzdHJpbmdcclxuICAgIGhlYWRsaW5lPzogc3RyaW5nXHJcbiAgICB0aXRsZT86IHN0cmluZ1xyXG4gICAgY29tcGFueT86IHN0cmluZ1xyXG4gICAgbG9jYXRpb24/OiBzdHJpbmdcclxuICAgIGluZHVzdHJ5Pzogc3RyaW5nXHJcbiAgICBjb25uZWN0aW9uTGV2ZWw/OiBzdHJpbmdcclxuICAgIHByb2ZpbGVJbWFnZVVybD86IHN0cmluZ1xyXG4gICAgYmFja2dyb3VuZEltYWdlVXJsPzogc3RyaW5nXHJcbiAgICBzdW1tYXJ5Pzogc3RyaW5nXHJcbiAgICBleHBlcmllbmNlPzogQXJyYXk8e1xyXG4gICAgICB0aXRsZTogc3RyaW5nXHJcbiAgICAgIGNvbXBhbnk6IHN0cmluZ1xyXG4gICAgICBkdXJhdGlvbjogc3RyaW5nXHJcbiAgICAgIGRlc2NyaXB0aW9uOiBzdHJpbmdcclxuICAgIH0+XHJcbiAgICBlZHVjYXRpb24/OiBBcnJheTx7XHJcbiAgICAgIHNjaG9vbDogc3RyaW5nXHJcbiAgICAgIGRlZ3JlZTogc3RyaW5nXHJcbiAgICAgIGZpZWxkOiBzdHJpbmdcclxuICAgICAgZHVyYXRpb246IHN0cmluZ1xyXG4gICAgfT5cclxuICAgIHNraWxscz86IHN0cmluZ1tdXHJcbiAgICBsYW5ndWFnZXM/OiBzdHJpbmdbXVxyXG4gICAgbXV0dWFsQ29ubmVjdGlvbnM/OiBudW1iZXJcclxuICAgIGZvbGxvd2Vycz86IG51bWJlclxyXG4gICAgY29ubmVjdGlvbnM/OiBudW1iZXJcclxuICB9XHJcbiAgY29udGFjdF9pbmZvOiB7XHJcbiAgICBlbWFpbD86IHN0cmluZ1xyXG4gICAgcGhvbmU/OiBzdHJpbmdcclxuICAgIHdlYnNpdGU/OiBzdHJpbmdcclxuICAgIHR3aXR0ZXI/OiBzdHJpbmdcclxuICAgIG90aGVyU29jaWFsPzogYW55XHJcbiAgfVxyXG4gIHN0YXR1czogJ25ldycgfCAnY29ubmVjdGlvbl9wZW5kaW5nJyB8ICdjb25uZWN0aW9uX3NlbnQnIHwgJ2Nvbm5lY3RlZCcgfCAnY29ubmVjdGlvbl9mYWlsZWQnIHwgJ2Nvbm5lY3Rpb25fZGVjbGluZWQnIHwgJ21lc3NhZ2Vfc2VudCcgfCAnbWVzc2FnZV9yZXBsaWVkJyB8ICdtZXNzYWdlX2ZhaWxlZCcgfCAnZm9sbG93X3VwX3NlbnQnIHwgJ2ZvbGxvd191cF9yZXBsaWVkJyB8ICd1bnJlc3BvbnNpdmUnIHwgJ3F1YWxpZmllZCcgfCAnbm90X3F1YWxpZmllZCcgfCAnYXJjaGl2ZWQnXHJcbiAgaW50ZXJhY3Rpb25zOiBBcnJheTx7XHJcbiAgICB0eXBlOiAnY29ubmVjdGlvbl9yZXF1ZXN0JyB8ICdtZXNzYWdlJyB8ICdmb2xsb3dfdXAnIHwgJ3Byb2ZpbGVfdmlldycgfCAnbm90ZSdcclxuICAgIGNvbnRlbnQ/OiBzdHJpbmdcclxuICAgIHRpbWVzdGFtcDogc3RyaW5nXHJcbiAgICByZXNwb25zZT86IHN0cmluZ1xyXG4gICAgcmVzcG9uc2VUaW1lc3RhbXA/OiBzdHJpbmdcclxuICAgIGF1dG9tYXRlZDogYm9vbGVhblxyXG4gICAgam9iSWQ/OiBzdHJpbmdcclxuICAgIG1ldGFkYXRhPzogYW55XHJcbiAgfT5cclxuICBhdXRvbWF0aW9uOiB7XHJcbiAgICBjb25uZWN0aW9uUmVxdWVzdFNlbnQ6IGJvb2xlYW5cclxuICAgIGNvbm5lY3Rpb25SZXF1ZXN0RGF0ZT86IHN0cmluZyB8IG51bGxcclxuICAgIHdlbGNvbWVNZXNzYWdlU2VudDogYm9vbGVhblxyXG4gICAgd2VsY29tZU1lc3NhZ2VEYXRlPzogc3RyaW5nIHwgbnVsbFxyXG4gICAgZm9sbG93VXBzU2VudDogbnVtYmVyXHJcbiAgICBsYXN0Rm9sbG93VXBEYXRlPzogc3RyaW5nIHwgbnVsbFxyXG4gICAgbmV4dFNjaGVkdWxlZEFjdGlvbj86ICdjb25uZWN0aW9uX3JlcXVlc3QnIHwgJ3dlbGNvbWVfbWVzc2FnZScgfCAnZm9sbG93X3VwJyB8ICd3aXRoZHJhd19pbnZpdGF0aW9uJyB8IG51bGxcclxuICAgIG5leHRTY2hlZHVsZWREYXRlPzogc3RyaW5nIHwgbnVsbFxyXG4gICAgYXV0b21hdGlvblBhdXNlZDogYm9vbGVhblxyXG4gICAgcGF1c2VSZWFzb24/OiBzdHJpbmcgfCBudWxsXHJcbiAgICBjb2xkRW1haWxTZW50OiBib29sZWFuXHJcbiAgICBjb2xkRW1haWxEYXRlPzogc3RyaW5nIHwgbnVsbFxyXG4gICAgZW1haWxGb2xsb3dVcHNTZW50OiBudW1iZXJcclxuICAgIGxhc3RFbWFpbEZvbGxvd1VwRGF0ZT86IHN0cmluZyB8IG51bGxcclxuICB9XHJcbiAgc2NvcmluZzoge1xyXG4gICAgbGVhZFNjb3JlOiBudW1iZXJcclxuICAgIGZhY3RvcnM6IHtcclxuICAgICAgdGl0bGVNYXRjaDogbnVtYmVyXHJcbiAgICAgIGNvbXBhbnlNYXRjaDogbnVtYmVyXHJcbiAgICAgIGxvY2F0aW9uTWF0Y2g6IG51bWJlclxyXG4gICAgICBpbmR1c3RyeU1hdGNoOiBudW1iZXJcclxuICAgICAgY29ubmVjdGlvbkxldmVsOiBudW1iZXJcclxuICAgICAgcHJvZmlsZUNvbXBsZXRlbmVzczogbnVtYmVyXHJcbiAgICAgIGFjdGl2aXR5TGV2ZWw6IG51bWJlclxyXG4gICAgfVxyXG4gICAgbGFzdENhbGN1bGF0ZWQ/OiBzdHJpbmcgfCBudWxsXHJcbiAgfVxyXG4gIHRhZ3M6IHN0cmluZ1tdXHJcbiAgbm90ZXM6IEFycmF5PHtcclxuICAgIGNvbnRlbnQ6IHN0cmluZ1xyXG4gICAgYXV0aG9yOiBzdHJpbmdcclxuICAgIHRpbWVzdGFtcDogc3RyaW5nXHJcbiAgICB0eXBlOiAnbm90ZScgfCAncmVtaW5kZXInIHwgJ3Rhc2snXHJcbiAgfT5cclxuICBjdXN0b21fZmllbGRzOiBhbnlcclxuICBzb3VyY2U6ICdzZWFyY2gnIHwgJ2ltcG9ydCcgfCAnbWFudWFsJyB8ICdzYWxlc19uYXZpZ2F0b3InXHJcbiAgc2VhcmNoX3F1ZXJ5Pzogc3RyaW5nXHJcbiAgaXNfYWN0aXZlOiBib29sZWFuXHJcbiAgbGFzdF91cGRhdGVkOiBzdHJpbmdcclxuICBjcmVhdGVkX2F0OiBzdHJpbmdcclxuICB1cGRhdGVkX2F0OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBNZXNzYWdlIHtcclxuICBpZDogc3RyaW5nXHJcbiAgdXNlcl9pZDogc3RyaW5nXHJcbiAgcHJvc3BlY3RfaWQ6IHN0cmluZ1xyXG4gIGNhbXBhaWduX2lkPzogc3RyaW5nXHJcbiAgY29udmVyc2F0aW9uX2lkOiBzdHJpbmdcclxuICB0eXBlOiAnc2VudCcgfCAncmVjZWl2ZWQnXHJcbiAgbWVzc2FnZV90eXBlOiAnY29ubmVjdGlvbl9yZXF1ZXN0JyB8ICd3ZWxjb21lJyB8ICdmb2xsb3dfdXAnIHwgJ21hbnVhbCcgfCAnYXV0b19yZXBseScgfCAnY29sZF9lbWFpbCcgfCAnZW1haWxfZm9sbG93X3VwJ1xyXG4gIGNvbnRlbnQ6IHN0cmluZ1xyXG4gIHN1YmplY3Q/OiBzdHJpbmdcclxuICBwbGF0Zm9ybTogJ2xpbmtlZGluJyB8ICdlbWFpbCcgfCAnb3RoZXInXHJcbiAgZW1haWxfZGF0YT86IHtcclxuICAgIHRvOiBzdHJpbmdcclxuICAgIGZyb206IHN0cmluZ1xyXG4gICAgY2M/OiBzdHJpbmdbXVxyXG4gICAgYmNjPzogc3RyaW5nW11cclxuICAgIG1lc3NhZ2VJZD86IHN0cmluZ1xyXG4gICAgaW5SZXBseVRvPzogc3RyaW5nXHJcbiAgICByZWZlcmVuY2VzPzogc3RyaW5nW11cclxuICAgIHRocmVhZElkPzogc3RyaW5nXHJcbiAgfVxyXG4gIHN0YXR1czogJ2RyYWZ0JyB8ICdzZW5kaW5nJyB8ICdzZW50JyB8ICdkZWxpdmVyZWQnIHwgJ3JlYWQnIHwgJ3JlcGxpZWQnIHwgJ2ZhaWxlZCdcclxuICBsaW5rZWRpbl9tZXNzYWdlX2lkPzogc3RyaW5nXHJcbiAgdGhyZWFkX2lkPzogc3RyaW5nXHJcbiAgYXV0b21hdGVkOiBib29sZWFuXHJcbiAgYWlfZ2VuZXJhdGVkOiBib29sZWFuXHJcbiAgYWlfcHJvbXB0Pzogc3RyaW5nXHJcbiAgdGVtcGxhdGVfdXNlZD86IHN0cmluZ1xyXG4gIHNjaGVkdWxlZF9mb3I/OiBzdHJpbmdcclxuICBzZW50X2F0Pzogc3RyaW5nXHJcbiAgZGVsaXZlcmVkX2F0Pzogc3RyaW5nXHJcbiAgcmVhZF9hdD86IHN0cmluZ1xyXG4gIHJlcGxpZWRfYXQ/OiBzdHJpbmdcclxuICBmYWlsdXJlX3JlYXNvbj86IHN0cmluZ1xyXG4gIHJldHJ5X2NvdW50OiBudW1iZXJcclxuICBtZXRhZGF0YToge1xyXG4gICAgdXNlckFnZW50Pzogc3RyaW5nXHJcbiAgICBpcEFkZHJlc3M/OiBzdHJpbmdcclxuICAgIGRldmljZUluZm8/OiBzdHJpbmdcclxuICAgIGxvY2F0aW9uPzogc3RyaW5nXHJcbiAgICByZXNwb25zZVRpbWU/OiBudW1iZXJcclxuICAgIGNoYXJhY3RlckNvdW50PzogbnVtYmVyXHJcbiAgICB3b3JkQ291bnQ/OiBudW1iZXJcclxuICB9XHJcbiAgYXR0YWNobWVudHM6IEFycmF5PHtcclxuICAgIHR5cGU6IHN0cmluZ1xyXG4gICAgdXJsOiBzdHJpbmdcclxuICAgIGZpbGVuYW1lOiBzdHJpbmdcclxuICAgIHNpemU6IG51bWJlclxyXG4gICAgbWltZVR5cGU6IHN0cmluZ1xyXG4gIH0+XHJcbiAgYW5hbHl0aWNzOiB7XHJcbiAgICBvcGVuZWQ6IGJvb2xlYW5cclxuICAgIG9wZW5lZEF0Pzogc3RyaW5nXHJcbiAgICBjbGlja2VkTGlua3M6IEFycmF5PHtcclxuICAgICAgdXJsOiBzdHJpbmdcclxuICAgICAgY2xpY2tlZEF0OiBzdHJpbmdcclxuICAgIH0+XHJcbiAgICByZXNwb25zZVJlY2VpdmVkOiBib29sZWFuXHJcbiAgICByZXNwb25zZVRpbWU/OiBudW1iZXJcclxuICAgIHNlbnRpbWVudDogJ3Bvc2l0aXZlJyB8ICduZXV0cmFsJyB8ICduZWdhdGl2ZSdcclxuICAgIGxlYWRRdWFsaXR5OiAnaG90JyB8ICd3YXJtJyB8ICdjb2xkJyB8ICd1bnF1YWxpZmllZCdcclxuICB9XHJcbiAgdGFnczogc3RyaW5nW11cclxuICBpc19hcmNoaXZlZDogYm9vbGVhblxyXG4gIGlzX3N0YXJyZWQ6IGJvb2xlYW5cclxuICBpc19pbXBvcnRhbnQ6IGJvb2xlYW5cclxuICBjcmVhdGVkX2F0OiBzdHJpbmdcclxuICB1cGRhdGVkX2F0OiBzdHJpbmdcclxufVxyXG5cclxuLy8gVXNlciBvcGVyYXRpb25zXHJcbmV4cG9ydCBjb25zdCB1c2VyT3BlcmF0aW9ucyA9IHtcclxuICBhc3luYyBjcmVhdGUodXNlckRhdGE6IE9taXQ8VXNlciwgJ2lkJyB8ICdjcmVhdGVkX2F0JyB8ICd1cGRhdGVkX2F0Jz4pIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBDbGVhbiBhbmQgdmFsaWRhdGUgdXNlciBkYXRhXHJcbiAgICBjb25zdCBjbGVhblVzZXJEYXRhID0ge1xyXG4gICAgICBlbWFpbDogdXNlckRhdGEuZW1haWwudG9Mb3dlckNhc2UoKSxcclxuICAgICAgcGFzc3dvcmRfaGFzaDogdXNlckRhdGEucGFzc3dvcmRfaGFzaCxcclxuICAgICAgZmlyc3RfbmFtZTogdXNlckRhdGEuZmlyc3RfbmFtZSxcclxuICAgICAgbGFzdF9uYW1lOiB1c2VyRGF0YS5sYXN0X25hbWUsXHJcbiAgICAgIGNvbXBhbnk6IHVzZXJEYXRhLmNvbXBhbnkgfHwgbnVsbCxcclxuICAgICAgcm9sZTogdXNlckRhdGEucm9sZSB8fCAndXNlcicsXHJcbiAgICAgIHN1YnNjcmlwdGlvbjogdXNlckRhdGEuc3Vic2NyaXB0aW9uIHx8IHsgcGxhbjogJ2ZyZWUnLCBzdGF0dXM6ICdpbmFjdGl2ZScgfSxcclxuICAgICAgZW1haWxfdmVyaWZpZWQ6IHVzZXJEYXRhLmVtYWlsX3ZlcmlmaWVkICE9PSB1bmRlZmluZWQgPyB1c2VyRGF0YS5lbWFpbF92ZXJpZmllZCA6IGZhbHNlLFxyXG4gICAgICBvbmJvYXJkaW5nX2NvbXBsZXRlOiB1c2VyRGF0YS5vbmJvYXJkaW5nX2NvbXBsZXRlICE9PSB1bmRlZmluZWQgPyB1c2VyRGF0YS5vbmJvYXJkaW5nX2NvbXBsZXRlIDogZmFsc2UsXHJcbiAgICAgIGlzX2FjdGl2ZTogdXNlckRhdGEuaXNfYWN0aXZlICE9PSB1bmRlZmluZWQgPyB1c2VyRGF0YS5pc19hY3RpdmUgOiB0cnVlLFxyXG4gICAgICBsaW5rZWRpbl9hY2NvdW50czogdXNlckRhdGEubGlua2VkaW5fYWNjb3VudHMgfHwgW10sXHJcbiAgICAgIGVtYWlsX2FjY291bnRzOiB1c2VyRGF0YS5lbWFpbF9hY2NvdW50cyB8fCBbXSxcclxuICAgICAgYXBpX2tleXM6IHVzZXJEYXRhLmFwaV9rZXlzIHx8IHt9LFxyXG4gICAgICBzZXR0aW5nczogdXNlckRhdGEuc2V0dGluZ3MgfHwge1xyXG4gICAgICAgIHRpbWV6b25lOiAnVVRDJyxcclxuICAgICAgICB3b3JraW5nSG91cnM6IHsgc3RhcnQ6IDksIGVuZDogMTggfSxcclxuICAgICAgICB3b3JraW5nRGF5czogWzEsIDIsIDMsIDQsIDVdLFxyXG4gICAgICAgIGF1dG9tYXRpb246IHtcclxuICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgY29ubmVjdGlvblJlcXVlc3RzOiB7IGVuYWJsZWQ6IGZhbHNlIH0sXHJcbiAgICAgICAgICB3ZWxjb21lTWVzc2FnZXM6IHsgZW5hYmxlZDogZmFsc2UgfSxcclxuICAgICAgICAgIGZvbGxvd1VwTWVzc2FnZXM6IHsgZW5hYmxlZDogZmFsc2UgfSxcclxuICAgICAgICAgIHByb2ZpbGVWaWV3czogeyBlbmFibGVkOiBmYWxzZSB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBub3RpZmljYXRpb25zOiB7XHJcbiAgICAgICAgICBlbWFpbDogdHJ1ZSxcclxuICAgICAgICAgIHdlYmhvb2s6IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICB1c2FnZTogdXNlckRhdGEudXNhZ2UgfHwge1xyXG4gICAgICAgIHRvdGFsQ29ubmVjdGlvbnM6IDAsXHJcbiAgICAgICAgdG90YWxNZXNzYWdlczogMCxcclxuICAgICAgICB0b3RhbENhbXBhaWduczogMCxcclxuICAgICAgICB0b3RhbFByb3NwZWN0czogMFxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgndXNlcnMnKVxyXG4gICAgICAuaW5zZXJ0KFtjbGVhblVzZXJEYXRhXSlcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGVycm9yIGNyZWF0aW5nIHVzZXI6JywgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgdXNlcjogJHtlcnJvci5tZXNzYWdlfWApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoIWRhdGEpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIGNyZWF0aW9uIGZhaWxlZCAtIG5vIGRhdGEgcmV0dXJuZWQnKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGRhdGE7XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZmluZEJ5RW1haWwoZW1haWw6IHN0cmluZykge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KClcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCd1c2VycycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2VtYWlsJywgZW1haWwudG9Mb3dlckNhc2UoKSlcclxuICAgICAgLnNpbmdsZSgpXHJcbiAgICBcclxuICAgIGlmIChlcnJvciAmJiBlcnJvci5jb2RlICE9PSAnUEdSU1QxMTYnKSB0aHJvdyBlcnJvclxyXG4gICAgcmV0dXJuIGRhdGFcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlJZChpZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKVxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3VzZXJzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgnaWQnLCBpZClcclxuICAgICAgLnNpbmdsZSgpXHJcbiAgICBcclxuICAgIGlmIChlcnJvciAmJiBlcnJvci5jb2RlICE9PSAnUEdSU1QxMTYnKSB0aHJvdyBlcnJvclxyXG4gICAgcmV0dXJuIGRhdGFcclxuICB9LFxyXG5cclxuICBhc3luYyB1cGRhdGUoaWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxVc2VyPikge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KClcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCd1c2VycycpXHJcbiAgICAgIC51cGRhdGUodXBkYXRlcylcclxuICAgICAgLmVxKCdpZCcsIGlkKVxyXG4gICAgICAuc2VsZWN0KClcclxuICAgICAgLnNpbmdsZSgpXHJcbiAgICBcclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZGVsZXRlKGlkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpXHJcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgndXNlcnMnKVxyXG4gICAgICAuZGVsZXRlKClcclxuICAgICAgLmVxKCdpZCcsIGlkKVxyXG4gICAgXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZmluZEFsbChvcHRpb25zOiB7XHJcbiAgICBwYWdlPzogbnVtYmVyXHJcbiAgICBsaW1pdD86IG51bWJlclxyXG4gICAgc2VhcmNoPzogc3RyaW5nXHJcbiAgICByb2xlPzogc3RyaW5nXHJcbiAgICBzdGF0dXM/OiBzdHJpbmdcclxuICB9ID0ge30pIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpXHJcbiAgICBsZXQgcXVlcnkgPSBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgndXNlcnMnKVxyXG4gICAgICAuc2VsZWN0KCdpZCwgZW1haWwsIGZpcnN0X25hbWUsIGxhc3RfbmFtZSwgY29tcGFueSwgcm9sZSwgc3Vic2NyaXB0aW9uLCBpc19hY3RpdmUsIGxhc3RfbG9naW4sIGNyZWF0ZWRfYXQnLCB7IGNvdW50OiAnZXhhY3QnIH0pXHJcblxyXG4gICAgaWYgKG9wdGlvbnMuc2VhcmNoKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkub3IoYGVtYWlsLmlsaWtlLiUke29wdGlvbnMuc2VhcmNofSUsZmlyc3RfbmFtZS5pbGlrZS4lJHtvcHRpb25zLnNlYXJjaH0lLGxhc3RfbmFtZS5pbGlrZS4lJHtvcHRpb25zLnNlYXJjaH0lLGNvbXBhbnkuaWxpa2UuJSR7b3B0aW9ucy5zZWFyY2h9JWApXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG9wdGlvbnMucm9sZSAmJiBvcHRpb25zLnJvbGUgIT09ICdhbGwnKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ3JvbGUnLCBvcHRpb25zLnJvbGUpXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG9wdGlvbnMuc3RhdHVzICYmIG9wdGlvbnMuc3RhdHVzICE9PSAnYWxsJykge1xyXG4gICAgICBjb25zdCBpc0FjdGl2ZSA9IG9wdGlvbnMuc3RhdHVzID09PSAnYWN0aXZlJ1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdpc19hY3RpdmUnLCBpc0FjdGl2ZSlcclxuICAgIH1cclxuXHJcbiAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXHJcblxyXG4gICAgaWYgKG9wdGlvbnMubGltaXQpIHtcclxuICAgICAgY29uc3QgZnJvbSA9ICgob3B0aW9ucy5wYWdlIHx8IDEpIC0gMSkgKiBvcHRpb25zLmxpbWl0XHJcbiAgICAgIGNvbnN0IHRvID0gZnJvbSArIG9wdGlvbnMubGltaXQgLSAxXHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkucmFuZ2UoZnJvbSwgdG8pXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciwgY291bnQgfSA9IGF3YWl0IHF1ZXJ5XHJcbiAgICBcclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcclxuICAgIFxyXG4gICAgLy8gRW5zdXJlIHdlIHJldHVybiB2YWxpZCBkYXRhIHN0cnVjdHVyZVxyXG4gICAgY29uc3QgdXNlcnMgPSBBcnJheS5pc0FycmF5KGRhdGEpID8gZGF0YSA6IFtdO1xyXG4gICAgY29uc3QgdG90YWwgPSB0eXBlb2YgY291bnQgPT09ICdudW1iZXInID8gY291bnQgOiAwO1xyXG4gICAgXHJcbiAgICByZXR1cm4geyB1c2VycywgdG90YWwgfVxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGNvbXBhcmVQYXNzd29yZChwbGFpblBhc3N3b3JkOiBzdHJpbmcsIGhhc2hlZFBhc3N3b3JkOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBiY3J5cHQuY29tcGFyZShwbGFpblBhc3N3b3JkLCBoYXNoZWRQYXNzd29yZClcclxuICB9LFxyXG5cclxuICBhc3luYyBoYXNoUGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZykge1xyXG4gICAgY29uc3Qgc2FsdCA9IGF3YWl0IGJjcnlwdC5nZW5TYWx0KDEyKVxyXG4gICAgcmV0dXJuIGJjcnlwdC5oYXNoKHBhc3N3b3JkLCBzYWx0KVxyXG4gIH1cclxufVxyXG5cclxuLy8gQ2FtcGFpZ24gb3BlcmF0aW9uc1xyXG5leHBvcnQgY29uc3QgY2FtcGFpZ25PcGVyYXRpb25zID0ge1xyXG4gIGFzeW5jIGNyZWF0ZShjYW1wYWlnbkRhdGE6IE9taXQ8Q2FtcGFpZ24sICdpZCcgfCAnY3JlYXRlZF9hdCcgfCAndXBkYXRlZF9hdCc+KSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKVxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2NhbXBhaWducycpXHJcbiAgICAgIC5pbnNlcnQoW2NhbXBhaWduRGF0YV0pXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKClcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG4gICAgcmV0dXJuIGRhdGFcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlVc2VySWQodXNlcklkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2FtcGFpZ25zJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcclxuICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXHJcbiAgICBcclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcclxuICAgIHJldHVybiBkYXRhIHx8IFtdXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZmluZEJ5SWQoaWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpIHtcclxuICAgIGNvbnNvbGUubG9nKGlkICwgdXNlcklkKVxyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KClcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjYW1wYWlnbnMnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdpZCcsIGlkKVxyXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXHJcbiAgICAgIC5zaW5nbGUoKVxyXG5cclxuICAgICAgY29uc29sZS5sb2coYGRhdGEgJHtKU09OLnN0cmluZ2lmeShkYXRhKX1gKVxyXG4gICAgXHJcbiAgICBpZiAoZXJyb3IgJiYgZXJyb3IuY29kZSAhPT0gJ1BHUlNUMTE2JykgdGhyb3cgZXJyb3JcclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgdXBkYXRlKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPENhbXBhaWduPikge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KClcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjYW1wYWlnbnMnKVxyXG4gICAgICAudXBkYXRlKHVwZGF0ZXMpXHJcbiAgICAgIC5lcSgnaWQnLCBpZClcclxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxyXG4gICAgICAuc2VsZWN0KClcclxuICAgICAgLnNpbmdsZSgpXHJcbiAgICBcclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZGVsZXRlKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKVxyXG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2NhbXBhaWducycpXHJcbiAgICAgIC5kZWxldGUoKVxyXG4gICAgICAuZXEoJ2lkJywgaWQpXHJcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG4gIH1cclxufVxyXG5cclxuLy8gUHJvc3BlY3Qgb3BlcmF0aW9uc1xyXG5leHBvcnQgY29uc3QgcHJvc3BlY3RPcGVyYXRpb25zID0ge1xyXG4gIGFzeW5jIGNyZWF0ZShwcm9zcGVjdERhdGE6IE9taXQ8UHJvc3BlY3QsICdpZCcgfCAnY3JlYXRlZF9hdCcgfCAndXBkYXRlZF9hdCc+KSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKVxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3Byb3NwZWN0cycpXHJcbiAgICAgIC5pbnNlcnQoW3Byb3NwZWN0RGF0YV0pXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKClcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG4gICAgcmV0dXJuIGRhdGFcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlVc2VySWQodXNlcklkOiBzdHJpbmcsIG9wdGlvbnM/OiB7XHJcbiAgICBwYWdlPzogbnVtYmVyXHJcbiAgICBsaW1pdD86IG51bWJlclxyXG4gICAgc2VhcmNoPzogc3RyaW5nXHJcbiAgICBzdGF0dXM/OiBzdHJpbmdcclxuICAgIGNhbXBhaWduSWQ/OiBzdHJpbmdcclxuICB9KSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKVxyXG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3Byb3NwZWN0cycpXHJcbiAgICAgIC5zZWxlY3QoYCosY2FtcGFpZ25zIWlubmVyKGlkLCBuYW1lKWAsIHsgY291bnQ6ICdleGFjdCcgfSlcclxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxyXG5cclxuICAgIGlmIChvcHRpb25zPy5zZWFyY2gpIHtcclxuICAgICAgcXVlcnkgPSBxdWVyeS5vcihgbGlua2VkaW5fZGF0YS0+Pm5hbWUuaWxpa2UuJSR7b3B0aW9ucy5zZWFyY2h9JSxsaW5rZWRpbl9kYXRhLT4+Y29tcGFueS5pbGlrZS4lJHtvcHRpb25zLnNlYXJjaH0lLGxpbmtlZGluX2RhdGEtPj50aXRsZS5pbGlrZS4lJHtvcHRpb25zLnNlYXJjaH0lYClcclxuICAgIH1cclxuXHJcbiAgICBpZiAob3B0aW9ucz8uc3RhdHVzICYmIG9wdGlvbnMuc3RhdHVzICE9PSAnYWxsJykge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdzdGF0dXMnLCBvcHRpb25zLnN0YXR1cylcclxuICAgIH1cclxuXHJcbiAgICBpZiAob3B0aW9ucz8uY2FtcGFpZ25JZCAmJiBvcHRpb25zLmNhbXBhaWduSWQgIT09ICdhbGwnKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2NhbXBhaWduX2lkJywgb3B0aW9ucy5jYW1wYWlnbklkKVxyXG4gICAgfVxyXG5cclxuICAgIHF1ZXJ5ID0gcXVlcnkub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcclxuXHJcbiAgICBpZiAob3B0aW9ucz8ubGltaXQpIHtcclxuICAgICAgY29uc3QgZnJvbSA9ICgob3B0aW9ucy5wYWdlIHx8IDEpIC0gMSkgKiBvcHRpb25zLmxpbWl0XHJcbiAgICAgIGNvbnN0IHRvID0gZnJvbSArIG9wdGlvbnMubGltaXQgLSAxXHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkucmFuZ2UoZnJvbSwgdG8pXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciwgY291bnQgfSA9IGF3YWl0IHF1ZXJ5XHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXHJcbiAgICByZXR1cm4geyBpdGVtczogZGF0YSB8fCBbXSwgdG90YWw6IGNvdW50ID8/IChkYXRhID8gZGF0YS5sZW5ndGggOiAwKSB9XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZmluZEJ5SWQoaWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHJvc3BlY3RzJylcclxuICAgICAgLnNlbGVjdChgXHJcbiAgICAgICAgKixcclxuICAgICAgICBjYW1wYWlnbnMhaW5uZXIoaWQsIG5hbWUpXHJcbiAgICAgIGApXHJcbiAgICAgIC5lcSgnaWQnLCBpZClcclxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxyXG4gICAgICAuc2luZ2xlKClcclxuICAgIFxyXG4gICAgaWYgKGVycm9yICYmIGVycm9yLmNvZGUgIT09ICdQR1JTVDExNicpIHRocm93IGVycm9yXHJcbiAgICByZXR1cm4gZGF0YVxyXG4gIH0sXHJcblxyXG4gIGFzeW5jIHVwZGF0ZShpZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxQcm9zcGVjdD4pIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncHJvc3BlY3RzJylcclxuICAgICAgLnVwZGF0ZSh7IC4uLnVwZGF0ZXMsIGxhc3RfdXBkYXRlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpIH0pXHJcbiAgICAgIC5lcSgnaWQnLCBpZClcclxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxyXG4gICAgICAuc2VsZWN0KGBcclxuICAgICAgICAqLFxyXG4gICAgICAgIGNhbXBhaWducyFpbm5lcihpZCwgbmFtZSlcclxuICAgICAgYClcclxuICAgICAgLnNpbmdsZSgpXHJcbiAgICBcclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZGVsZXRlKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKVxyXG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ3Byb3NwZWN0cycpXHJcbiAgICAgIC5kZWxldGUoKVxyXG4gICAgICAuZXEoJ2lkJywgaWQpXHJcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG4gIH1cclxufVxyXG5cclxuLy8gTWVzc2FnZSBvcGVyYXRpb25zXHJcbmV4cG9ydCBjb25zdCBtZXNzYWdlT3BlcmF0aW9ucyA9IHtcclxuICBhc3luYyBjcmVhdGUobWVzc2FnZURhdGE6IE9taXQ8TWVzc2FnZSwgJ2lkJyB8ICdjcmVhdGVkX2F0JyB8ICd1cGRhdGVkX2F0Jz4pIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VDbGllbnQoKVxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ21lc3NhZ2VzJylcclxuICAgICAgLmluc2VydChbbWVzc2FnZURhdGFdKVxyXG4gICAgICAuc2VsZWN0KGBcclxuICAgICAgICAqLFxyXG4gICAgICAgIHByb3NwZWN0cyFpbm5lcihpZCwgbGlua2VkaW5fZGF0YSlcclxuICAgICAgYClcclxuICAgICAgLnNpbmdsZSgpXHJcbiAgICBcclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZmluZEJ5VXNlcklkKHVzZXJJZDogc3RyaW5nLCBvcHRpb25zPzoge1xyXG4gICAgY29udmVyc2F0aW9uSWQ/OiBzdHJpbmdcclxuICAgIHBhZ2U/OiBudW1iZXJcclxuICAgIGxpbWl0PzogbnVtYmVyXHJcbiAgfSkge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUNsaWVudCgpXHJcbiAgICBsZXQgcXVlcnkgPSBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnbWVzc2FnZXMnKVxyXG4gICAgICAuc2VsZWN0KGBcclxuICAgICAgICAqLFxyXG4gICAgICAgIHByb3NwZWN0cyFpbm5lcihpZCwgbGlua2VkaW5fZGF0YSlcclxuICAgICAgYClcclxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxyXG5cclxuICAgIGlmIChvcHRpb25zPy5jb252ZXJzYXRpb25JZCkge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdjb252ZXJzYXRpb25faWQnLCBvcHRpb25zLmNvbnZlcnNhdGlvbklkKVxyXG4gICAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IHRydWUgfSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcclxuICAgIH1cclxuXHJcbiAgICBpZiAob3B0aW9ucz8ubGltaXQpIHtcclxuICAgICAgY29uc3QgZnJvbSA9ICgob3B0aW9ucy5wYWdlIHx8IDEpIC0gMSkgKiBvcHRpb25zLmxpbWl0XHJcbiAgICAgIGNvbnN0IHRvID0gZnJvbSArIG9wdGlvbnMubGltaXQgLSAxXHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkucmFuZ2UoZnJvbSwgdG8pXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgcXVlcnlcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG4gICAgcmV0dXJuIGRhdGEgfHwgW11cclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlJZChpZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZykge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUNsaWVudCgpXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnbWVzc2FnZXMnKVxyXG4gICAgICAuc2VsZWN0KGBcclxuICAgICAgICAqLFxyXG4gICAgICAgIHByb3NwZWN0cyFpbm5lcihpZCwgbGlua2VkaW5fZGF0YSlcclxuICAgICAgYClcclxuICAgICAgLmVxKCdpZCcsIGlkKVxyXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXHJcbiAgICAgIC5zaW5nbGUoKVxyXG4gICAgXHJcbiAgICBpZiAoZXJyb3IgJiYgZXJyb3IuY29kZSAhPT0gJ1BHUlNUMTE2JykgdGhyb3cgZXJyb3JcclxuICAgIHJldHVybiBkYXRhXHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgdXBkYXRlKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPE1lc3NhZ2U+KSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQ2xpZW50KClcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdtZXNzYWdlcycpXHJcbiAgICAgIC51cGRhdGUodXBkYXRlcylcclxuICAgICAgLmVxKCdpZCcsIGlkKVxyXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXHJcbiAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgICosXHJcbiAgICAgICAgcHJvc3BlY3RzIWlubmVyKGlkLCBsaW5rZWRpbl9kYXRhKVxyXG4gICAgICBgKVxyXG4gICAgICAuc2luZ2xlKClcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxyXG4gICAgcmV0dXJuIGRhdGFcclxuICB9LFxyXG5cclxuICBhc3luYyBtYXJrQXNSZWFkKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQ2xpZW50KClcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdtZXNzYWdlcycpXHJcbiAgICAgIC51cGRhdGUoe1xyXG4gICAgICAgIHN0YXR1czogJ3JlYWQnLFxyXG4gICAgICAgIHJlYWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICBhbmFseXRpY3M6IHtcclxuICAgICAgICAgIG9wZW5lZDogdHJ1ZSxcclxuICAgICAgICAgIG9wZW5lZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAgIC5lcSgnaWQnLCBpZClcclxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxyXG4gICAgICAuZXEoJ3R5cGUnLCAncmVjZWl2ZWQnKVxyXG4gICAgICAuc2VsZWN0KGBcclxuICAgICAgICAqLFxyXG4gICAgICAgIHByb3NwZWN0cyFpbm5lcihpZCwgbGlua2VkaW5fZGF0YSlcclxuICAgICAgYClcclxuICAgICAgLnNpbmdsZSgpXHJcbiAgICBcclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcclxuICAgIHJldHVybiBkYXRhXHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbImdldFN1cGFiYXNlQ2xpZW50IiwiZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCIsImJjcnlwdCIsInVzZXJPcGVyYXRpb25zIiwiY3JlYXRlIiwidXNlckRhdGEiLCJzdXBhYmFzZSIsImNsZWFuVXNlckRhdGEiLCJlbWFpbCIsInRvTG93ZXJDYXNlIiwicGFzc3dvcmRfaGFzaCIsImZpcnN0X25hbWUiLCJsYXN0X25hbWUiLCJjb21wYW55Iiwicm9sZSIsInN1YnNjcmlwdGlvbiIsInBsYW4iLCJzdGF0dXMiLCJlbWFpbF92ZXJpZmllZCIsInVuZGVmaW5lZCIsIm9uYm9hcmRpbmdfY29tcGxldGUiLCJpc19hY3RpdmUiLCJsaW5rZWRpbl9hY2NvdW50cyIsImVtYWlsX2FjY291bnRzIiwiYXBpX2tleXMiLCJzZXR0aW5ncyIsInRpbWV6b25lIiwid29ya2luZ0hvdXJzIiwic3RhcnQiLCJlbmQiLCJ3b3JraW5nRGF5cyIsImF1dG9tYXRpb24iLCJlbmFibGVkIiwiY29ubmVjdGlvblJlcXVlc3RzIiwid2VsY29tZU1lc3NhZ2VzIiwiZm9sbG93VXBNZXNzYWdlcyIsInByb2ZpbGVWaWV3cyIsIm5vdGlmaWNhdGlvbnMiLCJ3ZWJob29rIiwidXNhZ2UiLCJ0b3RhbENvbm5lY3Rpb25zIiwidG90YWxNZXNzYWdlcyIsInRvdGFsQ2FtcGFpZ25zIiwidG90YWxQcm9zcGVjdHMiLCJkYXRhIiwiZXJyb3IiLCJmcm9tIiwiaW5zZXJ0Iiwic2VsZWN0Iiwic2luZ2xlIiwiY29uc29sZSIsIkVycm9yIiwibWVzc2FnZSIsImZpbmRCeUVtYWlsIiwiZXEiLCJjb2RlIiwiZmluZEJ5SWQiLCJpZCIsInVwZGF0ZSIsInVwZGF0ZXMiLCJkZWxldGUiLCJmaW5kQWxsIiwib3B0aW9ucyIsInF1ZXJ5IiwiY291bnQiLCJzZWFyY2giLCJvciIsImlzQWN0aXZlIiwib3JkZXIiLCJhc2NlbmRpbmciLCJsaW1pdCIsInBhZ2UiLCJ0byIsInJhbmdlIiwidXNlcnMiLCJBcnJheSIsImlzQXJyYXkiLCJ0b3RhbCIsImNvbXBhcmVQYXNzd29yZCIsInBsYWluUGFzc3dvcmQiLCJoYXNoZWRQYXNzd29yZCIsImNvbXBhcmUiLCJoYXNoUGFzc3dvcmQiLCJwYXNzd29yZCIsInNhbHQiLCJnZW5TYWx0IiwiaGFzaCIsImNhbXBhaWduT3BlcmF0aW9ucyIsImNhbXBhaWduRGF0YSIsImZpbmRCeVVzZXJJZCIsInVzZXJJZCIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcm9zcGVjdE9wZXJhdGlvbnMiLCJwcm9zcGVjdERhdGEiLCJjYW1wYWlnbklkIiwiaXRlbXMiLCJsZW5ndGgiLCJsYXN0X3VwZGF0ZWQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJtZXNzYWdlT3BlcmF0aW9ucyIsIm1lc3NhZ2VEYXRhIiwiY29udmVyc2F0aW9uSWQiLCJtYXJrQXNSZWFkIiwicmVhZF9hdCIsImFuYWx5dGljcyIsIm9wZW5lZCIsIm9wZW5lZEF0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/database.ts\n");

/***/ }),

/***/ "(api)/./lib/middleware/withAuth.ts":
/*!************************************!*\
  !*** ./lib/middleware/withAuth.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   withAdminAuth: () => (/* binding */ withAdminAuth),\n/* harmony export */   withAuth: () => (/* binding */ withAuth)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../supabase */ \"(api)/./lib/supabase.ts\");\n\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key\";\nfunction withAuth(handler) {\n    return async (req, res)=>{\n        try {\n            const token = req.headers.authorization?.replace(\"Bearer \", \"\");\n            if (!token) {\n                return res.status(401).json({\n                    success: false,\n                    error: \"Access denied. No token provided.\"\n                });\n            }\n            let decoded;\n            try {\n                decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, JWT_SECRET);\n            } catch (jwtError) {\n                console.error(\"JWT verification failed:\", jwtError);\n                return res.status(401).json({\n                    success: false,\n                    error: \"Invalid or expired token.\"\n                });\n            }\n            const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_1__.getSupabaseAdminClient)();\n            const { data: user, error: userError } = await supabase.from(\"users\").select(\"*\").eq(\"id\", decoded.id).single();\n            if (userError || !user) {\n                return res.status(401).json({\n                    success: false,\n                    error: \"Invalid token. User not found.\"\n                });\n            }\n            if (!user.is_active) {\n                return res.status(401).json({\n                    success: false,\n                    error: \"Account is deactivated.\"\n                });\n            }\n            req.user = user;\n            return handler(req, res);\n        } catch (error) {\n            console.error(\"Auth middleware error:\", error);\n            return res.status(500).json({\n                success: false,\n                error: \"Server error during authentication.\"\n            });\n        }\n    };\n}\nfunction withAdminAuth(handler) {\n    return withAuth(async (req, res)=>{\n        if (req.user?.role !== \"admin\") {\n            return res.status(403).json({\n                success: false,\n                error: \"Access denied. Admin privileges required.\"\n            });\n        }\n        return handler(req, res);\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvbWlkZGxld2FyZS93aXRoQXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUErQjtBQUVzQjtBQUVyRCxNQUFNRSxhQUFhQyxRQUFRQyxHQUFHLENBQUNGLFVBQVUsSUFBSTtBQVd0QyxTQUFTRyxTQUFTQyxPQUE2QjtJQUNwRCxPQUFPLE9BQU9DLEtBQTJCQztRQUN2QyxJQUFJO1lBQ0YsTUFBTUMsUUFBUUYsSUFBSUcsT0FBTyxDQUFDQyxhQUFhLEVBQUVDLFFBQVEsV0FBVztZQUU1RCxJQUFJLENBQUNILE9BQU87Z0JBQ1YsT0FBT0QsSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFDMUJDLFNBQVM7b0JBQ1RDLE9BQU87Z0JBQ1Q7WUFDRjtZQUVBLElBQUlDO1lBQ0osSUFBSTtnQkFDRkEsVUFBVWpCLDBEQUFVLENBQUNTLE9BQU9QO1lBQzlCLEVBQUUsT0FBT2lCLFVBQVU7Z0JBQ2pCQyxRQUFRSixLQUFLLENBQUMsNEJBQTRCRztnQkFDMUMsT0FBT1gsSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFDMUJDLFNBQVM7b0JBQ1RDLE9BQU87Z0JBQ1Q7WUFDRjtZQUVBLE1BQU1LLFdBQVdwQixpRUFBc0JBO1lBQ3ZDLE1BQU0sRUFBRXFCLE1BQU1DLElBQUksRUFBRVAsT0FBT1EsU0FBUyxFQUFFLEdBQUcsTUFBTUgsU0FDNUNJLElBQUksQ0FBQyxTQUNMQyxNQUFNLENBQUMsS0FDUEMsRUFBRSxDQUFDLE1BQU1WLFFBQVFXLEVBQUUsRUFDbkJDLE1BQU07WUFFVCxJQUFJTCxhQUFhLENBQUNELE1BQU07Z0JBQ3RCLE9BQU9mLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQzFCQyxTQUFTO29CQUNUQyxPQUFPO2dCQUNUO1lBQ0Y7WUFFQSxJQUFJLENBQUNPLEtBQUtPLFNBQVMsRUFBRTtnQkFDbkIsT0FBT3RCLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQzFCQyxTQUFTO29CQUNUQyxPQUFPO2dCQUNUO1lBQ0Y7WUFFQVQsSUFBSWdCLElBQUksR0FBR0E7WUFDWCxPQUFPakIsUUFBUUMsS0FBS0M7UUFDdEIsRUFBRSxPQUFPUSxPQUFPO1lBQ2RJLFFBQVFKLEtBQUssQ0FBQywwQkFBMEJBO1lBRXhDLE9BQU9SLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQzFCQyxTQUFTO2dCQUNUQyxPQUFPO1lBQ1Q7UUFDRjtJQUNGO0FBQ0Y7QUFFTyxTQUFTZSxjQUFjekIsT0FBNkI7SUFDekQsT0FBT0QsU0FBUyxPQUFPRSxLQUEyQkM7UUFDaEQsSUFBSUQsSUFBSWdCLElBQUksRUFBRVMsU0FBUyxTQUFTO1lBQzlCLE9BQU94QixJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUMxQkMsU0FBUztnQkFDVEMsT0FBTztZQUNUO1FBQ0Y7UUFFQSxPQUFPVixRQUFRQyxLQUFLQztJQUN0QjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbHluY2JvdC1uZXh0anMvLi9saWIvbWlkZGxld2FyZS93aXRoQXV0aC50cz9lMTIxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcclxuaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xyXG5pbXBvcnQgeyBnZXRTdXBhYmFzZUFkbWluQ2xpZW50IH0gZnJvbSAnLi4vc3VwYWJhc2UnO1xyXG5cclxuY29uc3QgSldUX1NFQ1JFVCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgfHwgJ3lvdXItc2VjcmV0LWtleSc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEF1dGhlbnRpY2F0ZWRSZXF1ZXN0IGV4dGVuZHMgTmV4dEFwaVJlcXVlc3Qge1xyXG4gIHVzZXI/OiBhbnk7XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIEF1dGhlbnRpY2F0ZWRIYW5kbGVyID0gKFxyXG4gIHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsXHJcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2VcclxuKSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZDtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB3aXRoQXV0aChoYW5kbGVyOiBBdXRoZW50aWNhdGVkSGFuZGxlcikge1xyXG4gIHJldHVybiBhc3luYyAocmVxOiBBdXRoZW50aWNhdGVkUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbj8ucmVwbGFjZSgnQmVhcmVyICcsICcnKTtcclxuICAgICAgXHJcbiAgICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdBY2Nlc3MgZGVuaWVkLiBObyB0b2tlbiBwcm92aWRlZC4nIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgZGVjb2RlZDtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVCkgYXMgYW55O1xyXG4gICAgICB9IGNhdGNoIChqd3RFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0pXVCB2ZXJpZmljYXRpb24gZmFpbGVkOicsIGp3dEVycm9yKTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIG9yIGV4cGlyZWQgdG9rZW4uJyBcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KCk7XHJcbiAgICAgIGNvbnN0IHsgZGF0YTogdXNlciwgZXJyb3I6IHVzZXJFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgndXNlcnMnKVxyXG4gICAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAgIC5lcSgnaWQnLCBkZWNvZGVkLmlkKVxyXG4gICAgICAgIC5zaW5nbGUoKTtcclxuICAgICAgXHJcbiAgICAgIGlmICh1c2VyRXJyb3IgfHwgIXVzZXIpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHRva2VuLiBVc2VyIG5vdCBmb3VuZC4nIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXVzZXIuaXNfYWN0aXZlKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgXHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIGVycm9yOiAnQWNjb3VudCBpcyBkZWFjdGl2YXRlZC4nIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXEudXNlciA9IHVzZXI7XHJcbiAgICAgIHJldHVybiBoYW5kbGVyKHJlcSwgcmVzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dGggbWlkZGxld2FyZSBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ1NlcnZlciBlcnJvciBkdXJpbmcgYXV0aGVudGljYXRpb24uJyBcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhBZG1pbkF1dGgoaGFuZGxlcjogQXV0aGVudGljYXRlZEhhbmRsZXIpIHtcclxuICByZXR1cm4gd2l0aEF1dGgoYXN5bmMgKHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiB7XHJcbiAgICBpZiAocmVxLnVzZXI/LnJvbGUgIT09ICdhZG1pbicpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdBY2Nlc3MgZGVuaWVkLiBBZG1pbiBwcml2aWxlZ2VzIHJlcXVpcmVkLicgXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gaGFuZGxlcihyZXEsIHJlcyk7XHJcbiAgfSk7XHJcbn0iXSwibmFtZXMiOlsiand0IiwiZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52Iiwid2l0aEF1dGgiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwidG9rZW4iLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInJlcGxhY2UiLCJzdGF0dXMiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwiZGVjb2RlZCIsInZlcmlmeSIsImp3dEVycm9yIiwiY29uc29sZSIsInN1cGFiYXNlIiwiZGF0YSIsInVzZXIiLCJ1c2VyRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsInNpbmdsZSIsImlzX2FjdGl2ZSIsIndpdGhBZG1pbkF1dGgiLCJyb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/middleware/withAuth.ts\n");

/***/ }),

/***/ "(api)/./lib/services/emailService.ts":
/*!**************************************!*\
  !*** ./lib/services/emailService.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n// Mock transporter that simulates nodemailer without file system operations\nclass MockTransporter {\n    async sendMail(options) {\n        // Simulate email sending delay\n        await new Promise((resolve)=>setTimeout(resolve, 100));\n        // Return a mock message ID\n        return {\n            messageId: `mock-${Date.now()}@${options.from.split(\"@\")[1] || \"example.com\"}`\n        };\n    }\n    async verify() {\n        // Simulate verification delay\n        await new Promise((resolve)=>setTimeout(resolve, 50));\n        return true;\n    }\n}\n// Mock IMAP client that simulates imapflow without file system operations\nclass MockImapClient {\n    async connect() {\n        await new Promise((resolve)=>setTimeout(resolve, 100));\n        this.connected = true;\n    }\n    async getMailboxLock(folder) {\n        if (!this.connected) {\n            throw new Error(\"Not connected to IMAP server\");\n        }\n        return {\n            release: ()=>{\n            // Mock release function\n            }\n        };\n    }\n    async *fetch(query, options, limits) {\n        // Mock fetch that yields no messages to prevent file system operations\n        // In a real implementation, this would fetch actual emails\n        return;\n    }\n    async logout() {\n        await new Promise((resolve)=>setTimeout(resolve, 50));\n        this.connected = false;\n    }\n    constructor(){\n        this.connected = false;\n    }\n}\nclass EmailService {\n    async decryptPassword(encryptedPassword) {\n        // Mock decryption - in production, implement proper decryption\n        return encryptedPassword;\n    }\n    getProviderSettings(provider) {\n        switch(provider){\n            case \"gmail\":\n                return {\n                    smtp: {\n                        host: \"smtp.gmail.com\",\n                        port: 587,\n                        secure: false\n                    },\n                    imap: {\n                        host: \"imap.gmail.com\",\n                        port: 993,\n                        secure: true\n                    }\n                };\n            case \"outlook\":\n                return {\n                    smtp: {\n                        host: \"smtp-mail.outlook.com\",\n                        port: 587,\n                        secure: false\n                    },\n                    imap: {\n                        host: \"outlook.office365.com\",\n                        port: 993,\n                        secure: true\n                    }\n                };\n            default:\n                return null;\n        }\n    }\n    async createTransporter(emailAccount) {\n        // Return mock transporter to prevent file system operations\n        return new MockTransporter();\n    }\n    async createImapClient(emailAccount) {\n        // Return mock IMAP client to prevent file system operations\n        return new MockImapClient();\n    }\n    async sendEmail(emailAccount, options) {\n        try {\n            const transporter = await this.createTransporter(emailAccount);\n            const mailOptions = {\n                from: options.from || emailAccount.email,\n                to: Array.isArray(options.to) ? options.to.join(\", \") : options.to,\n                cc: options.cc?.join(\", \"),\n                bcc: options.bcc?.join(\", \"),\n                subject: options.subject,\n                text: options.text,\n                html: options.html,\n                inReplyTo: options.inReplyTo,\n                references: options.references?.join(\" \"),\n                attachments: options.attachments\n            };\n            const result = await transporter.sendMail(mailOptions);\n            return result.messageId;\n        } catch (error) {\n            console.error(\"Error sending email:\", error);\n            throw error;\n        }\n    }\n    async fetchEmails(emailAccount, options = {}) {\n        try {\n            // Return empty array for mock implementation\n            // In production, this would fetch real emails\n            console.log(`Mock: Would fetch emails from ${emailAccount.email} since ${options.since?.toISOString()}`);\n            return [];\n        } catch (error) {\n            console.error(\"Error fetching emails:\", error);\n            throw error;\n        }\n    }\n    extractTextFromEmail(source) {\n        // Simple text extraction - in production, use a proper email parser\n        const lines = source.split(\"\\n\");\n        let inBody = false;\n        let textContent = \"\";\n        for (const line of lines){\n            if (line.trim() === \"\") {\n                inBody = true;\n                continue;\n            }\n            if (inBody && !line.startsWith(\"Content-\") && !line.startsWith(\"--\")) {\n                textContent += line + \"\\n\";\n            }\n        }\n        return textContent.trim();\n    }\n    extractHtmlFromEmail(source) {\n        // Simple HTML extraction - in production, use a proper email parser\n        const htmlMatch = source.match(/<html[\\s\\S]*?<\\/html>/i);\n        return htmlMatch ? htmlMatch[0] : \"\";\n    }\n    extractThreadId(envelope) {\n        // Try to extract thread ID from various headers\n        return envelope.inReplyTo || envelope.messageId || \"\";\n    }\n    async testConnection(emailAccount) {\n        try {\n            const transporter = await this.createTransporter(emailAccount);\n            await transporter.verify();\n            return true;\n        } catch (error) {\n            console.error(\"Email connection test failed:\", error);\n            return false;\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (EmailService);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RVFFLHFCQUFxQlAsTUFBYyxFQUFVO1FBQ25ELG9FQUFvRTtRQUNwRSxNQUFNUSxZQUFZUixPQUFPUyxLQUFLLENBQUM7UUFDL0IsT0FBT0QsWUFBWUEsU0FBUyxDQUFDLEVBQUUsR0FBRztJQUNwQztJQUVRRSxnQkFBZ0JDLFFBQWEsRUFBVTtRQUM3QyxnREFBZ0Q7UUFDaEQsT0FBT0EsU0FBU3RCLFNBQVMsSUFBSXNCLFNBQVNqRSxTQUFTLElBQUk7SUFDckQ7SUFFQSxNQUFNa0UsZUFBZXRDLFlBQTBCLEVBQW9CO1FBQ2pFLElBQUk7WUFDRixNQUFNRyxjQUFjLE1BQU0sSUFBSSxDQUFDSixpQkFBaUIsQ0FBQ0M7WUFDakQsTUFBTUcsWUFBWTFCLE1BQU07WUFDeEIsT0FBTztRQUNULEVBQUUsT0FBTzBDLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLGlDQUFpQ0E7WUFDL0MsT0FBTztRQUNUO0lBQ0Y7QUFDRjtBQUVBLGlFQUFlOUIsWUFBWUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2x5bmNib3QtbmV4dGpzLy4vbGliL3NlcnZpY2VzL2VtYWlsU2VydmljZS50cz9kMzk4Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBpbnRlcmZhY2UgRW1haWxBY2NvdW50IHtcclxuICBlbWFpbDogc3RyaW5nO1xyXG4gIGVuY3J5cHRlZFBhc3N3b3JkPzogc3RyaW5nO1xyXG4gIHByb3ZpZGVyOiAnZ21haWwnIHwgJ291dGxvb2snIHwgJ3NtdHAnO1xyXG4gIHNtdHBTZXR0aW5ncz86IHtcclxuICAgIGhvc3Q6IHN0cmluZztcclxuICAgIHBvcnQ6IG51bWJlcjtcclxuICAgIHNlY3VyZTogYm9vbGVhbjtcclxuICB9O1xyXG4gIGltYXBTZXR0aW5ncz86IHtcclxuICAgIGhvc3Q6IHN0cmluZztcclxuICAgIHBvcnQ6IG51bWJlcjtcclxuICAgIHNlY3VyZTogYm9vbGVhbjtcclxuICB9O1xyXG4gIGlzQWN0aXZlOiBib29sZWFuO1xyXG4gIGxhc3RTeW5jQXQ/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRW1haWxNZXNzYWdlIHtcclxuICBtZXNzYWdlSWQ6IHN0cmluZztcclxuICB0aHJlYWRJZD86IHN0cmluZztcclxuICBmcm9tOiBzdHJpbmc7XHJcbiAgdG86IHN0cmluZ1tdO1xyXG4gIGNjPzogc3RyaW5nW107XHJcbiAgYmNjPzogc3RyaW5nW107XHJcbiAgc3ViamVjdDogc3RyaW5nO1xyXG4gIGNvbnRlbnQ6IHN0cmluZztcclxuICBodG1sQ29udGVudD86IHN0cmluZztcclxuICBkYXRlOiBEYXRlO1xyXG4gIGluUmVwbHlUbz86IHN0cmluZztcclxuICByZWZlcmVuY2VzPzogc3RyaW5nW107XHJcbiAgYXR0YWNobWVudHM/OiBBcnJheTx7XHJcbiAgICBmaWxlbmFtZTogc3RyaW5nO1xyXG4gICAgY29udGVudFR5cGU6IHN0cmluZztcclxuICAgIHNpemU6IG51bWJlcjtcclxuICAgIGNvbnRlbnQ6IEJ1ZmZlcjtcclxuICB9PjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTZW5kRW1haWxPcHRpb25zIHtcclxuICB0bzogc3RyaW5nIHwgc3RyaW5nW107XHJcbiAgZnJvbTogc3RyaW5nO1xyXG4gIHN1YmplY3Q6IHN0cmluZztcclxuICB0ZXh0Pzogc3RyaW5nO1xyXG4gIGh0bWw/OiBzdHJpbmc7XHJcbiAgY2M/OiBzdHJpbmdbXTtcclxuICBiY2M/OiBzdHJpbmdbXTtcclxuICBpblJlcGx5VG8/OiBzdHJpbmc7XHJcbiAgcmVmZXJlbmNlcz86IHN0cmluZ1tdO1xyXG4gIGF0dGFjaG1lbnRzPzogQXJyYXk8e1xyXG4gICAgZmlsZW5hbWU6IHN0cmluZztcclxuICAgIGNvbnRlbnQ6IEJ1ZmZlciB8IHN0cmluZztcclxuICAgIGNvbnRlbnRUeXBlPzogc3RyaW5nO1xyXG4gIH0+O1xyXG59XHJcblxyXG4vLyBNb2NrIHRyYW5zcG9ydGVyIHRoYXQgc2ltdWxhdGVzIG5vZGVtYWlsZXIgd2l0aG91dCBmaWxlIHN5c3RlbSBvcGVyYXRpb25zXHJcbmNsYXNzIE1vY2tUcmFuc3BvcnRlciB7XHJcbiAgYXN5bmMgc2VuZE1haWwob3B0aW9uczogYW55KTogUHJvbWlzZTx7IG1lc3NhZ2VJZDogc3RyaW5nIH0+IHtcclxuICAgIC8vIFNpbXVsYXRlIGVtYWlsIHNlbmRpbmcgZGVsYXlcclxuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKTtcclxuICAgIFxyXG4gICAgLy8gUmV0dXJuIGEgbW9jayBtZXNzYWdlIElEXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBtZXNzYWdlSWQ6IGBtb2NrLSR7RGF0ZS5ub3coKX1AJHtvcHRpb25zLmZyb20uc3BsaXQoJ0AnKVsxXSB8fCAnZXhhbXBsZS5jb20nfWBcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBhc3luYyB2ZXJpZnkoKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICAvLyBTaW11bGF0ZSB2ZXJpZmljYXRpb24gZGVsYXlcclxuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBNb2NrIElNQVAgY2xpZW50IHRoYXQgc2ltdWxhdGVzIGltYXBmbG93IHdpdGhvdXQgZmlsZSBzeXN0ZW0gb3BlcmF0aW9uc1xyXG5jbGFzcyBNb2NrSW1hcENsaWVudCB7XHJcbiAgcHJpdmF0ZSBjb25uZWN0ZWQgPSBmYWxzZTtcclxuXHJcbiAgYXN5bmMgY29ubmVjdCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKTtcclxuICAgIHRoaXMuY29ubmVjdGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldE1haWxib3hMb2NrKGZvbGRlcjogc3RyaW5nKTogUHJvbWlzZTx7IHJlbGVhc2U6ICgpID0+IHZvaWQgfT4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbm5lY3RlZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vdCBjb25uZWN0ZWQgdG8gSU1BUCBzZXJ2ZXInKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmVsZWFzZTogKCkgPT4ge1xyXG4gICAgICAgIC8vIE1vY2sgcmVsZWFzZSBmdW5jdGlvblxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgKmZldGNoKHF1ZXJ5OiBhbnksIG9wdGlvbnM6IGFueSwgbGltaXRzPzogYW55KTogQXN5bmNHZW5lcmF0b3I8YW55PiB7XHJcbiAgICAvLyBNb2NrIGZldGNoIHRoYXQgeWllbGRzIG5vIG1lc3NhZ2VzIHRvIHByZXZlbnQgZmlsZSBzeXN0ZW0gb3BlcmF0aW9uc1xyXG4gICAgLy8gSW4gYSByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIGZldGNoIGFjdHVhbCBlbWFpbHNcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGFzeW5jIGxvZ291dCgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpO1xyXG4gICAgdGhpcy5jb25uZWN0ZWQgPSBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmNsYXNzIEVtYWlsU2VydmljZSB7XHJcbiAgcHJpdmF0ZSBhc3luYyBkZWNyeXB0UGFzc3dvcmQoZW5jcnlwdGVkUGFzc3dvcmQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICAvLyBNb2NrIGRlY3J5cHRpb24gLSBpbiBwcm9kdWN0aW9uLCBpbXBsZW1lbnQgcHJvcGVyIGRlY3J5cHRpb25cclxuICAgIHJldHVybiBlbmNyeXB0ZWRQYXNzd29yZDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0UHJvdmlkZXJTZXR0aW5ncyhwcm92aWRlcjogc3RyaW5nKSB7XHJcbiAgICBzd2l0Y2ggKHByb3ZpZGVyKSB7XHJcbiAgICAgIGNhc2UgJ2dtYWlsJzpcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc210cDogeyBob3N0OiAnc210cC5nbWFpbC5jb20nLCBwb3J0OiA1ODcsIHNlY3VyZTogZmFsc2UgfSxcclxuICAgICAgICAgIGltYXA6IHsgaG9zdDogJ2ltYXAuZ21haWwuY29tJywgcG9ydDogOTkzLCBzZWN1cmU6IHRydWUgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIGNhc2UgJ291dGxvb2snOlxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBzbXRwOiB7IGhvc3Q6ICdzbXRwLW1haWwub3V0bG9vay5jb20nLCBwb3J0OiA1ODcsIHNlY3VyZTogZmFsc2UgfSxcclxuICAgICAgICAgIGltYXA6IHsgaG9zdDogJ291dGxvb2sub2ZmaWNlMzY1LmNvbScsIHBvcnQ6IDk5Mywgc2VjdXJlOiB0cnVlIH1cclxuICAgICAgICB9O1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVUcmFuc3BvcnRlcihlbWFpbEFjY291bnQ6IEVtYWlsQWNjb3VudCk6IFByb21pc2U8TW9ja1RyYW5zcG9ydGVyPiB7XHJcbiAgICAvLyBSZXR1cm4gbW9jayB0cmFuc3BvcnRlciB0byBwcmV2ZW50IGZpbGUgc3lzdGVtIG9wZXJhdGlvbnNcclxuICAgIHJldHVybiBuZXcgTW9ja1RyYW5zcG9ydGVyKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZUltYXBDbGllbnQoZW1haWxBY2NvdW50OiBFbWFpbEFjY291bnQpOiBQcm9taXNlPE1vY2tJbWFwQ2xpZW50PiB7XHJcbiAgICAvLyBSZXR1cm4gbW9jayBJTUFQIGNsaWVudCB0byBwcmV2ZW50IGZpbGUgc3lzdGVtIG9wZXJhdGlvbnNcclxuICAgIHJldHVybiBuZXcgTW9ja0ltYXBDbGllbnQoKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIHNlbmRFbWFpbChlbWFpbEFjY291bnQ6IEVtYWlsQWNjb3VudCwgb3B0aW9uczogU2VuZEVtYWlsT3B0aW9ucyk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB0cmFuc3BvcnRlciA9IGF3YWl0IHRoaXMuY3JlYXRlVHJhbnNwb3J0ZXIoZW1haWxBY2NvdW50KTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IG1haWxPcHRpb25zID0ge1xyXG4gICAgICAgIGZyb206IG9wdGlvbnMuZnJvbSB8fCBlbWFpbEFjY291bnQuZW1haWwsXHJcbiAgICAgICAgdG86IEFycmF5LmlzQXJyYXkob3B0aW9ucy50bykgPyBvcHRpb25zLnRvLmpvaW4oJywgJykgOiBvcHRpb25zLnRvLFxyXG4gICAgICAgIGNjOiBvcHRpb25zLmNjPy5qb2luKCcsICcpLFxyXG4gICAgICAgIGJjYzogb3B0aW9ucy5iY2M/LmpvaW4oJywgJyksXHJcbiAgICAgICAgc3ViamVjdDogb3B0aW9ucy5zdWJqZWN0LFxyXG4gICAgICAgIHRleHQ6IG9wdGlvbnMudGV4dCxcclxuICAgICAgICBodG1sOiBvcHRpb25zLmh0bWwsXHJcbiAgICAgICAgaW5SZXBseVRvOiBvcHRpb25zLmluUmVwbHlUbyxcclxuICAgICAgICByZWZlcmVuY2VzOiBvcHRpb25zLnJlZmVyZW5jZXM/LmpvaW4oJyAnKSxcclxuICAgICAgICBhdHRhY2htZW50czogb3B0aW9ucy5hdHRhY2htZW50c1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwobWFpbE9wdGlvbnMpO1xyXG4gICAgICByZXR1cm4gcmVzdWx0Lm1lc3NhZ2VJZDtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgZW1haWw6JywgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGZldGNoRW1haWxzKGVtYWlsQWNjb3VudDogRW1haWxBY2NvdW50LCBvcHRpb25zOiB7XHJcbiAgICBzaW5jZT86IERhdGU7XHJcbiAgICBsaW1pdD86IG51bWJlcjtcclxuICAgIGZvbGRlcj86IHN0cmluZztcclxuICB9ID0ge30pOiBQcm9taXNlPEVtYWlsTWVzc2FnZVtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBSZXR1cm4gZW1wdHkgYXJyYXkgZm9yIG1vY2sgaW1wbGVtZW50YXRpb25cclxuICAgICAgLy8gSW4gcHJvZHVjdGlvbiwgdGhpcyB3b3VsZCBmZXRjaCByZWFsIGVtYWlsc1xyXG4gICAgICBjb25zb2xlLmxvZyhgTW9jazogV291bGQgZmV0Y2ggZW1haWxzIGZyb20gJHtlbWFpbEFjY291bnQuZW1haWx9IHNpbmNlICR7b3B0aW9ucy5zaW5jZT8udG9JU09TdHJpbmcoKX1gKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgZW1haWxzOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGV4dHJhY3RUZXh0RnJvbUVtYWlsKHNvdXJjZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIC8vIFNpbXBsZSB0ZXh0IGV4dHJhY3Rpb24gLSBpbiBwcm9kdWN0aW9uLCB1c2UgYSBwcm9wZXIgZW1haWwgcGFyc2VyXHJcbiAgICBjb25zdCBsaW5lcyA9IHNvdXJjZS5zcGxpdCgnXFxuJyk7XHJcbiAgICBsZXQgaW5Cb2R5ID0gZmFsc2U7XHJcbiAgICBsZXQgdGV4dENvbnRlbnQgPSAnJztcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XHJcbiAgICAgIGlmIChsaW5lLnRyaW0oKSA9PT0gJycpIHtcclxuICAgICAgICBpbkJvZHkgPSB0cnVlO1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBpZiAoaW5Cb2R5ICYmICFsaW5lLnN0YXJ0c1dpdGgoJ0NvbnRlbnQtJykgJiYgIWxpbmUuc3RhcnRzV2l0aCgnLS0nKSkge1xyXG4gICAgICAgIHRleHRDb250ZW50ICs9IGxpbmUgKyAnXFxuJztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gdGV4dENvbnRlbnQudHJpbSgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBleHRyYWN0SHRtbEZyb21FbWFpbChzb3VyY2U6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAvLyBTaW1wbGUgSFRNTCBleHRyYWN0aW9uIC0gaW4gcHJvZHVjdGlvbiwgdXNlIGEgcHJvcGVyIGVtYWlsIHBhcnNlclxyXG4gICAgY29uc3QgaHRtbE1hdGNoID0gc291cmNlLm1hdGNoKC88aHRtbFtcXHNcXFNdKj88XFwvaHRtbD4vaSk7XHJcbiAgICByZXR1cm4gaHRtbE1hdGNoID8gaHRtbE1hdGNoWzBdIDogJyc7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGV4dHJhY3RUaHJlYWRJZChlbnZlbG9wZTogYW55KTogc3RyaW5nIHtcclxuICAgIC8vIFRyeSB0byBleHRyYWN0IHRocmVhZCBJRCBmcm9tIHZhcmlvdXMgaGVhZGVyc1xyXG4gICAgcmV0dXJuIGVudmVsb3BlLmluUmVwbHlUbyB8fCBlbnZlbG9wZS5tZXNzYWdlSWQgfHwgJyc7XHJcbiAgfVxyXG5cclxuICBhc3luYyB0ZXN0Q29ubmVjdGlvbihlbWFpbEFjY291bnQ6IEVtYWlsQWNjb3VudCk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgdHJhbnNwb3J0ZXIgPSBhd2FpdCB0aGlzLmNyZWF0ZVRyYW5zcG9ydGVyKGVtYWlsQWNjb3VudCk7XHJcbiAgICAgIGF3YWl0IHRyYW5zcG9ydGVyLnZlcmlmeSgpO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0VtYWlsIGNvbm5lY3Rpb24gdGVzdCBmYWlsZWQ6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBFbWFpbFNlcnZpY2U7Il0sIm5hbWVzIjpbIk1vY2tUcmFuc3BvcnRlciIsInNlbmRNYWlsIiwib3B0aW9ucyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIm1lc3NhZ2VJZCIsIkRhdGUiLCJub3ciLCJmcm9tIiwic3BsaXQiLCJ2ZXJpZnkiLCJNb2NrSW1hcENsaWVudCIsImNvbm5lY3QiLCJjb25uZWN0ZWQiLCJnZXRNYWlsYm94TG9jayIsImZvbGRlciIsIkVycm9yIiwicmVsZWFzZSIsImZldGNoIiwicXVlcnkiLCJsaW1pdHMiLCJsb2dvdXQiLCJFbWFpbFNlcnZpY2UiLCJkZWNyeXB0UGFzc3dvcmQiLCJlbmNyeXB0ZWRQYXNzd29yZCIsImdldFByb3ZpZGVyU2V0dGluZ3MiLCJwcm92aWRlciIsInNtdHAiLCJob3N0IiwicG9ydCIsInNlY3VyZSIsImltYXAiLCJjcmVhdGVUcmFuc3BvcnRlciIsImVtYWlsQWNjb3VudCIsImNyZWF0ZUltYXBDbGllbnQiLCJzZW5kRW1haWwiLCJ0cmFuc3BvcnRlciIsIm1haWxPcHRpb25zIiwiZW1haWwiLCJ0byIsIkFycmF5IiwiaXNBcnJheSIsImpvaW4iLCJjYyIsImJjYyIsInN1YmplY3QiLCJ0ZXh0IiwiaHRtbCIsImluUmVwbHlUbyIsInJlZmVyZW5jZXMiLCJhdHRhY2htZW50cyIsInJlc3VsdCIsImVycm9yIiwiY29uc29sZSIsImZldGNoRW1haWxzIiwibG9nIiwic2luY2UiLCJ0b0lTT1N0cmluZyIsImV4dHJhY3RUZXh0RnJvbUVtYWlsIiwic291cmNlIiwibGluZXMiLCJpbkJvZHkiLCJ0ZXh0Q29udGVudCIsImxpbmUiLCJ0cmltIiwic3RhcnRzV2l0aCIsImV4dHJhY3RIdG1sRnJvbUVtYWlsIiwiaHRtbE1hdGNoIiwibWF0Y2giLCJleHRyYWN0VGhyZWFkSWQiLCJlbnZlbG9wZSIsInRlc3RDb25uZWN0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/services/emailService.ts\n");

/***/ }),

/***/ "(api)/./lib/supabase.ts":
/*!*************************!*\
  !*** ./lib/supabase.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createClient: () => (/* binding */ getSupabaseClient),\n/* harmony export */   getSupabaseAdminClient: () => (/* binding */ getSupabaseAdminClient),\n/* harmony export */   getSupabaseClient: () => (/* binding */ getSupabaseClient),\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n\n// Client instances (lazy initialization)\nlet _supabase = null;\nlet _supabaseAdmin = null;\nfunction getSupabaseClient() {\n    if (!_supabase) {\n        const supabaseUrl = \"https://djqtqxnvgjjeeazwnyqn.supabase.co\";\n        const supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRqcXRxeG52Z2pqZWVhendueXFuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NjM4OTUsImV4cCI6MjA3NzEzOTg5NX0.zQZax1gQYZSUc30y5iGscT7J9wjVQQCZODuUrc6hPzw\";\n        if (!supabaseUrl || !supabaseAnonKey) {\n            console.warn(\"Supabase environment variables not found. Please configure Supabase integration.\");\n            // Return a mock client that won't cause errors\n            return {\n                from: ()=>({\n                        select: ()=>Promise.resolve({\n                                data: [],\n                                error: null\n                            }),\n                        insert: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        update: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        delete: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            })\n                    })\n            };\n        }\n        _supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n    }\n    return _supabase;\n}\nfunction getSupabaseAdminClient() {\n    if (!_supabaseAdmin) {\n        const supabaseUrl = \"https://djqtqxnvgjjeeazwnyqn.supabase.co\";\n        const supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n        if (!supabaseUrl || !supabaseServiceRoleKey) {\n            console.warn(\"Supabase admin environment variables not found. Please configure Supabase integration.\");\n            // Return a mock client that won't cause errors\n            return {\n                from: ()=>({\n                        select: ()=>Promise.resolve({\n                                data: [],\n                                error: null\n                            }),\n                        insert: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        update: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        delete: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            })\n                    })\n            };\n        }\n        _supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceRoleKey);\n    }\n    return _supabaseAdmin;\n}\n// Export lazy getters for backward compatibility\nconst supabase = new Proxy({}, {\n    get (target, prop) {\n        return getSupabaseClient()[prop];\n    }\n});\nconst supabaseAdmin = new Proxy({}, {\n    get (target, prop) {\n        return getSupabaseAdminClient()[prop];\n    }\n});\n// Export the client directly for compatibility with utils/supabase.ts\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvc3VwYWJhc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFxRDtBQUdyRCx5Q0FBeUM7QUFDekMsSUFBSUMsWUFBbUM7QUFDdkMsSUFBSUMsaUJBQXdDO0FBRXJDLFNBQVNDO0lBQ2QsSUFBSSxDQUFDRixXQUFXO1FBQ2QsTUFBTUcsY0FBY0MsMENBQW9DO1FBQ3hELE1BQU1HLGtCQUFrQkgsa05BQXlDO1FBRWpFLElBQUksQ0FBQ0QsZUFBZSxDQUFDSSxpQkFBaUI7WUFDcENFLFFBQVFDLElBQUksQ0FBQztZQUNiLCtDQUErQztZQUMvQyxPQUFPO2dCQUNMQyxNQUFNLElBQU87d0JBQ1hDLFFBQVEsSUFBTUMsUUFBUUMsT0FBTyxDQUFDO2dDQUFFQyxNQUFNLEVBQUU7Z0NBQUVDLE9BQU87NEJBQUs7d0JBQ3REQyxRQUFRLElBQU1KLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGQyxRQUFRLElBQU1OLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGRSxRQUFRLElBQU1QLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7b0JBQzVGO1lBQ0Y7UUFDRjtRQUVBbEIsWUFBWUQsbUVBQVlBLENBQUNJLGFBQWFJO0lBQ3hDO0lBRUEsT0FBT1A7QUFDVDtBQUVPLFNBQVNxQjtJQUNkLElBQUksQ0FBQ3BCLGdCQUFnQjtRQUNuQixNQUFNRSxjQUFjQywwQ0FBb0M7UUFDeEQsTUFBTWtCLHlCQUF5QmxCLFFBQVFDLEdBQUcsQ0FBQ2tCLHlCQUF5QjtRQUVwRSxJQUFJLENBQUNwQixlQUFlLENBQUNtQix3QkFBd0I7WUFDM0NiLFFBQVFDLElBQUksQ0FBQztZQUNiLCtDQUErQztZQUMvQyxPQUFPO2dCQUNMQyxNQUFNLElBQU87d0JBQ1hDLFFBQVEsSUFBTUMsUUFBUUMsT0FBTyxDQUFDO2dDQUFFQyxNQUFNLEVBQUU7Z0NBQUVDLE9BQU87NEJBQUs7d0JBQ3REQyxRQUFRLElBQU1KLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGQyxRQUFRLElBQU1OLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGRSxRQUFRLElBQU1QLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7b0JBQzVGO1lBQ0Y7UUFDRjtRQUVBakIsaUJBQWlCRixtRUFBWUEsQ0FBQ0ksYUFBYW1CO0lBQzdDO0lBRUEsT0FBT3JCO0FBQ1Q7QUFFQSxpREFBaUQ7QUFDMUMsTUFBTXVCLFdBQVcsSUFBSUMsTUFBTSxDQUFDLEdBQXFCO0lBQ3REQyxLQUFJQyxNQUFNLEVBQUVDLElBQUk7UUFDZCxPQUFPMUIsbUJBQW1CLENBQUMwQixLQUE2QjtJQUMxRDtBQUNGLEdBQUc7QUFFSSxNQUFNQyxnQkFBZ0IsSUFBSUosTUFBTSxDQUFDLEdBQXFCO0lBQzNEQyxLQUFJQyxNQUFNLEVBQUVDLElBQUk7UUFDZCxPQUFPUCx3QkFBd0IsQ0FBQ08sS0FBNkI7SUFDL0Q7QUFDRixHQUFHO0FBRUgsc0VBQXNFO0FBQ3pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbHluY2JvdC1uZXh0anMvLi9saWIvc3VwYWJhc2UudHM/Yzk5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xyXG5pbXBvcnQgdHlwZSB7IFN1cGFiYXNlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcclxuXHJcbi8vIENsaWVudCBpbnN0YW5jZXMgKGxhenkgaW5pdGlhbGl6YXRpb24pXHJcbmxldCBfc3VwYWJhc2U6IFN1cGFiYXNlQ2xpZW50IHwgbnVsbCA9IG51bGw7XHJcbmxldCBfc3VwYWJhc2VBZG1pbjogU3VwYWJhc2VDbGllbnQgfCBudWxsID0gbnVsbDtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTdXBhYmFzZUNsaWVudCgpOiBTdXBhYmFzZUNsaWVudCB7XHJcbiAgaWYgKCFfc3VwYWJhc2UpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xyXG4gICAgY29uc3Qgc3VwYWJhc2VBbm9uS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVk7XHJcblxyXG4gICAgaWYgKCFzdXBhYmFzZVVybCB8fCAhc3VwYWJhc2VBbm9uS2V5KSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignU3VwYWJhc2UgZW52aXJvbm1lbnQgdmFyaWFibGVzIG5vdCBmb3VuZC4gUGxlYXNlIGNvbmZpZ3VyZSBTdXBhYmFzZSBpbnRlZ3JhdGlvbi4nKTtcclxuICAgICAgLy8gUmV0dXJuIGEgbW9jayBjbGllbnQgdGhhdCB3b24ndCBjYXVzZSBlcnJvcnNcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBmcm9tOiAoKSA9PiAoe1xyXG4gICAgICAgICAgc2VsZWN0OiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBbXSwgZXJyb3I6IG51bGwgfSksXHJcbiAgICAgICAgICBpbnNlcnQ6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IG51bGwsIGVycm9yOiB7IG1lc3NhZ2U6ICdTdXBhYmFzZSBub3QgY29uZmlndXJlZCcgfSB9KSxcclxuICAgICAgICAgIHVwZGF0ZTogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogbnVsbCwgZXJyb3I6IHsgbWVzc2FnZTogJ1N1cGFiYXNlIG5vdCBjb25maWd1cmVkJyB9IH0pLFxyXG4gICAgICAgICAgZGVsZXRlOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBudWxsLCBlcnJvcjogeyBtZXNzYWdlOiAnU3VwYWJhc2Ugbm90IGNvbmZpZ3VyZWQnIH0gfSlcclxuICAgICAgICB9KVxyXG4gICAgICB9IGFzIGFueTtcclxuICAgIH1cclxuXHJcbiAgICBfc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSk7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBfc3VwYWJhc2U7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KCk6IFN1cGFiYXNlQ2xpZW50IHtcclxuICBpZiAoIV9zdXBhYmFzZUFkbWluKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcclxuICAgIGNvbnN0IHN1cGFiYXNlU2VydmljZVJvbGVLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZO1xyXG5cclxuICAgIGlmICghc3VwYWJhc2VVcmwgfHwgIXN1cGFiYXNlU2VydmljZVJvbGVLZXkpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdTdXBhYmFzZSBhZG1pbiBlbnZpcm9ubWVudCB2YXJpYWJsZXMgbm90IGZvdW5kLiBQbGVhc2UgY29uZmlndXJlIFN1cGFiYXNlIGludGVncmF0aW9uLicpO1xyXG4gICAgICAvLyBSZXR1cm4gYSBtb2NrIGNsaWVudCB0aGF0IHdvbid0IGNhdXNlIGVycm9yc1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGZyb206ICgpID0+ICh7XHJcbiAgICAgICAgICBzZWxlY3Q6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IFtdLCBlcnJvcjogbnVsbCB9KSxcclxuICAgICAgICAgIGluc2VydDogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogbnVsbCwgZXJyb3I6IHsgbWVzc2FnZTogJ1N1cGFiYXNlIG5vdCBjb25maWd1cmVkJyB9IH0pLFxyXG4gICAgICAgICAgdXBkYXRlOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBudWxsLCBlcnJvcjogeyBtZXNzYWdlOiAnU3VwYWJhc2Ugbm90IGNvbmZpZ3VyZWQnIH0gfSksXHJcbiAgICAgICAgICBkZWxldGU6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IG51bGwsIGVycm9yOiB7IG1lc3NhZ2U6ICdTdXBhYmFzZSBub3QgY29uZmlndXJlZCcgfSB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0gYXMgYW55O1xyXG4gICAgfVxyXG5cclxuICAgIF9zdXBhYmFzZUFkbWluID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZVNlcnZpY2VSb2xlS2V5KTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIF9zdXBhYmFzZUFkbWluO1xyXG59XHJcblxyXG4vLyBFeHBvcnQgbGF6eSBnZXR0ZXJzIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XHJcbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IG5ldyBQcm94eSh7fSBhcyBTdXBhYmFzZUNsaWVudCwge1xyXG4gIGdldCh0YXJnZXQsIHByb3ApIHtcclxuICAgIHJldHVybiBnZXRTdXBhYmFzZUNsaWVudCgpW3Byb3AgYXMga2V5b2YgU3VwYWJhc2VDbGllbnRdO1xyXG4gIH1cclxufSk7XHJcblxyXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VBZG1pbiA9IG5ldyBQcm94eSh7fSBhcyBTdXBhYmFzZUNsaWVudCwge1xyXG4gIGdldCh0YXJnZXQsIHByb3ApIHtcclxuICAgIHJldHVybiBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KClbcHJvcCBhcyBrZXlvZiBTdXBhYmFzZUNsaWVudF07XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIEV4cG9ydCB0aGUgY2xpZW50IGRpcmVjdGx5IGZvciBjb21wYXRpYmlsaXR5IHdpdGggdXRpbHMvc3VwYWJhc2UudHNcclxuZXhwb3J0IHsgZ2V0U3VwYWJhc2VDbGllbnQgYXMgY3JlYXRlQ2xpZW50IH07Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsIl9zdXBhYmFzZSIsIl9zdXBhYmFzZUFkbWluIiwiZ2V0U3VwYWJhc2VDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImNvbnNvbGUiLCJ3YXJuIiwiZnJvbSIsInNlbGVjdCIsIlByb21pc2UiLCJyZXNvbHZlIiwiZGF0YSIsImVycm9yIiwiaW5zZXJ0IiwibWVzc2FnZSIsInVwZGF0ZSIsImRlbGV0ZSIsImdldFN1cGFiYXNlQWRtaW5DbGllbnQiLCJzdXBhYmFzZVNlcnZpY2VSb2xlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInN1cGFiYXNlIiwiUHJveHkiLCJnZXQiLCJ0YXJnZXQiLCJwcm9wIiwic3VwYWJhc2VBZG1pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/supabase.ts\n");

/***/ }),

/***/ "(api)/./pages/api/messages/index.ts":
/*!*************************************!*\
  !*** ./pages/api/messages/index.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _lib_middleware_withAuth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/middleware/withAuth */ \"(api)/./lib/middleware/withAuth.ts\");\n/* harmony import */ var _lib_database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/database */ \"(api)/./lib/database.ts\");\n/* harmony import */ var _lib_services_emailService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/services/emailService */ \"(api)/./lib/services/emailService.ts\");\n\n\n\nasync function handler(req, res) {\n    switch(req.method){\n        case \"GET\":\n            return handleGetMessages(req, res);\n        case \"POST\":\n            return handleSendMessage(req, res);\n        default:\n            res.setHeader(\"Allow\", [\n                \"GET\",\n                \"POST\"\n            ]);\n            return res.status(405).json({\n                success: false,\n                error: `Method ${req.method} not allowed`\n            });\n    }\n}\nasync function handleGetMessages(req, res) {\n    try {\n        const userId = req.user.id;\n        const { conversationId, page = 1, limit = 50, platform = \"all\" } = req.query;\n        const queryOptions = {\n            conversationId: conversationId,\n            page: Number(page),\n            limit: Number(limit)\n        };\n        // Filter by platform if specified\n        if (platform !== \"all\") {\n            queryOptions.platform = platform;\n        }\n        const messages = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.messageOperations.findByUserId(userId, queryOptions);\n        // If no conversationId, group messages by conversation\n        if (!conversationId) {\n            const conversations = new Map();\n            messages.forEach((message)=>{\n                const convId = message.conversationId;\n                if (!conversations.has(convId)) {\n                    conversations.set(convId, {\n                        conversationId: convId,\n                        prospect: message.prospects,\n                        platform: message.platform,\n                        lastMessage: message,\n                        unreadCount: 0,\n                        totalMessages: 0\n                    });\n                }\n                const conv = conversations.get(convId);\n                conv.totalMessages++;\n                // Update last message if this one is newer\n                if (new Date(message.created_at) > new Date(conv.lastMessage.created_at)) {\n                    conv.lastMessage = message;\n                }\n                // Count unread messages (received messages that haven't been read)\n                if (message.type === \"received\" && message.status !== \"read\") {\n                    conv.unreadCount++;\n                }\n            });\n            const conversationList = Array.from(conversations.values());\n            return res.json({\n                success: true,\n                conversations: conversationList\n            });\n        }\n        res.json({\n            success: true,\n            messages,\n            pagination: {\n                page: Number(page),\n                limit: Number(limit),\n                total: messages.length,\n                pages: Math.ceil(messages.length / Number(limit))\n            }\n        });\n    } catch (error) {\n        console.error(\"Error fetching messages:\", error);\n        res.status(500).json({\n            success: false,\n            error: \"Failed to fetch messages\"\n        });\n    }\n}\nasync function handleSendMessage(req, res) {\n    try {\n        const userId = req.user.id;\n        const { prospect_id, content, message_type = \"manual\", conversation_id, platform = \"linkedin\", subject, to, from, cc, bcc } = req.body;\n        // Validation\n        if (!prospect_id || !content) {\n            return res.status(400).json({\n                success: false,\n                error: \"Prospect ID and message content are required\"\n            });\n        }\n        // Additional validation for email\n        if (platform === \"email\") {\n            if (!subject) {\n                return res.status(400).json({\n                    success: false,\n                    error: \"Subject is required for email messages\"\n                });\n            }\n            if (!to) {\n                return res.status(400).json({\n                    success: false,\n                    error: \"Recipient email is required\"\n                });\n            }\n        }\n        // Verify prospect belongs to user\n        const prospect = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.prospectOperations.findById(prospect_id, userId);\n        if (!prospect) {\n            return res.status(404).json({\n                success: false,\n                error: \"Prospect not found\"\n            });\n        }\n        // Generate conversation ID if not provided\n        const finalConversationId = conversation_id || `${userId}_${prospect_id}`;\n        let emailMessageId;\n        // Handle email sending\n        if (platform === \"email\") {\n            try {\n                // Get user's email account\n                const user = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.userOperations.findById(userId);\n                if (!user || !user.email_accounts || user.email_accounts.length === 0) {\n                    return res.status(400).json({\n                        success: false,\n                        error: \"No email account configured. Please add your email credentials in Settings.\"\n                    });\n                }\n                const emailAccount = user.email_accounts.find((acc)=>acc.isActive) || user.email_accounts[0];\n                const emailService = new _lib_services_emailService__WEBPACK_IMPORTED_MODULE_2__[\"default\"]();\n                emailMessageId = await emailService.sendEmail(emailAccount, {\n                    to: to,\n                    from: from || emailAccount.email,\n                    subject: subject,\n                    text: content,\n                    html: content.replace(/\\n/g, \"<br>\"),\n                    cc: cc,\n                    bcc: bcc\n                });\n            } catch (emailError) {\n                console.error(\"Error sending email:\", emailError);\n                return res.status(500).json({\n                    success: false,\n                    error: \"Failed to send email. Please check your email configuration.\"\n                });\n            }\n        }\n        // Create new message\n        const message = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.messageOperations.create({\n            user_id: userId,\n            prospect_id: prospect_id,\n            conversation_id: finalConversationId,\n            type: \"sent\",\n            message_type: message_type,\n            content: content.trim(),\n            subject: platform === \"email\" ? subject : undefined,\n            platform: platform,\n            email_data: platform === \"email\" ? {\n                to: to,\n                from: from || (await _lib_database__WEBPACK_IMPORTED_MODULE_1__.userOperations.findById(userId))?.email_accounts?.[0]?.email || \"\",\n                cc: cc,\n                bcc: bcc,\n                messageId: emailMessageId,\n                threadId: finalConversationId\n            } : undefined,\n            status: \"sent\",\n            sent_at: new Date().toISOString(),\n            automated: message_type !== \"manual\",\n            ai_generated: false,\n            retry_count: 0,\n            metadata: {\n                characterCount: content.length,\n                wordCount: content.split(/\\s+/).length,\n                platform: platform\n            },\n            attachments: [],\n            analytics: {\n                opened: false,\n                openedAt: undefined,\n                clickedLinks: [],\n                responseReceived: false,\n                responseTime: undefined,\n                sentiment: \"neutral\",\n                leadQuality: \"cold\"\n            },\n            tags: [],\n            is_archived: false,\n            is_starred: false,\n            is_important: false\n        });\n        // Update prospect status if this is their first message\n        if (prospect.status === \"connected\" || prospect.status === \"new\") {\n            await _lib_database__WEBPACK_IMPORTED_MODULE_1__.prospectOperations.update(prospect_id, userId, {\n                status: platform === \"email\" ? \"message_sent\" : \"message_sent\",\n                last_updated: new Date().toISOString()\n            });\n        }\n        // Add interaction to prospect\n        const updatedInteractions = [\n            ...prospect.interactions,\n            {\n                type: platform === \"email\" ? \"email\" : \"message\",\n                content: content,\n                subject: platform === \"email\" ? subject : undefined,\n                platform: platform,\n                timestamp: new Date().toISOString(),\n                automated: message_type !== \"manual\"\n            }\n        ];\n        await _lib_database__WEBPACK_IMPORTED_MODULE_1__.prospectOperations.update(prospect_id, userId, {\n            interactions: updatedInteractions\n        });\n        console.log(`${platform === \"email\" ? \"Email\" : \"Message\"} sent to prospect: ${prospect.linkedin_data.name}`);\n        res.status(201).json({\n            success: true,\n            message: `${platform === \"email\" ? \"Email\" : \"Message\"} sent successfully`,\n            data: message\n        });\n    } catch (error) {\n        console.error(\"Error sending message/email:\", error);\n        res.status(500).json({\n            success: false,\n            error: \"Failed to send message/email\"\n        });\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_middleware_withAuth__WEBPACK_IMPORTED_MODULE_0__.withAuth)(handler));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTdEMsYUFBYSxVQUFVc0MsVUFBVXVCO2dCQUMxQzdELFVBQVVBO2dCQUNWMkYsV0FBVyxJQUFJdkUsT0FBTzhDLFdBQVc7Z0JBQ2pDQyxXQUFXL0IsaUJBQWlCO1lBQzlCO1NBQ0Q7UUFFRCxNQUFNeEQsNkRBQWtCQSxDQUFDMkcsTUFBTSxDQUFDckQsYUFBYXhDLFFBQVE7WUFDbkRnRyxjQUFjRDtRQUNoQjtRQUVBeEQsUUFBUTJELEdBQUcsQ0FBQyxDQUFDLEVBQUU1RixhQUFhLFVBQVUsVUFBVSxVQUFVLG1CQUFtQixFQUFFYSxTQUFTZ0YsYUFBYSxDQUFDQyxJQUFJLENBQUMsQ0FBQztRQUU1RzdHLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDbkJDLFNBQVM7WUFDVGlCLFNBQVMsQ0FBQyxFQUFFVCxhQUFhLFVBQVUsVUFBVSxVQUFVLGtCQUFrQixDQUFDO1lBQzFFK0YsTUFBTXRGO1FBQ1I7SUFFRixFQUFFLE9BQU9oQixPQUFPO1FBQ2R3QyxRQUFReEMsS0FBSyxDQUFDLGdDQUFnQ0E7UUFDOUNSLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDbkJDLFNBQVM7WUFDVEMsT0FBTztRQUNUO0lBQ0Y7QUFDRjtBQUVBLGlFQUFlZixrRUFBUUEsQ0FBQ0ssUUFBUUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2x5bmNib3QtbmV4dGpzLy4vcGFnZXMvYXBpL21lc3NhZ2VzL2luZGV4LnRzPzNmMmEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XHJcbmltcG9ydCB7IHdpdGhBdXRoLCBBdXRoZW50aWNhdGVkUmVxdWVzdCB9IGZyb20gJy4uLy4uLy4uL2xpYi9taWRkbGV3YXJlL3dpdGhBdXRoJztcclxuaW1wb3J0IHsgbWVzc2FnZU9wZXJhdGlvbnMsIHByb3NwZWN0T3BlcmF0aW9ucywgdXNlck9wZXJhdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9saWIvZGF0YWJhc2UnO1xyXG5pbXBvcnQgRW1haWxTZXJ2aWNlLCB7IHR5cGUgRW1haWxBY2NvdW50IH0gZnJvbSAnLi4vLi4vLi4vbGliL3NlcnZpY2VzL2VtYWlsU2VydmljZSc7XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XHJcblxyXG4gIHN3aXRjaCAocmVxLm1ldGhvZCkge1xyXG4gICAgY2FzZSAnR0VUJzpcclxuICAgICAgcmV0dXJuIGhhbmRsZUdldE1lc3NhZ2VzKHJlcSwgcmVzKTtcclxuICAgIGNhc2UgJ1BPU1QnOlxyXG4gICAgICByZXR1cm4gaGFuZGxlU2VuZE1lc3NhZ2UocmVxLCByZXMpO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCBbJ0dFVCcsICdQT1NUJ10pO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBgTWV0aG9kICR7cmVxLm1ldGhvZH0gbm90IGFsbG93ZWRgXHJcbiAgICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0TWVzc2FnZXMocmVxOiBBdXRoZW50aWNhdGVkUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdXNlcklkID0gcmVxLnVzZXIuaWQ7XHJcbiAgICBjb25zdCB7IGNvbnZlcnNhdGlvbklkLCBwYWdlID0gMSwgbGltaXQgPSA1MCwgcGxhdGZvcm0gPSAnYWxsJyB9ID0gcmVxLnF1ZXJ5O1xyXG4gICAgXHJcbiAgICBjb25zdCBxdWVyeU9wdGlvbnM6IGFueSA9IHtcclxuICAgICAgY29udmVyc2F0aW9uSWQ6IGNvbnZlcnNhdGlvbklkIGFzIHN0cmluZyxcclxuICAgICAgcGFnZTogTnVtYmVyKHBhZ2UpLFxyXG4gICAgICBsaW1pdDogTnVtYmVyKGxpbWl0KVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBGaWx0ZXIgYnkgcGxhdGZvcm0gaWYgc3BlY2lmaWVkXHJcbiAgICBpZiAocGxhdGZvcm0gIT09ICdhbGwnKSB7XHJcbiAgICAgIHF1ZXJ5T3B0aW9ucy5wbGF0Zm9ybSA9IHBsYXRmb3JtIGFzIHN0cmluZztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IG1lc3NhZ2VPcGVyYXRpb25zLmZpbmRCeVVzZXJJZCh1c2VySWQsIHF1ZXJ5T3B0aW9ucyk7XHJcblxyXG4gICAgLy8gSWYgbm8gY29udmVyc2F0aW9uSWQsIGdyb3VwIG1lc3NhZ2VzIGJ5IGNvbnZlcnNhdGlvblxyXG4gICAgaWYgKCFjb252ZXJzYXRpb25JZCkge1xyXG4gICAgICBjb25zdCBjb252ZXJzYXRpb25zID0gbmV3IE1hcCgpO1xyXG4gICAgICBcclxuICAgICAgbWVzc2FnZXMuZm9yRWFjaCgobWVzc2FnZTogYW55KSA9PiB7XHJcbiAgICAgICAgY29uc3QgY29udklkID0gbWVzc2FnZS5jb252ZXJzYXRpb25JZDtcclxuICAgICAgICBpZiAoIWNvbnZlcnNhdGlvbnMuaGFzKGNvbnZJZCkpIHtcclxuICAgICAgICAgIGNvbnZlcnNhdGlvbnMuc2V0KGNvbnZJZCwge1xyXG4gICAgICAgICAgICBjb252ZXJzYXRpb25JZDogY29udklkLFxyXG4gICAgICAgICAgICBwcm9zcGVjdDogbWVzc2FnZS5wcm9zcGVjdHMsXHJcbiAgICAgICAgICAgIHBsYXRmb3JtOiBtZXNzYWdlLnBsYXRmb3JtLFxyXG4gICAgICAgICAgICBsYXN0TWVzc2FnZTogbWVzc2FnZSxcclxuICAgICAgICAgICAgdW5yZWFkQ291bnQ6IDAsXHJcbiAgICAgICAgICAgIHRvdGFsTWVzc2FnZXM6IDBcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBjb252ID0gY29udmVyc2F0aW9ucy5nZXQoY29udklkKTtcclxuICAgICAgICBjb252LnRvdGFsTWVzc2FnZXMrKztcclxuICAgICAgICBcclxuICAgICAgICAvLyBVcGRhdGUgbGFzdCBtZXNzYWdlIGlmIHRoaXMgb25lIGlzIG5ld2VyXHJcbiAgICAgICAgaWYgKG5ldyBEYXRlKG1lc3NhZ2UuY3JlYXRlZF9hdCkgPiBuZXcgRGF0ZShjb252Lmxhc3RNZXNzYWdlLmNyZWF0ZWRfYXQpKSB7XHJcbiAgICAgICAgICBjb252Lmxhc3RNZXNzYWdlID0gbWVzc2FnZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ291bnQgdW5yZWFkIG1lc3NhZ2VzIChyZWNlaXZlZCBtZXNzYWdlcyB0aGF0IGhhdmVuJ3QgYmVlbiByZWFkKVxyXG4gICAgICAgIGlmIChtZXNzYWdlLnR5cGUgPT09ICdyZWNlaXZlZCcgJiYgbWVzc2FnZS5zdGF0dXMgIT09ICdyZWFkJykge1xyXG4gICAgICAgICAgY29udi51bnJlYWRDb3VudCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBjb252ZXJzYXRpb25MaXN0ID0gQXJyYXkuZnJvbShjb252ZXJzYXRpb25zLnZhbHVlcygpKTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiByZXMuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBjb252ZXJzYXRpb25zOiBjb252ZXJzYXRpb25MaXN0XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbWVzc2FnZXMsXHJcbiAgICAgIHBhZ2luYXRpb246IHtcclxuICAgICAgICBwYWdlOiBOdW1iZXIocGFnZSksXHJcbiAgICAgICAgbGltaXQ6IE51bWJlcihsaW1pdCksXHJcbiAgICAgICAgdG90YWw6IG1lc3NhZ2VzLmxlbmd0aCxcclxuICAgICAgICBwYWdlczogTWF0aC5jZWlsKG1lc3NhZ2VzLmxlbmd0aCAvIE51bWJlcihsaW1pdCkpXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgbWVzc2FnZXM6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIG1lc3NhZ2VzJyBcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlU2VuZE1lc3NhZ2UocmVxOiBBdXRoZW50aWNhdGVkUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdXNlcklkID0gcmVxLnVzZXIuaWQ7XHJcbiAgICBjb25zdCB7IFxyXG4gICAgICBwcm9zcGVjdF9pZCwgXHJcbiAgICAgIGNvbnRlbnQsIFxyXG4gICAgICBtZXNzYWdlX3R5cGUgPSAnbWFudWFsJywgXHJcbiAgICAgIGNvbnZlcnNhdGlvbl9pZCwgXHJcbiAgICAgIHBsYXRmb3JtID0gJ2xpbmtlZGluJyxcclxuICAgICAgc3ViamVjdCxcclxuICAgICAgdG8sXHJcbiAgICAgIGZyb20sXHJcbiAgICAgIGNjLFxyXG4gICAgICBiY2NcclxuICAgIH0gPSByZXEuYm9keTtcclxuXHJcbiAgICAvLyBWYWxpZGF0aW9uXHJcbiAgICBpZiAoIXByb3NwZWN0X2lkIHx8ICFjb250ZW50KSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnUHJvc3BlY3QgSUQgYW5kIG1lc3NhZ2UgY29udGVudCBhcmUgcmVxdWlyZWQnIFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBZGRpdGlvbmFsIHZhbGlkYXRpb24gZm9yIGVtYWlsXHJcbiAgICBpZiAocGxhdGZvcm0gPT09ICdlbWFpbCcpIHtcclxuICAgICAgaWYgKCFzdWJqZWN0KSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIGVycm9yOiAnU3ViamVjdCBpcyByZXF1aXJlZCBmb3IgZW1haWwgbWVzc2FnZXMnIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghdG8pIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdSZWNpcGllbnQgZW1haWwgaXMgcmVxdWlyZWQnIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBWZXJpZnkgcHJvc3BlY3QgYmVsb25ncyB0byB1c2VyXHJcbiAgICBjb25zdCBwcm9zcGVjdCA9IGF3YWl0IHByb3NwZWN0T3BlcmF0aW9ucy5maW5kQnlJZChwcm9zcGVjdF9pZCwgdXNlcklkKTtcclxuICAgIGlmICghcHJvc3BlY3QpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdQcm9zcGVjdCBub3QgZm91bmQnIFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBjb252ZXJzYXRpb24gSUQgaWYgbm90IHByb3ZpZGVkXHJcbiAgICBjb25zdCBmaW5hbENvbnZlcnNhdGlvbklkID0gY29udmVyc2F0aW9uX2lkIHx8IGAke3VzZXJJZH1fJHtwcm9zcGVjdF9pZH1gO1xyXG5cclxuICAgIGxldCBlbWFpbE1lc3NhZ2VJZDogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG4gICAgXHJcbiAgICAvLyBIYW5kbGUgZW1haWwgc2VuZGluZ1xyXG4gICAgaWYgKHBsYXRmb3JtID09PSAnZW1haWwnKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgLy8gR2V0IHVzZXIncyBlbWFpbCBhY2NvdW50XHJcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHVzZXJPcGVyYXRpb25zLmZpbmRCeUlkKHVzZXJJZCk7XHJcbiAgICAgICAgaWYgKCF1c2VyIHx8ICF1c2VyLmVtYWlsX2FjY291bnRzIHx8IHVzZXIuZW1haWxfYWNjb3VudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgZXJyb3I6ICdObyBlbWFpbCBhY2NvdW50IGNvbmZpZ3VyZWQuIFBsZWFzZSBhZGQgeW91ciBlbWFpbCBjcmVkZW50aWFscyBpbiBTZXR0aW5ncy4nXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGVtYWlsQWNjb3VudCA9IHVzZXIuZW1haWxfYWNjb3VudHMuZmluZChhY2MgPT4gYWNjLmlzQWN0aXZlKSB8fCB1c2VyLmVtYWlsX2FjY291bnRzWzBdO1xyXG4gICAgICAgIGNvbnN0IGVtYWlsU2VydmljZSA9IG5ldyBFbWFpbFNlcnZpY2UoKTtcclxuXHJcbiAgICAgICAgZW1haWxNZXNzYWdlSWQgPSBhd2FpdCBlbWFpbFNlcnZpY2Uuc2VuZEVtYWlsKGVtYWlsQWNjb3VudCwge1xyXG4gICAgICAgICAgdG86IHRvLFxyXG4gICAgICAgICAgZnJvbTogZnJvbSB8fCBlbWFpbEFjY291bnQuZW1haWwsXHJcbiAgICAgICAgICBzdWJqZWN0OiBzdWJqZWN0LFxyXG4gICAgICAgICAgdGV4dDogY29udGVudCxcclxuICAgICAgICAgIGh0bWw6IGNvbnRlbnQucmVwbGFjZSgvXFxuL2csICc8YnI+JyksXHJcbiAgICAgICAgICBjYzogY2MsXHJcbiAgICAgICAgICBiY2M6IGJjY1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGNhdGNoIChlbWFpbEVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VuZGluZyBlbWFpbDonLCBlbWFpbEVycm9yKTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byBzZW5kIGVtYWlsLiBQbGVhc2UgY2hlY2sgeW91ciBlbWFpbCBjb25maWd1cmF0aW9uLidcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gQ3JlYXRlIG5ldyBtZXNzYWdlXHJcbiAgICBjb25zdCBtZXNzYWdlID0gYXdhaXQgbWVzc2FnZU9wZXJhdGlvbnMuY3JlYXRlKHtcclxuICAgICAgdXNlcl9pZDogdXNlcklkLFxyXG4gICAgICBwcm9zcGVjdF9pZDogcHJvc3BlY3RfaWQsXHJcbiAgICAgIGNvbnZlcnNhdGlvbl9pZDogZmluYWxDb252ZXJzYXRpb25JZCxcclxuICAgICAgdHlwZTogJ3NlbnQnLFxyXG4gICAgICBtZXNzYWdlX3R5cGU6IG1lc3NhZ2VfdHlwZSxcclxuICAgICAgY29udGVudDogY29udGVudC50cmltKCksXHJcbiAgICAgIHN1YmplY3Q6IHBsYXRmb3JtID09PSAnZW1haWwnID8gc3ViamVjdCA6IHVuZGVmaW5lZCxcclxuICAgICAgcGxhdGZvcm06IHBsYXRmb3JtLFxyXG4gICAgICBlbWFpbF9kYXRhOiBwbGF0Zm9ybSA9PT0gJ2VtYWlsJyA/IHtcclxuICAgICAgICB0bzogdG8sXHJcbiAgICAgICAgZnJvbTogZnJvbSB8fCAoYXdhaXQgdXNlck9wZXJhdGlvbnMuZmluZEJ5SWQodXNlcklkKSk/LmVtYWlsX2FjY291bnRzPy5bMF0/LmVtYWlsIHx8ICcnLFxyXG4gICAgICAgIGNjOiBjYyxcclxuICAgICAgICBiY2M6IGJjYyxcclxuICAgICAgICBtZXNzYWdlSWQ6IGVtYWlsTWVzc2FnZUlkLFxyXG4gICAgICAgIHRocmVhZElkOiBmaW5hbENvbnZlcnNhdGlvbklkXHJcbiAgICAgIH0gOiB1bmRlZmluZWQsXHJcbiAgICAgIHN0YXR1czogJ3NlbnQnLFxyXG4gICAgICBzZW50X2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIGF1dG9tYXRlZDogbWVzc2FnZV90eXBlICE9PSAnbWFudWFsJyxcclxuICAgICAgYWlfZ2VuZXJhdGVkOiBmYWxzZSxcclxuICAgICAgcmV0cnlfY291bnQ6IDAsXHJcbiAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgY2hhcmFjdGVyQ291bnQ6IGNvbnRlbnQubGVuZ3RoLFxyXG4gICAgICAgIHdvcmRDb3VudDogY29udGVudC5zcGxpdCgvXFxzKy8pLmxlbmd0aCxcclxuICAgICAgICBwbGF0Zm9ybTogcGxhdGZvcm1cclxuICAgICAgfSxcclxuICAgICAgYXR0YWNobWVudHM6IFtdLFxyXG4gICAgICBhbmFseXRpY3M6IHtcclxuICAgICAgICBvcGVuZWQ6IGZhbHNlLFxyXG4gICAgICAgIG9wZW5lZEF0OiB1bmRlZmluZWQsXHJcbiAgICAgICAgY2xpY2tlZExpbmtzOiBbXSxcclxuICAgICAgICByZXNwb25zZVJlY2VpdmVkOiBmYWxzZSxcclxuICAgICAgICByZXNwb25zZVRpbWU6IHVuZGVmaW5lZCxcclxuICAgICAgICBzZW50aW1lbnQ6ICduZXV0cmFsJyxcclxuICAgICAgICBsZWFkUXVhbGl0eTogJ2NvbGQnXHJcbiAgICAgIH0sXHJcbiAgICAgIHRhZ3M6IFtdLFxyXG4gICAgICBpc19hcmNoaXZlZDogZmFsc2UsXHJcbiAgICAgIGlzX3N0YXJyZWQ6IGZhbHNlLFxyXG4gICAgICBpc19pbXBvcnRhbnQ6IGZhbHNlXHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgLy8gVXBkYXRlIHByb3NwZWN0IHN0YXR1cyBpZiB0aGlzIGlzIHRoZWlyIGZpcnN0IG1lc3NhZ2VcclxuICAgIGlmIChwcm9zcGVjdC5zdGF0dXMgPT09ICdjb25uZWN0ZWQnIHx8IHByb3NwZWN0LnN0YXR1cyA9PT0gJ25ldycpIHtcclxuICAgICAgYXdhaXQgcHJvc3BlY3RPcGVyYXRpb25zLnVwZGF0ZShwcm9zcGVjdF9pZCwgdXNlcklkLCB7XHJcbiAgICAgICAgc3RhdHVzOiBwbGF0Zm9ybSA9PT0gJ2VtYWlsJyA/ICdtZXNzYWdlX3NlbnQnIDogJ21lc3NhZ2Vfc2VudCcsXHJcbiAgICAgICAgbGFzdF91cGRhdGVkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIGludGVyYWN0aW9uIHRvIHByb3NwZWN0XHJcbiAgICBjb25zdCB1cGRhdGVkSW50ZXJhY3Rpb25zID0gW1xyXG4gICAgICAuLi5wcm9zcGVjdC5pbnRlcmFjdGlvbnMsXHJcbiAgICAgIHtcclxuICAgICAgICB0eXBlOiBwbGF0Zm9ybSA9PT0gJ2VtYWlsJyA/ICdlbWFpbCcgOiAnbWVzc2FnZScsXHJcbiAgICAgICAgY29udGVudDogY29udGVudCxcclxuICAgICAgICBzdWJqZWN0OiBwbGF0Zm9ybSA9PT0gJ2VtYWlsJyA/IHN1YmplY3QgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgcGxhdGZvcm06IHBsYXRmb3JtLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGF1dG9tYXRlZDogbWVzc2FnZV90eXBlICE9PSAnbWFudWFsJ1xyXG4gICAgICB9XHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICBhd2FpdCBwcm9zcGVjdE9wZXJhdGlvbnMudXBkYXRlKHByb3NwZWN0X2lkLCB1c2VySWQsIHtcclxuICAgICAgaW50ZXJhY3Rpb25zOiB1cGRhdGVkSW50ZXJhY3Rpb25zXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhgJHtwbGF0Zm9ybSA9PT0gJ2VtYWlsJyA/ICdFbWFpbCcgOiAnTWVzc2FnZSd9IHNlbnQgdG8gcHJvc3BlY3Q6ICR7cHJvc3BlY3QubGlua2VkaW5fZGF0YS5uYW1lfWApO1xyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbWVzc2FnZTogYCR7cGxhdGZvcm0gPT09ICdlbWFpbCcgPyAnRW1haWwnIDogJ01lc3NhZ2UnfSBzZW50IHN1Y2Nlc3NmdWxseWAsXHJcbiAgICAgIGRhdGE6IG1lc3NhZ2VcclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VuZGluZyBtZXNzYWdlL2VtYWlsOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ0ZhaWxlZCB0byBzZW5kIG1lc3NhZ2UvZW1haWwnIFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCB3aXRoQXV0aChoYW5kbGVyKTsiXSwibmFtZXMiOlsid2l0aEF1dGgiLCJtZXNzYWdlT3BlcmF0aW9ucyIsInByb3NwZWN0T3BlcmF0aW9ucyIsInVzZXJPcGVyYXRpb25zIiwiRW1haWxTZXJ2aWNlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsImhhbmRsZUdldE1lc3NhZ2VzIiwiaGFuZGxlU2VuZE1lc3NhZ2UiLCJzZXRIZWFkZXIiLCJzdGF0dXMiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwidXNlcklkIiwidXNlciIsImlkIiwiY29udmVyc2F0aW9uSWQiLCJwYWdlIiwibGltaXQiLCJwbGF0Zm9ybSIsInF1ZXJ5IiwicXVlcnlPcHRpb25zIiwiTnVtYmVyIiwibWVzc2FnZXMiLCJmaW5kQnlVc2VySWQiLCJjb252ZXJzYXRpb25zIiwiTWFwIiwiZm9yRWFjaCIsIm1lc3NhZ2UiLCJjb252SWQiLCJoYXMiLCJzZXQiLCJwcm9zcGVjdCIsInByb3NwZWN0cyIsImxhc3RNZXNzYWdlIiwidW5yZWFkQ291bnQiLCJ0b3RhbE1lc3NhZ2VzIiwiY29udiIsImdldCIsIkRhdGUiLCJjcmVhdGVkX2F0IiwidHlwZSIsImNvbnZlcnNhdGlvbkxpc3QiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJwYWdpbmF0aW9uIiwidG90YWwiLCJsZW5ndGgiLCJwYWdlcyIsIk1hdGgiLCJjZWlsIiwiY29uc29sZSIsInByb3NwZWN0X2lkIiwiY29udGVudCIsIm1lc3NhZ2VfdHlwZSIsImNvbnZlcnNhdGlvbl9pZCIsInN1YmplY3QiLCJ0byIsImNjIiwiYmNjIiwiYm9keSIsImZpbmRCeUlkIiwiZmluYWxDb252ZXJzYXRpb25JZCIsImVtYWlsTWVzc2FnZUlkIiwiZW1haWxfYWNjb3VudHMiLCJlbWFpbEFjY291bnQiLCJmaW5kIiwiYWNjIiwiaXNBY3RpdmUiLCJlbWFpbFNlcnZpY2UiLCJzZW5kRW1haWwiLCJlbWFpbCIsInRleHQiLCJodG1sIiwicmVwbGFjZSIsImVtYWlsRXJyb3IiLCJjcmVhdGUiLCJ1c2VyX2lkIiwidHJpbSIsInVuZGVmaW5lZCIsImVtYWlsX2RhdGEiLCJtZXNzYWdlSWQiLCJ0aHJlYWRJZCIsInNlbnRfYXQiLCJ0b0lTT1N0cmluZyIsImF1dG9tYXRlZCIsImFpX2dlbmVyYXRlZCIsInJldHJ5X2NvdW50IiwibWV0YWRhdGEiLCJjaGFyYWN0ZXJDb3VudCIsIndvcmRDb3VudCIsInNwbGl0IiwiYXR0YWNobWVudHMiLCJhbmFseXRpY3MiLCJvcGVuZWQiLCJvcGVuZWRBdCIsImNsaWNrZWRMaW5rcyIsInJlc3BvbnNlUmVjZWl2ZWQiLCJyZXNwb25zZVRpbWUiLCJzZW50aW1lbnQiLCJsZWFkUXVhbGl0eSIsInRhZ3MiLCJpc19hcmNoaXZlZCIsImlzX3N0YXJyZWQiLCJpc19pbXBvcnRhbnQiLCJ1cGRhdGUiLCJsYXN0X3VwZGF0ZWQiLCJ1cGRhdGVkSW50ZXJhY3Rpb25zIiwiaW50ZXJhY3Rpb25zIiwidGltZXN0YW1wIiwibG9nIiwibGlua2VkaW5fZGF0YSIsIm5hbWUiLCJkYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/messages/index.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmessages&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cmessages%5Cindex.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();