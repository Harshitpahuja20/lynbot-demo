"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/messages";
exports.ids = ["pages/api/messages"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "bcryptjs":
/*!***************************!*\
  !*** external "bcryptjs" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("bcryptjs");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "nodemailer":
/*!*****************************!*\
  !*** external "nodemailer" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("nodemailer");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmessages&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cmessages%5Cindex.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmessages&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cmessages%5Cindex.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_messages_index_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\messages\\index.ts */ \"(api)/./pages/api/messages/index.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_messages_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_messages_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/messages\",\n        pathname: \"/api/messages\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_messages_index_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRm1lc3NhZ2VzJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNtZXNzYWdlcyU1Q2luZGV4LnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzZEO0FBQzdEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx5REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMseURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbHluY2JvdC1uZXh0anMvPzkwMTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxtZXNzYWdlc1xcXFxpbmRleC50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL21lc3NhZ2VzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvbWVzc2FnZXNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmessages&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cmessages%5Cindex.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/database.ts":
/*!*************************!*\
  !*** ./lib/database.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   campaignOperations: () => (/* binding */ campaignOperations),\n/* harmony export */   messageOperations: () => (/* binding */ messageOperations),\n/* harmony export */   prospectOperations: () => (/* binding */ prospectOperations),\n/* harmony export */   searchResultOperations: () => (/* binding */ searchResultOperations),\n/* harmony export */   userOperations: () => (/* binding */ userOperations)\n/* harmony export */ });\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(api)/./lib/supabase.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"bcryptjs\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// User operations\nconst userOperations = {\n    async create (userData) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        // Clean and validate user data\n        const cleanUserData = {\n            email: userData.email.toLowerCase(),\n            password_hash: userData.password_hash,\n            first_name: userData.first_name,\n            last_name: userData.last_name,\n            company: userData.company || null,\n            role: userData.role || \"user\",\n            subscription: userData.subscription || {\n                plan: \"free\",\n                status: \"inactive\"\n            },\n            email_verified: userData.email_verified !== undefined ? userData.email_verified : false,\n            onboarding_complete: userData.onboarding_complete !== undefined ? userData.onboarding_complete : false,\n            is_active: userData.is_active !== undefined ? userData.is_active : true,\n            linkedin_accounts: userData.linkedin_accounts || [],\n            email_accounts: userData.email_accounts || [],\n            api_keys: userData.api_keys || {},\n            settings: userData.settings || {\n                timezone: \"UTC\",\n                workingHours: {\n                    start: 9,\n                    end: 18\n                },\n                workingDays: [\n                    1,\n                    2,\n                    3,\n                    4,\n                    5\n                ],\n                automation: {\n                    enabled: false,\n                    connectionRequests: {\n                        enabled: false\n                    },\n                    welcomeMessages: {\n                        enabled: false\n                    },\n                    followUpMessages: {\n                        enabled: false\n                    },\n                    profileViews: {\n                        enabled: false\n                    }\n                },\n                notifications: {\n                    email: true,\n                    webhook: false\n                }\n            },\n            usage: userData.usage || {\n                totalConnections: 0,\n                totalMessages: 0,\n                totalCampaigns: 0,\n                totalProspects: 0\n            }\n        };\n        const { data, error } = await supabase.from(\"users\").insert([\n            cleanUserData\n        ]).select().single();\n        if (error) {\n            console.error(\"Database error creating user:\", error);\n            throw new Error(`Failed to create user: ${error.message}`);\n        }\n        if (!data) {\n            throw new Error(\"User creation failed - no data returned\");\n        }\n        return data;\n    },\n    async findByEmail (email) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"users\").select(\"*\").eq(\"email\", email.toLowerCase()).single();\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async findById (id) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"users\").select(\"*\").eq(\"id\", id).single();\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async update (id, updates) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"users\").update(updates).eq(\"id\", id).select().single();\n        if (error) throw error;\n        return data;\n    },\n    async delete (id) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { error } = await supabase.from(\"users\").delete().eq(\"id\", id);\n        if (error) throw error;\n    },\n    async findAll (options = {}) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        let query = supabase.from(\"users\").select(\"id, email, first_name, last_name, company, role, subscription, is_active, last_login, created_at\", {\n            count: \"exact\"\n        });\n        if (options.search) {\n            query = query.or(`email.ilike.%${options.search}%,first_name.ilike.%${options.search}%,last_name.ilike.%${options.search}%,company.ilike.%${options.search}%`);\n        }\n        if (options.role && options.role !== \"all\") {\n            query = query.eq(\"role\", options.role);\n        }\n        if (options.status && options.status !== \"all\") {\n            const isActive = options.status === \"active\";\n            query = query.eq(\"is_active\", isActive);\n        }\n        query = query.order(\"created_at\", {\n            ascending: false\n        });\n        if (options.limit) {\n            const from = ((options.page || 1) - 1) * options.limit;\n            const to = from + options.limit - 1;\n            query = query.range(from, to);\n        }\n        const { data, error, count } = await query;\n        if (error) throw error;\n        // Ensure we return valid data structure\n        const users = Array.isArray(data) ? data : [];\n        const total = typeof count === \"number\" ? count : 0;\n        return {\n            users,\n            total\n        };\n    },\n    async comparePassword (plainPassword, hashedPassword) {\n        return bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().compare(plainPassword, hashedPassword);\n    },\n    async hashPassword (password) {\n        const salt = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().genSalt(12);\n        return bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash(password, salt);\n    }\n};\n// Campaign operations\nconst campaignOperations = {\n    async create (campaignData) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"campaigns\").insert([\n            campaignData\n        ]).select().single();\n        if (error) throw error;\n        return data;\n    },\n    async findByUserId (userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"campaigns\").select(\"*\").eq(\"user_id\", userId).order(\"created_at\", {\n            ascending: false\n        });\n        if (error) throw error;\n        return data || [];\n    },\n    async findById (id, userId) {\n        console.log(id, userId);\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"campaigns\").select(\"*\").eq(\"id\", id).eq(\"user_id\", userId).single();\n        console.log(`data ${JSON.stringify(data)}`);\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async update (id, userId, updates) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"campaigns\").update(updates).eq(\"id\", id).eq(\"user_id\", userId).select().single();\n        if (error) throw error;\n        return data;\n    },\n    async delete (id, userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { error } = await supabase.from(\"campaigns\").delete().eq(\"id\", id).eq(\"user_id\", userId);\n        if (error) throw error;\n    }\n};\n// Prospect operations\nconst prospectOperations = {\n    async create (prospectData) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"prospects\").insert([\n            prospectData\n        ]).select().single();\n        if (error) throw error;\n        return data;\n    },\n    async findByUserId (userId, options) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        let query = supabase.from(\"prospects\").select(`*,campaigns!inner(id, name)`, {\n            count: \"exact\"\n        }).eq(\"user_id\", userId);\n        if (options?.search) {\n            query = query.or(`linkedin_data->>name.ilike.%${options.search}%,linkedin_data->>company.ilike.%${options.search}%,linkedin_data->>title.ilike.%${options.search}%`);\n        }\n        if (options?.status && options.status !== \"all\") {\n            query = query.eq(\"status\", options.status);\n        }\n        if (options?.campaignId && options.campaignId !== \"all\") {\n            query = query.eq(\"campaign_id\", options.campaignId);\n        }\n        query = query.order(\"created_at\", {\n            ascending: false\n        });\n        if (options?.limit) {\n            const from = ((options.page || 1) - 1) * options.limit;\n            const to = from + options.limit - 1;\n            query = query.range(from, to);\n        }\n        const { data, error, count } = await query;\n        if (error) throw error;\n        return {\n            items: data || [],\n            total: count ?? (data ? data.length : 0)\n        };\n    },\n    async findById (id, userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"prospects\").select(`\r\n        *,\r\n        campaigns!inner(id, name)\r\n      `).eq(\"id\", id).eq(\"user_id\", userId).single();\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async update (id, userId, updates) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"prospects\").update({\n            ...updates,\n            last_updated: new Date().toISOString()\n        }).eq(\"id\", id).eq(\"user_id\", userId).select(`\r\n        *,\r\n        campaigns!inner(id, name)\r\n      `).single();\n        if (error) throw error;\n        return data;\n    },\n    async delete (id, userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { error } = await supabase.from(\"prospects\").delete().eq(\"id\", id).eq(\"user_id\", userId);\n        if (error) throw error;\n    }\n};\n// Message operations\nconst messageOperations = {\n    async create (messageData) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseClient)();\n        // If prospect_id is null, just insert without join\n        if (!messageData.prospect_id) {\n            const { data, error } = await supabase.from(\"messages\").insert([\n                messageData\n            ]).select().single();\n            if (error) {\n                console.error(\"Error creating message without prospect:\", error);\n                throw error;\n            }\n            return data;\n        }\n        const { data, error } = await supabase.from(\"messages\").insert([\n            messageData\n        ]).select(`\r\n        *,\r\n        prospects(id, linkedin_data, contact_info)\r\n      `).single();\n        if (error) {\n            console.error(\"Error creating message with prospect:\", error);\n            throw error;\n        }\n        return data;\n    },\n    async findByUserId (userId, options) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseClient)();\n        let query = supabase.from(\"messages\").select(`\r\n        *,\r\n        prospects(id, linkedin_data, contact_info)\r\n      `).eq(\"user_id\", userId);\n        if (options?.platform) {\n            query = query.eq(\"platform\", options.platform);\n        }\n        if (options?.conversationId) {\n            query = query.eq(\"conversation_id\", options.conversationId);\n            query = query.order(\"created_at\", {\n                ascending: true\n            });\n        } else {\n            query = query.order(\"created_at\", {\n                ascending: false\n            });\n        }\n        if (options?.limit) {\n            const from = ((options.page || 1) - 1) * options.limit;\n            const to = from + options.limit - 1;\n            query = query.range(from, to);\n        }\n        const { data, error } = await query;\n        if (error) throw error;\n        return data || [];\n    },\n    async findById (id, userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseClient)();\n        const { data, error } = await supabase.from(\"messages\").select(`\r\n        *,\r\n        prospects!inner(id, linkedin_data)\r\n      `).eq(\"id\", id).eq(\"user_id\", userId).single();\n        if (error && error.code !== \"PGRST116\") throw error;\n        return data;\n    },\n    async update (id, userId, updates) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseClient)();\n        const { data, error } = await supabase.from(\"messages\").update(updates).eq(\"id\", id).eq(\"user_id\", userId).select(`\r\n        *,\r\n        prospects!inner(id, linkedin_data)\r\n      `).single();\n        if (error) throw error;\n        return data;\n    },\n    async markAsRead (id, userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseClient)();\n        const { data, error } = await supabase.from(\"messages\").update({\n            status: \"read\",\n            read_at: new Date().toISOString(),\n            analytics: {\n                opened: true,\n                openedAt: new Date().toISOString()\n            }\n        }).eq(\"id\", id).eq(\"user_id\", userId).eq(\"type\", \"received\").select(`\r\n        *,\r\n        prospects!inner(id, linkedin_data)\r\n      `).single();\n        if (error) throw error;\n        return data;\n    },\n    async find (filter) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseClient)();\n        let query = supabase.from(\"messages\").select(\"*\");\n        if (filter.userId) {\n            query = query.eq(\"user_id\", filter.userId);\n        }\n        if (filter.type) {\n            query = query.eq(\"type\", filter.type);\n        }\n        if (filter.platform) {\n            query = query.eq(\"platform\", filter.platform);\n        }\n        if (filter[\"emailData.from\"]) {\n            query = query.eq(\"email_data->>from\", filter[\"emailData.from\"]);\n        }\n        query = query.order(\"created_at\", {\n            ascending: false\n        });\n        const { data, error } = await query;\n        if (error) throw error;\n        return data || [];\n    }\n};\n// Search Results operations\nconst searchResultOperations = {\n    async create (data) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data: result, error } = await supabase.from(\"search_results\").insert([\n            data\n        ]).select().single();\n        if (error) throw error;\n        return result;\n    },\n    async findByCampaignId (campaignId, userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"search_results\").select(\"*\").eq(\"campaign_id\", campaignId).eq(\"user_id\", userId).order(\"created_at\", {\n            ascending: false\n        });\n        if (error) throw error;\n        return data || [];\n    },\n    async findByUserId (userId) {\n        const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdminClient)();\n        const { data, error } = await supabase.from(\"search_results\").select(`\r\n      *,\r\n      campaign_id (id, name, description, created_at)\r\n    `).eq(\"user_id\", userId).order(\"created_at\", {\n            ascending: false\n        });\n        if (error) throw error;\n        return data || [];\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0g7U0FBSyxFQUNiSSxNQUFNLEdBQ05DLE1BQU07UUFFVCxJQUFJSixPQUFPLE1BQU1BO1FBQ2pCLE9BQU91RTtJQUNUO0lBRUEsTUFBTUMsa0JBQWlCckIsVUFBa0IsRUFBRU4sTUFBYztRQUN2RCxNQUFNcEYsV0FBV0wsaUVBQXNCQTtRQUN2QyxNQUFNLEVBQUUyQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU12QyxTQUMzQndDLElBQUksQ0FBQyxrQkFDTEUsTUFBTSxDQUFDLEtBQ1BNLEVBQUUsQ0FBQyxlQUFlMEMsWUFDbEIxQyxFQUFFLENBQUMsV0FBV29DLFFBQ2R0QixLQUFLLENBQUMsY0FBYztZQUFFQyxXQUFXO1FBQU07UUFFMUMsSUFBSXhCLE9BQU8sTUFBTUE7UUFDakIsT0FBT0QsUUFBUSxFQUFFO0lBQ25CO0lBRUEsTUFBTTZDLGNBQWFDLE1BQWM7UUFDL0IsTUFBTXBGLFdBQVdMLGlFQUFzQkE7UUFFdkMsTUFBTSxFQUFFMkMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNdkMsU0FDM0J3QyxJQUFJLENBQUMsa0JBQ0xFLE1BQU0sQ0FDTCxDQUFDOzs7SUFHTCxDQUFDLEVBRUVNLEVBQUUsQ0FBQyxXQUFXb0MsUUFDZHRCLEtBQUssQ0FBQyxjQUFjO1lBQUVDLFdBQVc7UUFBTTtRQUUxQyxJQUFJeEIsT0FBTyxNQUFNQTtRQUNqQixPQUFPRCxRQUFRLEVBQUU7SUFDbkI7QUFDRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbHluY2JvdC1uZXh0anMvLi9saWIvZGF0YWJhc2UudHM/NGQ0OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRTdXBhYmFzZUNsaWVudCwgZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCB9IGZyb20gXCIuL3N1cGFiYXNlXCI7XHJcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFVzZXIge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgZW1haWw6IHN0cmluZztcclxuICBwYXNzd29yZF9oYXNoOiBzdHJpbmc7XHJcbiAgZmlyc3RfbmFtZTogc3RyaW5nO1xyXG4gIGxhc3RfbmFtZTogc3RyaW5nO1xyXG4gIGNvbXBhbnk/OiBzdHJpbmc7XHJcbiAgcm9sZTogXCJ1c2VyXCIgfCBcImFkbWluXCIgfCBcInByZW1pdW1cIjtcclxuICBzdWJzY3JpcHRpb246IHtcclxuICAgIHBsYW46IFwiZnJlZVwiIHwgXCJmdWxsX2FjY2Vzc1wiO1xyXG4gICAgc3RhdHVzOiBcImFjdGl2ZVwiIHwgXCJpbmFjdGl2ZVwiIHwgXCJjYW5jZWxsZWRcIiB8IFwicGFzdF9kdWVcIiB8IFwidHJpYWxpbmdcIjtcclxuICAgIHN0YXJ0RGF0ZT86IHN0cmluZztcclxuICAgIGVuZERhdGU/OiBzdHJpbmc7XHJcbiAgICBuZXh0QmlsbGluZ0RhdGU/OiBzdHJpbmc7XHJcbiAgICBhbW91bnQ/OiBudW1iZXI7XHJcbiAgfTtcclxuICBsaW5rZWRpbl9hY2NvdW50czogQXJyYXk8e1xyXG4gICAgZW1haWw6IHN0cmluZztcclxuICAgIGVuY3J5cHRlZFBhc3N3b3JkOiBzdHJpbmc7XHJcbiAgICBpc0FjdGl2ZTogYm9vbGVhbjtcclxuICAgIGxhc3RMb2dpbj86IHN0cmluZztcclxuICAgIGFjY291bnRIZWFsdGg6IHtcclxuICAgICAgc3RhdHVzOiBcImhlYWx0aHlcIiB8IFwid2FybmluZ1wiIHwgXCJyZXN0cmljdGVkXCIgfCBcImJhbm5lZFwiO1xyXG4gICAgICBsYXN0Q2hlY2s/OiBzdHJpbmc7XHJcbiAgICAgIHJlc3RyaWN0aW9uczogc3RyaW5nW107XHJcbiAgICB9O1xyXG4gICAgZGFpbHlMaW1pdHM6IHtcclxuICAgICAgY29ubmVjdGlvbnM6IG51bWJlcjtcclxuICAgICAgbWVzc2FnZXM6IG51bWJlcjtcclxuICAgICAgcHJvZmlsZVZpZXdzOiBudW1iZXI7XHJcbiAgICB9O1xyXG4gICAgZGFpbHlVc2FnZToge1xyXG4gICAgICBjb25uZWN0aW9uczogbnVtYmVyO1xyXG4gICAgICBtZXNzYWdlczogbnVtYmVyO1xyXG4gICAgICBwcm9maWxlVmlld3M6IG51bWJlcjtcclxuICAgICAgbGFzdFJlc2V0OiBzdHJpbmc7XHJcbiAgICB9O1xyXG4gIH0+O1xyXG4gIGVtYWlsX2FjY291bnRzOiBBcnJheTx7XHJcbiAgICBlbWFpbDogc3RyaW5nO1xyXG4gICAgZW5jcnlwdGVkUGFzc3dvcmQ/OiBzdHJpbmc7XHJcbiAgICBwcm92aWRlcjogXCJnbWFpbFwiIHwgXCJvdXRsb29rXCIgfCBcInNtdHBcIjtcclxuICAgIHNtdHBTZXR0aW5ncz86IHtcclxuICAgICAgaG9zdDogc3RyaW5nO1xyXG4gICAgICBwb3J0OiBudW1iZXI7XHJcbiAgICAgIHNlY3VyZTogYm9vbGVhbjtcclxuICAgIH07XHJcbiAgICBpbWFwU2V0dGluZ3M/OiB7XHJcbiAgICAgIGhvc3Q6IHN0cmluZztcclxuICAgICAgcG9ydDogbnVtYmVyO1xyXG4gICAgICBzZWN1cmU6IGJvb2xlYW47XHJcbiAgICB9O1xyXG4gICAgaXNBY3RpdmU6IGJvb2xlYW47XHJcbiAgICBsYXN0VXNlZD86IHN0cmluZztcclxuICAgIGxhc3RTeW5jQXQ/OiBzdHJpbmc7XHJcbiAgICBkYWlseUxpbWl0czoge1xyXG4gICAgICBlbWFpbHM6IG51bWJlcjtcclxuICAgIH07XHJcbiAgICBkYWlseVVzYWdlOiB7XHJcbiAgICAgIGVtYWlsczogbnVtYmVyO1xyXG4gICAgICBsYXN0UmVzZXQ6IHN0cmluZztcclxuICAgIH07XHJcbiAgICBhY2NvdW50SGVhbHRoOiB7XHJcbiAgICAgIHN0YXR1czogXCJoZWFsdGh5XCIgfCBcIndhcm5pbmdcIiB8IFwicmVzdHJpY3RlZFwiIHwgXCJiYW5uZWRcIjtcclxuICAgICAgbGFzdENoZWNrPzogc3RyaW5nO1xyXG4gICAgICByZXN0cmljdGlvbnM6IHN0cmluZ1tdO1xyXG4gICAgfTtcclxuICB9PjtcclxuICBhcGlfa2V5czoge1xyXG4gICAgb3BlbmFpPzogc3RyaW5nO1xyXG4gICAgZW5jcnlwdGVkT3BlbkFJPzogc3RyaW5nO1xyXG4gICAgcGVycGxleGl0eT86IHN0cmluZztcclxuICAgIGVuY3J5cHRlZFBlcnBsZXhpdHk/OiBzdHJpbmc7XHJcbiAgICBjbGF1ZGU/OiBzdHJpbmc7XHJcbiAgICBlbmNyeXB0ZWRDbGF1ZGU/OiBzdHJpbmc7XHJcbiAgfTtcclxuICBzZXR0aW5nczoge1xyXG4gICAgdGltZXpvbmU6IHN0cmluZztcclxuICAgIHdvcmtpbmdIb3VyczogeyBzdGFydDogbnVtYmVyOyBlbmQ6IG51bWJlciB9O1xyXG4gICAgd29ya2luZ0RheXM6IG51bWJlcltdO1xyXG4gICAgYWlQcm92aWRlcj86IHtcclxuICAgICAgcHJvdmlkZXI6IFwib3BlbmFpXCIgfCBcInBlcnBsZXhpdHlcIiB8IFwiY2xhdWRlXCI7XHJcbiAgICAgIG1vZGVsOiBzdHJpbmc7XHJcbiAgICAgIHRlbXBlcmF0dXJlOiBudW1iZXI7XHJcbiAgICAgIG1heFRva2VuczogbnVtYmVyO1xyXG4gICAgfTtcclxuICAgIGF1dG9tYXRpb246IHtcclxuICAgICAgZW5hYmxlZDogYm9vbGVhbjtcclxuICAgICAgY29ubmVjdGlvblJlcXVlc3RzOiB7IGVuYWJsZWQ6IGJvb2xlYW4gfTtcclxuICAgICAgd2VsY29tZU1lc3NhZ2VzOiB7IGVuYWJsZWQ6IGJvb2xlYW4gfTtcclxuICAgICAgZm9sbG93VXBNZXNzYWdlczogeyBlbmFibGVkOiBib29sZWFuIH07XHJcbiAgICAgIHByb2ZpbGVWaWV3czogeyBlbmFibGVkOiBib29sZWFuIH07XHJcbiAgICAgIGVtYWlsU2VuZGluZz86IHsgZW5hYmxlZDogYm9vbGVhbiB9O1xyXG4gICAgfTtcclxuICAgIG5vdGlmaWNhdGlvbnM6IHtcclxuICAgICAgZW1haWw6IGJvb2xlYW47XHJcbiAgICAgIHdlYmhvb2s6IGJvb2xlYW47XHJcbiAgICB9O1xyXG4gIH07XHJcbiAgdXNhZ2U6IHtcclxuICAgIHRvdGFsQ29ubmVjdGlvbnM6IG51bWJlcjtcclxuICAgIHRvdGFsTWVzc2FnZXM6IG51bWJlcjtcclxuICAgIHRvdGFsQ2FtcGFpZ25zOiBudW1iZXI7XHJcbiAgICB0b3RhbFByb3NwZWN0czogbnVtYmVyO1xyXG4gIH07XHJcbiAgaXNfYWN0aXZlOiBib29sZWFuO1xyXG4gIGxhc3RfbG9naW4/OiBzdHJpbmc7XHJcbiAgZW1haWxfdmVyaWZpZWQ6IGJvb2xlYW47XHJcbiAgb25ib2FyZGluZ19jb21wbGV0ZTogYm9vbGVhbjtcclxuICBlbWFpbF92ZXJpZmljYXRpb25fdG9rZW4/OiBzdHJpbmc7XHJcbiAgZW1haWxfdmVyaWZpY2F0aW9uX2V4cGlyZXM/OiBzdHJpbmc7XHJcbiAgcGFzc3dvcmRfcmVzZXRfdG9rZW4/OiBzdHJpbmc7XHJcbiAgcGFzc3dvcmRfcmVzZXRfZXhwaXJlcz86IHN0cmluZztcclxuICBjcmVhdGVkX2F0OiBzdHJpbmc7XHJcbiAgdXBkYXRlZF9hdDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENhbXBhaWduIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHVzZXJfaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XHJcbiAgc3RhdHVzOiBcImRyYWZ0XCIgfCBcImFjdGl2ZVwiIHwgXCJwYXVzZWRcIiB8IFwiY29tcGxldGVkXCIgfCBcImFyY2hpdmVkXCI7XHJcbiAgc2VhcmNoX2NyaXRlcmlhOiB7XHJcbiAgICBrZXl3b3Jkcz86IHN0cmluZztcclxuICAgIGxvY2F0aW9uPzogc3RyaW5nO1xyXG4gICAgY29tcGFueT86IHN0cmluZztcclxuICAgIHRpdGxlPzogc3RyaW5nO1xyXG4gICAgaW5kdXN0cnk/OiBzdHJpbmc7XHJcbiAgICBjb25uZWN0aW9uTGV2ZWw/OiBzdHJpbmc7XHJcbiAgICBjdXJyZW50Q29tcGFueT86IHN0cmluZztcclxuICAgIHBhc3RDb21wYW55Pzogc3RyaW5nO1xyXG4gICAgc2Nob29sPzogc3RyaW5nO1xyXG4gICAgcHJvZmlsZUxhbmd1YWdlPzogc3RyaW5nO1xyXG4gICAgc2VydmljZUNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gICAgbm9ucHJvZml0Pzogc3RyaW5nO1xyXG4gICAgc2FsZXNOYXZpZ2F0b3JVcmw/OiBzdHJpbmc7XHJcbiAgICBjdXN0b21GaWx0ZXJzPzogYW55O1xyXG4gIH07XHJcbiAgbWVzc2FnZV90ZW1wbGF0ZXM6IHtcclxuICAgIC8vIEFJLWdlbmVyYXRlZCBjb252ZXJzYXRpb24gc3RhcnRlcnMgYXJlIGNvbmZpZ3VyZWQgaGVyZVxyXG4gICAgY29ubmVjdGlvblJlcXVlc3Q6IHtcclxuICAgICAgZW5hYmxlZDogYm9vbGVhbjtcclxuICAgICAgdGVtcGxhdGU/OiBzdHJpbmc7XHJcbiAgICAgIHRvbmU6IFwicHJvZmVzc2lvbmFsXCIgfCBcImNhc3VhbFwiIHwgXCJmcmllbmRseVwiIHwgXCJkaXJlY3RcIjtcclxuICAgICAgdXNlQUk6IGJvb2xlYW47XHJcbiAgICAgIGN1c3RvbVByb21wdD86IHN0cmluZztcclxuICAgIH07XHJcbiAgICB3ZWxjb21lTWVzc2FnZToge1xyXG4gICAgICBlbmFibGVkOiBib29sZWFuO1xyXG4gICAgICB0ZW1wbGF0ZT86IHN0cmluZztcclxuICAgICAgdG9uZTogXCJwcm9mZXNzaW9uYWxcIiB8IFwiY2FzdWFsXCIgfCBcImZyaWVuZGx5XCIgfCBcImRpcmVjdFwiO1xyXG4gICAgICB1c2VBSTogYm9vbGVhbjtcclxuICAgICAgY3VzdG9tUHJvbXB0Pzogc3RyaW5nO1xyXG4gICAgICBkZWxheTogbnVtYmVyO1xyXG4gICAgfTtcclxuICAgIGZvbGxvd1VwU2VxdWVuY2U6IEFycmF5PHtcclxuICAgICAgb3JkZXI6IG51bWJlcjtcclxuICAgICAgdGVtcGxhdGU/OiBzdHJpbmc7XHJcbiAgICAgIHRvbmU6IFwicHJvZmVzc2lvbmFsXCIgfCBcImNhc3VhbFwiIHwgXCJmcmllbmRseVwiIHwgXCJkaXJlY3RcIjtcclxuICAgICAgdXNlQUk6IGJvb2xlYW47XHJcbiAgICAgIGN1c3RvbVByb21wdD86IHN0cmluZztcclxuICAgICAgZGVsYXk6IG51bWJlcjtcclxuICAgICAgZW5hYmxlZDogYm9vbGVhbjtcclxuICAgIH0+O1xyXG4gICAgZW1haWxUZW1wbGF0ZXM6IHtcclxuICAgICAgY29sZEVtYWlsOiB7XHJcbiAgICAgICAgZW5hYmxlZDogYm9vbGVhbjtcclxuICAgICAgICB0ZW1wbGF0ZT86IHN0cmluZztcclxuICAgICAgICB0b25lOiBcInByb2Zlc3Npb25hbFwiIHwgXCJjYXN1YWxcIiB8IFwiZnJpZW5kbHlcIiB8IFwiZGlyZWN0XCI7XHJcbiAgICAgICAgdXNlQUk6IGJvb2xlYW47XHJcbiAgICAgICAgY3VzdG9tUHJvbXB0Pzogc3RyaW5nO1xyXG4gICAgICAgIGRlbGF5OiBudW1iZXI7XHJcbiAgICAgIH07XHJcbiAgICAgIGZvbGxvd1VwRW1haWw6IHtcclxuICAgICAgICBlbmFibGVkOiBib29sZWFuO1xyXG4gICAgICAgIHRlbXBsYXRlPzogc3RyaW5nO1xyXG4gICAgICAgIHRvbmU6IFwicHJvZmVzc2lvbmFsXCIgfCBcImNhc3VhbFwiIHwgXCJmcmllbmRseVwiIHwgXCJkaXJlY3RcIjtcclxuICAgICAgICB1c2VBSTogYm9vbGVhbjtcclxuICAgICAgICBjdXN0b21Qcm9tcHQ/OiBzdHJpbmc7XHJcbiAgICAgICAgZGVsYXk6IG51bWJlcjtcclxuICAgICAgfTtcclxuICAgIH07XHJcbiAgfTtcclxuICBhdXRvbWF0aW9uOiB7XHJcbiAgICBlbmFibGVkOiBib29sZWFuO1xyXG4gICAgZGFpbHlMaW1pdHM6IHtcclxuICAgICAgY29ubmVjdGlvbnM6IG51bWJlcjtcclxuICAgICAgbWVzc2FnZXM6IG51bWJlcjtcclxuICAgICAgZW1haWxzOiBudW1iZXI7XHJcbiAgICB9O1xyXG4gICAgdGltaW5nOiB7XHJcbiAgICAgIHdvcmtpbmdIb3VyczogeyBzdGFydDogbnVtYmVyOyBlbmQ6IG51bWJlciB9O1xyXG4gICAgICB3b3JraW5nRGF5czogbnVtYmVyW107XHJcbiAgICAgIHJhbmRvbURlbGF5OiB7IG1pbjogbnVtYmVyOyBtYXg6IG51bWJlciB9O1xyXG4gICAgfTtcclxuICAgIHdpdGhkcmF3SW52aXRhdGlvbnM6IHtcclxuICAgICAgZW5hYmxlZDogYm9vbGVhbjtcclxuICAgICAgYWZ0ZXJEYXlzOiBudW1iZXI7XHJcbiAgICB9O1xyXG4gICAgZW1haWxTZW5kaW5nOiB7XHJcbiAgICAgIGVuYWJsZWQ6IGJvb2xlYW47XHJcbiAgICAgIGRhaWx5TGltaXQ6IG51bWJlcjtcclxuICAgIH07XHJcbiAgfTtcclxuICBzdGF0aXN0aWNzOiB7XHJcbiAgICB0b3RhbFByb3NwZWN0czogbnVtYmVyO1xyXG4gICAgY29ubmVjdGlvbnNTZW50OiBudW1iZXI7XHJcbiAgICBjb25uZWN0aW9uc0FjY2VwdGVkOiBudW1iZXI7XHJcbiAgICBtZXNzYWdlc1NlbnQ6IG51bWJlcjtcclxuICAgIG1lc3NhZ2VzUmVwbGllZDogbnVtYmVyO1xyXG4gICAgcHJvZmlsZVZpZXdzOiBudW1iZXI7XHJcbiAgICBhY2NlcHRhbmNlUmF0ZTogbnVtYmVyO1xyXG4gICAgcmVzcG9uc2VSYXRlOiBudW1iZXI7XHJcbiAgICBsYXN0QWN0aXZpdHk/OiBzdHJpbmc7XHJcbiAgfTtcclxuICBpbnRlZ3JhdGlvbnM6IHtcclxuICAgIHdlYmhvb2tzOiBBcnJheTx7XHJcbiAgICAgIG5hbWU6IHN0cmluZztcclxuICAgICAgdXJsOiBzdHJpbmc7XHJcbiAgICAgIGV2ZW50czogc3RyaW5nW107XHJcbiAgICAgIGVuYWJsZWQ6IGJvb2xlYW47XHJcbiAgICAgIHNlY3JldD86IHN0cmluZztcclxuICAgIH0+O1xyXG4gICAgemFwaWVyOiB7IGVuYWJsZWQ6IGJvb2xlYW47IHdlYmhvb2tVcmw/OiBzdHJpbmcgfTtcclxuICAgIG1ha2U6IHsgZW5hYmxlZDogYm9vbGVhbjsgd2ViaG9va1VybD86IHN0cmluZyB9O1xyXG4gICAgbjhuOiB7IGVuYWJsZWQ6IGJvb2xlYW47IHdlYmhvb2tVcmw/OiBzdHJpbmcgfTtcclxuICB9O1xyXG4gIHRhZ3M6IHN0cmluZ1tdO1xyXG4gIHByaW9yaXR5OiBudW1iZXI7XHJcbiAgaXNfYWN0aXZlOiBib29sZWFuO1xyXG4gIGNyZWF0ZWRfYXQ6IHN0cmluZztcclxuICB1cGRhdGVkX2F0OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUHJvc3BlY3Qge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgdXNlcl9pZDogc3RyaW5nO1xyXG4gIGNhbXBhaWduX2lkOiBzdHJpbmc7XHJcbiAgbGlua2VkaW5fZGF0YToge1xyXG4gICAgcHJvZmlsZVVybDogc3RyaW5nO1xyXG4gICAgbGlua2VkaW5JZD86IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIGZpcnN0TmFtZT86IHN0cmluZztcclxuICAgIGxhc3ROYW1lPzogc3RyaW5nO1xyXG4gICAgaGVhZGxpbmU/OiBzdHJpbmc7XHJcbiAgICB0aXRsZT86IHN0cmluZztcclxuICAgIGNvbXBhbnk/OiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbj86IHN0cmluZztcclxuICAgIGluZHVzdHJ5Pzogc3RyaW5nO1xyXG4gICAgY29ubmVjdGlvbkxldmVsPzogc3RyaW5nO1xyXG4gICAgcHJvZmlsZUltYWdlVXJsPzogc3RyaW5nO1xyXG4gICAgYmFja2dyb3VuZEltYWdlVXJsPzogc3RyaW5nO1xyXG4gICAgc3VtbWFyeT86IHN0cmluZztcclxuICAgIGV4cGVyaWVuY2U/OiBBcnJheTx7XHJcbiAgICAgIHRpdGxlOiBzdHJpbmc7XHJcbiAgICAgIGNvbXBhbnk6IHN0cmluZztcclxuICAgICAgZHVyYXRpb246IHN0cmluZztcclxuICAgICAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICAgIH0+O1xyXG4gICAgZWR1Y2F0aW9uPzogQXJyYXk8e1xyXG4gICAgICBzY2hvb2w6IHN0cmluZztcclxuICAgICAgZGVncmVlOiBzdHJpbmc7XHJcbiAgICAgIGZpZWxkOiBzdHJpbmc7XHJcbiAgICAgIGR1cmF0aW9uOiBzdHJpbmc7XHJcbiAgICB9PjtcclxuICAgIHNraWxscz86IHN0cmluZ1tdO1xyXG4gICAgbGFuZ3VhZ2VzPzogc3RyaW5nW107XHJcbiAgICBtdXR1YWxDb25uZWN0aW9ucz86IG51bWJlcjtcclxuICAgIGZvbGxvd2Vycz86IG51bWJlcjtcclxuICAgIGNvbm5lY3Rpb25zPzogbnVtYmVyO1xyXG4gIH07XHJcbiAgY29udGFjdF9pbmZvOiB7XHJcbiAgICBlbWFpbD86IHN0cmluZztcclxuICAgIHBob25lPzogc3RyaW5nO1xyXG4gICAgd2Vic2l0ZT86IHN0cmluZztcclxuICAgIHR3aXR0ZXI/OiBzdHJpbmc7XHJcbiAgICBvdGhlclNvY2lhbD86IGFueTtcclxuICB9O1xyXG4gIHN0YXR1czpcclxuICAgIHwgXCJuZXdcIlxyXG4gICAgfCBcImNvbm5lY3Rpb25fcGVuZGluZ1wiXHJcbiAgICB8IFwiY29ubmVjdGlvbl9zZW50XCJcclxuICAgIHwgXCJjb25uZWN0ZWRcIlxyXG4gICAgfCBcImNvbm5lY3Rpb25fZmFpbGVkXCJcclxuICAgIHwgXCJjb25uZWN0aW9uX2RlY2xpbmVkXCJcclxuICAgIHwgXCJtZXNzYWdlX3NlbnRcIlxyXG4gICAgfCBcIm1lc3NhZ2VfcmVwbGllZFwiXHJcbiAgICB8IFwibWVzc2FnZV9mYWlsZWRcIlxyXG4gICAgfCBcImZvbGxvd191cF9zZW50XCJcclxuICAgIHwgXCJmb2xsb3dfdXBfcmVwbGllZFwiXHJcbiAgICB8IFwidW5yZXNwb25zaXZlXCJcclxuICAgIHwgXCJxdWFsaWZpZWRcIlxyXG4gICAgfCBcIm5vdF9xdWFsaWZpZWRcIlxyXG4gICAgfCBcImFyY2hpdmVkXCI7XHJcbiAgaW50ZXJhY3Rpb25zOiBBcnJheTx7XHJcbiAgICB0eXBlOlxyXG4gICAgICB8IFwiY29ubmVjdGlvbl9yZXF1ZXN0XCJcclxuICAgICAgfCBcIm1lc3NhZ2VcIlxyXG4gICAgICB8IFwiZm9sbG93X3VwXCJcclxuICAgICAgfCBcInByb2ZpbGVfdmlld1wiXHJcbiAgICAgIHwgXCJub3RlXCI7XHJcbiAgICBjb250ZW50Pzogc3RyaW5nO1xyXG4gICAgdGltZXN0YW1wOiBzdHJpbmc7XHJcbiAgICByZXNwb25zZT86IHN0cmluZztcclxuICAgIHJlc3BvbnNlVGltZXN0YW1wPzogc3RyaW5nO1xyXG4gICAgYXV0b21hdGVkOiBib29sZWFuO1xyXG4gICAgam9iSWQ/OiBzdHJpbmc7XHJcbiAgICBtZXRhZGF0YT86IGFueTtcclxuICB9PjtcclxuICBhdXRvbWF0aW9uOiB7XHJcbiAgICBjb25uZWN0aW9uUmVxdWVzdFNlbnQ6IGJvb2xlYW47XHJcbiAgICBjb25uZWN0aW9uUmVxdWVzdERhdGU/OiBzdHJpbmcgfCBudWxsO1xyXG4gICAgd2VsY29tZU1lc3NhZ2VTZW50OiBib29sZWFuO1xyXG4gICAgd2VsY29tZU1lc3NhZ2VEYXRlPzogc3RyaW5nIHwgbnVsbDtcclxuICAgIGZvbGxvd1Vwc1NlbnQ6IG51bWJlcjtcclxuICAgIGxhc3RGb2xsb3dVcERhdGU/OiBzdHJpbmcgfCBudWxsO1xyXG4gICAgbmV4dFNjaGVkdWxlZEFjdGlvbj86XHJcbiAgICAgIHwgXCJjb25uZWN0aW9uX3JlcXVlc3RcIlxyXG4gICAgICB8IFwid2VsY29tZV9tZXNzYWdlXCJcclxuICAgICAgfCBcImZvbGxvd191cFwiXHJcbiAgICAgIHwgXCJ3aXRoZHJhd19pbnZpdGF0aW9uXCJcclxuICAgICAgfCBudWxsO1xyXG4gICAgbmV4dFNjaGVkdWxlZERhdGU/OiBzdHJpbmcgfCBudWxsO1xyXG4gICAgYXV0b21hdGlvblBhdXNlZDogYm9vbGVhbjtcclxuICAgIHBhdXNlUmVhc29uPzogc3RyaW5nIHwgbnVsbDtcclxuICAgIGNvbGRFbWFpbFNlbnQ6IGJvb2xlYW47XHJcbiAgICBjb2xkRW1haWxEYXRlPzogc3RyaW5nIHwgbnVsbDtcclxuICAgIGVtYWlsRm9sbG93VXBzU2VudDogbnVtYmVyO1xyXG4gICAgbGFzdEVtYWlsRm9sbG93VXBEYXRlPzogc3RyaW5nIHwgbnVsbDtcclxuICB9O1xyXG4gIHNjb3Jpbmc6IHtcclxuICAgIGxlYWRTY29yZTogbnVtYmVyO1xyXG4gICAgZmFjdG9yczoge1xyXG4gICAgICB0aXRsZU1hdGNoOiBudW1iZXI7XHJcbiAgICAgIGNvbXBhbnlNYXRjaDogbnVtYmVyO1xyXG4gICAgICBsb2NhdGlvbk1hdGNoOiBudW1iZXI7XHJcbiAgICAgIGluZHVzdHJ5TWF0Y2g6IG51bWJlcjtcclxuICAgICAgY29ubmVjdGlvbkxldmVsOiBudW1iZXI7XHJcbiAgICAgIHByb2ZpbGVDb21wbGV0ZW5lc3M6IG51bWJlcjtcclxuICAgICAgYWN0aXZpdHlMZXZlbDogbnVtYmVyO1xyXG4gICAgfTtcclxuICAgIGxhc3RDYWxjdWxhdGVkPzogc3RyaW5nIHwgbnVsbDtcclxuICB9O1xyXG4gIHRhZ3M6IHN0cmluZ1tdO1xyXG4gIG5vdGVzOiBBcnJheTx7XHJcbiAgICBjb250ZW50OiBzdHJpbmc7XHJcbiAgICBhdXRob3I6IHN0cmluZztcclxuICAgIHRpbWVzdGFtcDogc3RyaW5nO1xyXG4gICAgdHlwZTogXCJub3RlXCIgfCBcInJlbWluZGVyXCIgfCBcInRhc2tcIjtcclxuICB9PjtcclxuICBjdXN0b21fZmllbGRzOiBhbnk7XHJcbiAgc291cmNlOiBcInNlYXJjaFwiIHwgXCJpbXBvcnRcIiB8IFwibWFudWFsXCIgfCBcInNhbGVzX25hdmlnYXRvclwiO1xyXG4gIHNlYXJjaF9xdWVyeT86IHN0cmluZztcclxuICBpc19hY3RpdmU6IGJvb2xlYW47XHJcbiAgbGFzdF91cGRhdGVkOiBzdHJpbmc7XHJcbiAgY3JlYXRlZF9hdDogc3RyaW5nO1xyXG4gIHVwZGF0ZWRfYXQ6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2hSZXN1bHQge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgY2FtcGFpZ25faWQ6IHN0cmluZztcclxuICB1c2VyX2lkOiBzdHJpbmc7XHJcbiAgc2VhcmNoX2ZpbHRlcnM6IGFueTtcclxuICByZXN1bHRzOiBhbnlbXTtcclxuICB0b3RhbF9yZXN1bHRzOiBudW1iZXI7XHJcbiAgc3RhdHVzOiBcInBlbmRpbmdcIiB8IFwicHJvY2Vzc2luZ1wiIHwgXCJjb21wbGV0ZWRcIiB8IFwiZmFpbGVkXCI7XHJcbiAgZXJyb3JfbWVzc2FnZT86IHN0cmluZztcclxuICBjcmVhdGVkX2F0OiBzdHJpbmc7XHJcbiAgdXBkYXRlZF9hdDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE1lc3NhZ2Uge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgdXNlcl9pZDogc3RyaW5nO1xyXG4gIHByb3NwZWN0X2lkOiBzdHJpbmc7XHJcbiAgY2FtcGFpZ25faWQ/OiBzdHJpbmc7XHJcbiAgY29udmVyc2F0aW9uX2lkOiBzdHJpbmc7XHJcbiAgdHlwZTogXCJzZW50XCIgfCBcInJlY2VpdmVkXCI7XHJcbiAgbWVzc2FnZV90eXBlOlxyXG4gICAgfCBcImNvbm5lY3Rpb25fcmVxdWVzdFwiXHJcbiAgICB8IFwid2VsY29tZVwiXHJcbiAgICB8IFwiZm9sbG93X3VwXCJcclxuICAgIHwgXCJtYW51YWxcIlxyXG4gICAgfCBcImF1dG9fcmVwbHlcIlxyXG4gICAgfCBcImNvbGRfZW1haWxcIlxyXG4gICAgfCBcImVtYWlsX2ZvbGxvd191cFwiO1xyXG4gIGNvbnRlbnQ6IHN0cmluZztcclxuICBzdWJqZWN0Pzogc3RyaW5nO1xyXG4gIHBsYXRmb3JtOiBcImxpbmtlZGluXCIgfCBcImVtYWlsXCIgfCBcIm90aGVyXCI7XHJcbiAgZW1haWxfZGF0YT86IHtcclxuICAgIHRvOiBzdHJpbmc7XHJcbiAgICBmcm9tOiBzdHJpbmc7XHJcbiAgICBjYz86IHN0cmluZ1tdO1xyXG4gICAgYmNjPzogc3RyaW5nW107XHJcbiAgICBtZXNzYWdlSWQ/OiBzdHJpbmc7XHJcbiAgICBpblJlcGx5VG8/OiBzdHJpbmc7XHJcbiAgICByZWZlcmVuY2VzPzogc3RyaW5nW107XHJcbiAgICB0aHJlYWRJZD86IHN0cmluZztcclxuICB9O1xyXG4gIHN0YXR1czpcclxuICAgIHwgXCJkcmFmdFwiXHJcbiAgICB8IFwic2VuZGluZ1wiXHJcbiAgICB8IFwic2VudFwiXHJcbiAgICB8IFwiZGVsaXZlcmVkXCJcclxuICAgIHwgXCJyZWFkXCJcclxuICAgIHwgXCJyZXBsaWVkXCJcclxuICAgIHwgXCJmYWlsZWRcIjtcclxuICBsaW5rZWRpbl9tZXNzYWdlX2lkPzogc3RyaW5nO1xyXG4gIHRocmVhZF9pZD86IHN0cmluZztcclxuICBhdXRvbWF0ZWQ6IGJvb2xlYW47XHJcbiAgYWlfZ2VuZXJhdGVkOiBib29sZWFuO1xyXG4gIGFpX3Byb21wdD86IHN0cmluZztcclxuICB0ZW1wbGF0ZV91c2VkPzogc3RyaW5nO1xyXG4gIHNjaGVkdWxlZF9mb3I/OiBzdHJpbmc7XHJcbiAgc2VudF9hdD86IHN0cmluZztcclxuICBkZWxpdmVyZWRfYXQ/OiBzdHJpbmc7XHJcbiAgcmVhZF9hdD86IHN0cmluZztcclxuICByZXBsaWVkX2F0Pzogc3RyaW5nO1xyXG4gIGZhaWx1cmVfcmVhc29uPzogc3RyaW5nO1xyXG4gIHJldHJ5X2NvdW50OiBudW1iZXI7XHJcbiAgbWV0YWRhdGE6IHtcclxuICAgIHVzZXJBZ2VudD86IHN0cmluZztcclxuICAgIGlwQWRkcmVzcz86IHN0cmluZztcclxuICAgIGRldmljZUluZm8/OiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbj86IHN0cmluZztcclxuICAgIHJlc3BvbnNlVGltZT86IG51bWJlcjtcclxuICAgIGNoYXJhY3RlckNvdW50PzogbnVtYmVyO1xyXG4gICAgd29yZENvdW50PzogbnVtYmVyO1xyXG4gIH07XHJcbiAgYXR0YWNobWVudHM6IEFycmF5PHtcclxuICAgIHR5cGU6IHN0cmluZztcclxuICAgIHVybDogc3RyaW5nO1xyXG4gICAgZmlsZW5hbWU6IHN0cmluZztcclxuICAgIHNpemU6IG51bWJlcjtcclxuICAgIG1pbWVUeXBlOiBzdHJpbmc7XHJcbiAgfT47XHJcbiAgYW5hbHl0aWNzOiB7XHJcbiAgICBvcGVuZWQ6IGJvb2xlYW47XHJcbiAgICBvcGVuZWRBdD86IHN0cmluZztcclxuICAgIGNsaWNrZWRMaW5rczogQXJyYXk8e1xyXG4gICAgICB1cmw6IHN0cmluZztcclxuICAgICAgY2xpY2tlZEF0OiBzdHJpbmc7XHJcbiAgICB9PjtcclxuICAgIHJlc3BvbnNlUmVjZWl2ZWQ6IGJvb2xlYW47XHJcbiAgICByZXNwb25zZVRpbWU/OiBudW1iZXI7XHJcbiAgICBzZW50aW1lbnQ6IFwicG9zaXRpdmVcIiB8IFwibmV1dHJhbFwiIHwgXCJuZWdhdGl2ZVwiO1xyXG4gICAgbGVhZFF1YWxpdHk6IFwiaG90XCIgfCBcIndhcm1cIiB8IFwiY29sZFwiIHwgXCJ1bnF1YWxpZmllZFwiO1xyXG4gIH07XHJcbiAgdGFnczogc3RyaW5nW107XHJcbiAgaXNfYXJjaGl2ZWQ6IGJvb2xlYW47XHJcbiAgaXNfc3RhcnJlZDogYm9vbGVhbjtcclxuICBpc19pbXBvcnRhbnQ6IGJvb2xlYW47XHJcbiAgY3JlYXRlZF9hdDogc3RyaW5nO1xyXG4gIHVwZGF0ZWRfYXQ6IHN0cmluZztcclxufVxyXG5cclxuLy8gVXNlciBvcGVyYXRpb25zXHJcbmV4cG9ydCBjb25zdCB1c2VyT3BlcmF0aW9ucyA9IHtcclxuICBhc3luYyBjcmVhdGUodXNlckRhdGE6IE9taXQ8VXNlciwgXCJpZFwiIHwgXCJjcmVhdGVkX2F0XCIgfCBcInVwZGF0ZWRfYXRcIj4pIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpO1xyXG5cclxuICAgIC8vIENsZWFuIGFuZCB2YWxpZGF0ZSB1c2VyIGRhdGFcclxuICAgIGNvbnN0IGNsZWFuVXNlckRhdGEgPSB7XHJcbiAgICAgIGVtYWlsOiB1c2VyRGF0YS5lbWFpbC50b0xvd2VyQ2FzZSgpLFxyXG4gICAgICBwYXNzd29yZF9oYXNoOiB1c2VyRGF0YS5wYXNzd29yZF9oYXNoLFxyXG4gICAgICBmaXJzdF9uYW1lOiB1c2VyRGF0YS5maXJzdF9uYW1lLFxyXG4gICAgICBsYXN0X25hbWU6IHVzZXJEYXRhLmxhc3RfbmFtZSxcclxuICAgICAgY29tcGFueTogdXNlckRhdGEuY29tcGFueSB8fCBudWxsLFxyXG4gICAgICByb2xlOiB1c2VyRGF0YS5yb2xlIHx8IFwidXNlclwiLFxyXG4gICAgICBzdWJzY3JpcHRpb246IHVzZXJEYXRhLnN1YnNjcmlwdGlvbiB8fCB7XHJcbiAgICAgICAgcGxhbjogXCJmcmVlXCIsXHJcbiAgICAgICAgc3RhdHVzOiBcImluYWN0aXZlXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGVtYWlsX3ZlcmlmaWVkOlxyXG4gICAgICAgIHVzZXJEYXRhLmVtYWlsX3ZlcmlmaWVkICE9PSB1bmRlZmluZWQgPyB1c2VyRGF0YS5lbWFpbF92ZXJpZmllZCA6IGZhbHNlLFxyXG4gICAgICBvbmJvYXJkaW5nX2NvbXBsZXRlOlxyXG4gICAgICAgIHVzZXJEYXRhLm9uYm9hcmRpbmdfY29tcGxldGUgIT09IHVuZGVmaW5lZFxyXG4gICAgICAgICAgPyB1c2VyRGF0YS5vbmJvYXJkaW5nX2NvbXBsZXRlXHJcbiAgICAgICAgICA6IGZhbHNlLFxyXG4gICAgICBpc19hY3RpdmU6IHVzZXJEYXRhLmlzX2FjdGl2ZSAhPT0gdW5kZWZpbmVkID8gdXNlckRhdGEuaXNfYWN0aXZlIDogdHJ1ZSxcclxuICAgICAgbGlua2VkaW5fYWNjb3VudHM6IHVzZXJEYXRhLmxpbmtlZGluX2FjY291bnRzIHx8IFtdLFxyXG4gICAgICBlbWFpbF9hY2NvdW50czogdXNlckRhdGEuZW1haWxfYWNjb3VudHMgfHwgW10sXHJcbiAgICAgIGFwaV9rZXlzOiB1c2VyRGF0YS5hcGlfa2V5cyB8fCB7fSxcclxuICAgICAgc2V0dGluZ3M6IHVzZXJEYXRhLnNldHRpbmdzIHx8IHtcclxuICAgICAgICB0aW1lem9uZTogXCJVVENcIixcclxuICAgICAgICB3b3JraW5nSG91cnM6IHsgc3RhcnQ6IDksIGVuZDogMTggfSxcclxuICAgICAgICB3b3JraW5nRGF5czogWzEsIDIsIDMsIDQsIDVdLFxyXG4gICAgICAgIGF1dG9tYXRpb246IHtcclxuICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgY29ubmVjdGlvblJlcXVlc3RzOiB7IGVuYWJsZWQ6IGZhbHNlIH0sXHJcbiAgICAgICAgICB3ZWxjb21lTWVzc2FnZXM6IHsgZW5hYmxlZDogZmFsc2UgfSxcclxuICAgICAgICAgIGZvbGxvd1VwTWVzc2FnZXM6IHsgZW5hYmxlZDogZmFsc2UgfSxcclxuICAgICAgICAgIHByb2ZpbGVWaWV3czogeyBlbmFibGVkOiBmYWxzZSB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbm90aWZpY2F0aW9uczoge1xyXG4gICAgICAgICAgZW1haWw6IHRydWUsXHJcbiAgICAgICAgICB3ZWJob29rOiBmYWxzZSxcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICB1c2FnZTogdXNlckRhdGEudXNhZ2UgfHwge1xyXG4gICAgICAgIHRvdGFsQ29ubmVjdGlvbnM6IDAsXHJcbiAgICAgICAgdG90YWxNZXNzYWdlczogMCxcclxuICAgICAgICB0b3RhbENhbXBhaWduczogMCxcclxuICAgICAgICB0b3RhbFByb3NwZWN0czogMCxcclxuICAgICAgfSxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJ1c2Vyc1wiKVxyXG4gICAgICAuaW5zZXJ0KFtjbGVhblVzZXJEYXRhXSlcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkRhdGFiYXNlIGVycm9yIGNyZWF0aW5nIHVzZXI6XCIsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIHVzZXI6ICR7ZXJyb3IubWVzc2FnZX1gKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWRhdGEpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVXNlciBjcmVhdGlvbiBmYWlsZWQgLSBubyBkYXRhIHJldHVybmVkXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGZpbmRCeUVtYWlsKGVtYWlsOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJ1c2Vyc1wiKVxyXG4gICAgICAuc2VsZWN0KFwiKlwiKVxyXG4gICAgICAuZXEoXCJlbWFpbFwiLCBlbWFpbC50b0xvd2VyQ2FzZSgpKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGVycm9yICYmIGVycm9yLmNvZGUgIT09IFwiUEdSU1QxMTZcIikgdGhyb3cgZXJyb3I7XHJcbiAgICByZXR1cm4gZGF0YTtcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlJZChpZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKTtcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwidXNlcnNcIilcclxuICAgICAgLnNlbGVjdChcIipcIilcclxuICAgICAgLmVxKFwiaWRcIiwgaWQpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IgJiYgZXJyb3IuY29kZSAhPT0gXCJQR1JTVDExNlwiKSB0aHJvdyBlcnJvcjtcclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIHVwZGF0ZShpZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPFVzZXI+KSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKTtcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwidXNlcnNcIilcclxuICAgICAgLnVwZGF0ZSh1cGRhdGVzKVxyXG4gICAgICAuZXEoXCJpZFwiLCBpZClcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG4gICAgcmV0dXJuIGRhdGE7XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZGVsZXRlKGlkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbShcInVzZXJzXCIpLmRlbGV0ZSgpLmVxKFwiaWRcIiwgaWQpO1xyXG5cclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZmluZEFsbChcclxuICAgIG9wdGlvbnM6IHtcclxuICAgICAgcGFnZT86IG51bWJlcjtcclxuICAgICAgbGltaXQ/OiBudW1iZXI7XHJcbiAgICAgIHNlYXJjaD86IHN0cmluZztcclxuICAgICAgcm9sZT86IHN0cmluZztcclxuICAgICAgc3RhdHVzPzogc3RyaW5nO1xyXG4gICAgfSA9IHt9XHJcbiAgKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKTtcclxuICAgIGxldCBxdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwidXNlcnNcIilcclxuICAgICAgLnNlbGVjdChcclxuICAgICAgICBcImlkLCBlbWFpbCwgZmlyc3RfbmFtZSwgbGFzdF9uYW1lLCBjb21wYW55LCByb2xlLCBzdWJzY3JpcHRpb24sIGlzX2FjdGl2ZSwgbGFzdF9sb2dpbiwgY3JlYXRlZF9hdFwiLFxyXG4gICAgICAgIHsgY291bnQ6IFwiZXhhY3RcIiB9XHJcbiAgICAgICk7XHJcblxyXG4gICAgaWYgKG9wdGlvbnMuc2VhcmNoKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkub3IoXHJcbiAgICAgICAgYGVtYWlsLmlsaWtlLiUke29wdGlvbnMuc2VhcmNofSUsZmlyc3RfbmFtZS5pbGlrZS4lJHtvcHRpb25zLnNlYXJjaH0lLGxhc3RfbmFtZS5pbGlrZS4lJHtvcHRpb25zLnNlYXJjaH0lLGNvbXBhbnkuaWxpa2UuJSR7b3B0aW9ucy5zZWFyY2h9JWBcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAob3B0aW9ucy5yb2xlICYmIG9wdGlvbnMucm9sZSAhPT0gXCJhbGxcIikge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKFwicm9sZVwiLCBvcHRpb25zLnJvbGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChvcHRpb25zLnN0YXR1cyAmJiBvcHRpb25zLnN0YXR1cyAhPT0gXCJhbGxcIikge1xyXG4gICAgICBjb25zdCBpc0FjdGl2ZSA9IG9wdGlvbnMuc3RhdHVzID09PSBcImFjdGl2ZVwiO1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKFwiaXNfYWN0aXZlXCIsIGlzQWN0aXZlKTtcclxuICAgIH1cclxuXHJcbiAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyKFwiY3JlYXRlZF9hdFwiLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XHJcblxyXG4gICAgaWYgKG9wdGlvbnMubGltaXQpIHtcclxuICAgICAgY29uc3QgZnJvbSA9ICgob3B0aW9ucy5wYWdlIHx8IDEpIC0gMSkgKiBvcHRpb25zLmxpbWl0O1xyXG4gICAgICBjb25zdCB0byA9IGZyb20gKyBvcHRpb25zLmxpbWl0IC0gMTtcclxuICAgICAgcXVlcnkgPSBxdWVyeS5yYW5nZShmcm9tLCB0byk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciwgY291bnQgfSA9IGF3YWl0IHF1ZXJ5O1xyXG5cclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcblxyXG4gICAgLy8gRW5zdXJlIHdlIHJldHVybiB2YWxpZCBkYXRhIHN0cnVjdHVyZVxyXG4gICAgY29uc3QgdXNlcnMgPSBBcnJheS5pc0FycmF5KGRhdGEpID8gZGF0YSA6IFtdO1xyXG4gICAgY29uc3QgdG90YWwgPSB0eXBlb2YgY291bnQgPT09IFwibnVtYmVyXCIgPyBjb3VudCA6IDA7XHJcblxyXG4gICAgcmV0dXJuIHsgdXNlcnMsIHRvdGFsIH07XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgY29tcGFyZVBhc3N3b3JkKHBsYWluUGFzc3dvcmQ6IHN0cmluZywgaGFzaGVkUGFzc3dvcmQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIGJjcnlwdC5jb21wYXJlKHBsYWluUGFzc3dvcmQsIGhhc2hlZFBhc3N3b3JkKTtcclxuICB9LFxyXG5cclxuICBhc3luYyBoYXNoUGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZykge1xyXG4gICAgY29uc3Qgc2FsdCA9IGF3YWl0IGJjcnlwdC5nZW5TYWx0KDEyKTtcclxuICAgIHJldHVybiBiY3J5cHQuaGFzaChwYXNzd29yZCwgc2FsdCk7XHJcbiAgfSxcclxufTtcclxuXHJcbi8vIENhbXBhaWduIG9wZXJhdGlvbnNcclxuZXhwb3J0IGNvbnN0IGNhbXBhaWduT3BlcmF0aW9ucyA9IHtcclxuICBhc3luYyBjcmVhdGUoXHJcbiAgICBjYW1wYWlnbkRhdGE6IE9taXQ8Q2FtcGFpZ24sIFwiaWRcIiB8IFwiY3JlYXRlZF9hdFwiIHwgXCJ1cGRhdGVkX2F0XCI+XHJcbiAgKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKTtcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwiY2FtcGFpZ25zXCIpXHJcbiAgICAgIC5pbnNlcnQoW2NhbXBhaWduRGF0YV0pXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGZpbmRCeVVzZXJJZCh1c2VySWQ6IHN0cmluZykge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KCk7XHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbShcImNhbXBhaWduc1wiKVxyXG4gICAgICAuc2VsZWN0KFwiKlwiKVxyXG4gICAgICAuZXEoXCJ1c2VyX2lkXCIsIHVzZXJJZClcclxuICAgICAgLm9yZGVyKFwiY3JlYXRlZF9hdFwiLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgIHJldHVybiBkYXRhIHx8IFtdO1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGZpbmRCeUlkKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICBjb25zb2xlLmxvZyhpZCwgdXNlcklkKTtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJjYW1wYWlnbnNcIilcclxuICAgICAgLnNlbGVjdChcIipcIilcclxuICAgICAgLmVxKFwiaWRcIiwgaWQpXHJcbiAgICAgIC5lcShcInVzZXJfaWRcIiwgdXNlcklkKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgY29uc29sZS5sb2coYGRhdGEgJHtKU09OLnN0cmluZ2lmeShkYXRhKX1gKTtcclxuXHJcbiAgICBpZiAoZXJyb3IgJiYgZXJyb3IuY29kZSAhPT0gXCJQR1JTVDExNlwiKSB0aHJvdyBlcnJvcjtcclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIHVwZGF0ZShpZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxDYW1wYWlnbj4pIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJjYW1wYWlnbnNcIilcclxuICAgICAgLnVwZGF0ZSh1cGRhdGVzKVxyXG4gICAgICAuZXEoXCJpZFwiLCBpZClcclxuICAgICAgLmVxKFwidXNlcl9pZFwiLCB1c2VySWQpXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGRlbGV0ZShpZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZykge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KCk7XHJcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbShcImNhbXBhaWduc1wiKVxyXG4gICAgICAuZGVsZXRlKClcclxuICAgICAgLmVxKFwiaWRcIiwgaWQpXHJcbiAgICAgIC5lcShcInVzZXJfaWRcIiwgdXNlcklkKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG4gIH0sXHJcbn07XHJcblxyXG4vLyBQcm9zcGVjdCBvcGVyYXRpb25zXHJcbmV4cG9ydCBjb25zdCBwcm9zcGVjdE9wZXJhdGlvbnMgPSB7XHJcbiAgYXN5bmMgY3JlYXRlKFxyXG4gICAgcHJvc3BlY3REYXRhOiBPbWl0PFByb3NwZWN0LCBcImlkXCIgfCBcImNyZWF0ZWRfYXRcIiB8IFwidXBkYXRlZF9hdFwiPlxyXG4gICkge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KCk7XHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbShcInByb3NwZWN0c1wiKVxyXG4gICAgICAuaW5zZXJ0KFtwcm9zcGVjdERhdGFdKVxyXG4gICAgICAuc2VsZWN0KClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgICByZXR1cm4gZGF0YTtcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlVc2VySWQoXHJcbiAgICB1c2VySWQ6IHN0cmluZyxcclxuICAgIG9wdGlvbnM/OiB7XHJcbiAgICAgIHBhZ2U/OiBudW1iZXI7XHJcbiAgICAgIGxpbWl0PzogbnVtYmVyO1xyXG4gICAgICBzZWFyY2g/OiBzdHJpbmc7XHJcbiAgICAgIHN0YXR1cz86IHN0cmluZztcclxuICAgICAgY2FtcGFpZ25JZD86IHN0cmluZztcclxuICAgIH1cclxuICApIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpO1xyXG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJwcm9zcGVjdHNcIilcclxuICAgICAgLnNlbGVjdChgKixjYW1wYWlnbnMhaW5uZXIoaWQsIG5hbWUpYCwgeyBjb3VudDogXCJleGFjdFwiIH0pXHJcbiAgICAgIC5lcShcInVzZXJfaWRcIiwgdXNlcklkKTtcclxuXHJcbiAgICBpZiAob3B0aW9ucz8uc2VhcmNoKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkub3IoXHJcbiAgICAgICAgYGxpbmtlZGluX2RhdGEtPj5uYW1lLmlsaWtlLiUke29wdGlvbnMuc2VhcmNofSUsbGlua2VkaW5fZGF0YS0+PmNvbXBhbnkuaWxpa2UuJSR7b3B0aW9ucy5zZWFyY2h9JSxsaW5rZWRpbl9kYXRhLT4+dGl0bGUuaWxpa2UuJSR7b3B0aW9ucy5zZWFyY2h9JWBcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAob3B0aW9ucz8uc3RhdHVzICYmIG9wdGlvbnMuc3RhdHVzICE9PSBcImFsbFwiKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoXCJzdGF0dXNcIiwgb3B0aW9ucy5zdGF0dXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChvcHRpb25zPy5jYW1wYWlnbklkICYmIG9wdGlvbnMuY2FtcGFpZ25JZCAhPT0gXCJhbGxcIikge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKFwiY2FtcGFpZ25faWRcIiwgb3B0aW9ucy5jYW1wYWlnbklkKTtcclxuICAgIH1cclxuXHJcbiAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyKFwiY3JlYXRlZF9hdFwiLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XHJcblxyXG4gICAgaWYgKG9wdGlvbnM/LmxpbWl0KSB7XHJcbiAgICAgIGNvbnN0IGZyb20gPSAoKG9wdGlvbnMucGFnZSB8fCAxKSAtIDEpICogb3B0aW9ucy5saW1pdDtcclxuICAgICAgY29uc3QgdG8gPSBmcm9tICsgb3B0aW9ucy5saW1pdCAtIDE7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkucmFuZ2UoZnJvbSwgdG8pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IsIGNvdW50IH0gPSBhd2FpdCBxdWVyeTtcclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgICByZXR1cm4geyBpdGVtczogZGF0YSB8fCBbXSwgdG90YWw6IGNvdW50ID8/IChkYXRhID8gZGF0YS5sZW5ndGggOiAwKSB9O1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGZpbmRCeUlkKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKTtcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwicHJvc3BlY3RzXCIpXHJcbiAgICAgIC5zZWxlY3QoXHJcbiAgICAgICAgYFxyXG4gICAgICAgICosXHJcbiAgICAgICAgY2FtcGFpZ25zIWlubmVyKGlkLCBuYW1lKVxyXG4gICAgICBgXHJcbiAgICAgIClcclxuICAgICAgLmVxKFwiaWRcIiwgaWQpXHJcbiAgICAgIC5lcShcInVzZXJfaWRcIiwgdXNlcklkKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGVycm9yICYmIGVycm9yLmNvZGUgIT09IFwiUEdSU1QxMTZcIikgdGhyb3cgZXJyb3I7XHJcbiAgICByZXR1cm4gZGF0YTtcclxuICB9LFxyXG5cclxuICBhc3luYyB1cGRhdGUoaWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8UHJvc3BlY3Q+KSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKTtcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwicHJvc3BlY3RzXCIpXHJcbiAgICAgIC51cGRhdGUoeyAuLi51cGRhdGVzLCBsYXN0X3VwZGF0ZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9KVxyXG4gICAgICAuZXEoXCJpZFwiLCBpZClcclxuICAgICAgLmVxKFwidXNlcl9pZFwiLCB1c2VySWQpXHJcbiAgICAgIC5zZWxlY3QoXHJcbiAgICAgICAgYFxyXG4gICAgICAgICosXHJcbiAgICAgICAgY2FtcGFpZ25zIWlubmVyKGlkLCBuYW1lKVxyXG4gICAgICBgXHJcbiAgICAgIClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgICByZXR1cm4gZGF0YTtcclxuICB9LFxyXG5cclxuICBhc3luYyBkZWxldGUoaWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJwcm9zcGVjdHNcIilcclxuICAgICAgLmRlbGV0ZSgpXHJcbiAgICAgIC5lcShcImlkXCIsIGlkKVxyXG4gICAgICAuZXEoXCJ1c2VyX2lkXCIsIHVzZXJJZCk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICB9LFxyXG59O1xyXG5cclxuLy8gTWVzc2FnZSBvcGVyYXRpb25zXHJcbmV4cG9ydCBjb25zdCBtZXNzYWdlT3BlcmF0aW9ucyA9IHtcclxuICBhc3luYyBjcmVhdGUobWVzc2FnZURhdGE6IE9taXQ8TWVzc2FnZSwgXCJpZFwiIHwgXCJjcmVhdGVkX2F0XCIgfCBcInVwZGF0ZWRfYXRcIj4pIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VDbGllbnQoKTtcclxuICAgIFxyXG4gICAgLy8gSWYgcHJvc3BlY3RfaWQgaXMgbnVsbCwganVzdCBpbnNlcnQgd2l0aG91dCBqb2luXHJcbiAgICBpZiAoIW1lc3NhZ2VEYXRhLnByb3NwZWN0X2lkKSB7XHJcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oXCJtZXNzYWdlc1wiKVxyXG4gICAgICAgIC5pbnNlcnQoW21lc3NhZ2VEYXRhXSlcclxuICAgICAgICAuc2VsZWN0KClcclxuICAgICAgICAuc2luZ2xlKCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBtZXNzYWdlIHdpdGhvdXQgcHJvc3BlY3Q6JywgZXJyb3IpO1xyXG4gICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbShcIm1lc3NhZ2VzXCIpXHJcbiAgICAgIC5pbnNlcnQoW21lc3NhZ2VEYXRhXSlcclxuICAgICAgLnNlbGVjdChcclxuICAgICAgICBgXHJcbiAgICAgICAgKixcclxuICAgICAgICBwcm9zcGVjdHMoaWQsIGxpbmtlZGluX2RhdGEsIGNvbnRhY3RfaW5mbylcclxuICAgICAgYFxyXG4gICAgICApXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgbWVzc2FnZSB3aXRoIHByb3NwZWN0OicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGF0YTtcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlVc2VySWQoXHJcbiAgICB1c2VySWQ6IHN0cmluZyxcclxuICAgIG9wdGlvbnM/OiB7XHJcbiAgICAgIGNvbnZlcnNhdGlvbklkPzogc3RyaW5nO1xyXG4gICAgICBwYWdlPzogbnVtYmVyO1xyXG4gICAgICBsaW1pdD86IG51bWJlcjtcclxuICAgICAgcGxhdGZvcm0/OiBzdHJpbmc7XHJcbiAgICB9XHJcbiAgKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQ2xpZW50KCk7XHJcbiAgICBsZXQgcXVlcnkgPSBzdXBhYmFzZVxyXG4gICAgICAuZnJvbShcIm1lc3NhZ2VzXCIpXHJcbiAgICAgIC5zZWxlY3QoXHJcbiAgICAgICAgYFxyXG4gICAgICAgICosXHJcbiAgICAgICAgcHJvc3BlY3RzKGlkLCBsaW5rZWRpbl9kYXRhLCBjb250YWN0X2luZm8pXHJcbiAgICAgIGBcclxuICAgICAgKVxyXG4gICAgICAuZXEoXCJ1c2VyX2lkXCIsIHVzZXJJZCk7XHJcblxyXG4gICAgaWYgKG9wdGlvbnM/LnBsYXRmb3JtKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoXCJwbGF0Zm9ybVwiLCBvcHRpb25zLnBsYXRmb3JtKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAob3B0aW9ucz8uY29udmVyc2F0aW9uSWQpIHtcclxuICAgICAgcXVlcnkgPSBxdWVyeS5lcShcImNvbnZlcnNhdGlvbl9pZFwiLCBvcHRpb25zLmNvbnZlcnNhdGlvbklkKTtcclxuICAgICAgcXVlcnkgPSBxdWVyeS5vcmRlcihcImNyZWF0ZWRfYXRcIiwgeyBhc2NlbmRpbmc6IHRydWUgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyKFwiY3JlYXRlZF9hdFwiLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG9wdGlvbnM/LmxpbWl0KSB7XHJcbiAgICAgIGNvbnN0IGZyb20gPSAoKG9wdGlvbnMucGFnZSB8fCAxKSAtIDEpICogb3B0aW9ucy5saW1pdDtcclxuICAgICAgY29uc3QgdG8gPSBmcm9tICsgb3B0aW9ucy5saW1pdCAtIDE7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkucmFuZ2UoZnJvbSwgdG8pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHF1ZXJ5O1xyXG5cclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgICByZXR1cm4gZGF0YSB8fCBbXTtcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlJZChpZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZykge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJtZXNzYWdlc1wiKVxyXG4gICAgICAuc2VsZWN0KFxyXG4gICAgICAgIGBcclxuICAgICAgICAqLFxyXG4gICAgICAgIHByb3NwZWN0cyFpbm5lcihpZCwgbGlua2VkaW5fZGF0YSlcclxuICAgICAgYFxyXG4gICAgICApXHJcbiAgICAgIC5lcShcImlkXCIsIGlkKVxyXG4gICAgICAuZXEoXCJ1c2VyX2lkXCIsIHVzZXJJZClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChlcnJvciAmJiBlcnJvci5jb2RlICE9PSBcIlBHUlNUMTE2XCIpIHRocm93IGVycm9yO1xyXG4gICAgcmV0dXJuIGRhdGE7XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgdXBkYXRlKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPE1lc3NhZ2U+KSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQ2xpZW50KCk7XHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbShcIm1lc3NhZ2VzXCIpXHJcbiAgICAgIC51cGRhdGUodXBkYXRlcylcclxuICAgICAgLmVxKFwiaWRcIiwgaWQpXHJcbiAgICAgIC5lcShcInVzZXJfaWRcIiwgdXNlcklkKVxyXG4gICAgICAuc2VsZWN0KFxyXG4gICAgICAgIGBcclxuICAgICAgICAqLFxyXG4gICAgICAgIHByb3NwZWN0cyFpbm5lcihpZCwgbGlua2VkaW5fZGF0YSlcclxuICAgICAgYFxyXG4gICAgICApXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG4gICAgcmV0dXJuIGRhdGE7XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgbWFya0FzUmVhZChpZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZykge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oXCJtZXNzYWdlc1wiKVxyXG4gICAgICAudXBkYXRlKHtcclxuICAgICAgICBzdGF0dXM6IFwicmVhZFwiLFxyXG4gICAgICAgIHJlYWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICBhbmFseXRpY3M6IHtcclxuICAgICAgICAgIG9wZW5lZDogdHJ1ZSxcclxuICAgICAgICAgIG9wZW5lZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgfSxcclxuICAgICAgfSlcclxuICAgICAgLmVxKFwiaWRcIiwgaWQpXHJcbiAgICAgIC5lcShcInVzZXJfaWRcIiwgdXNlcklkKVxyXG4gICAgICAuZXEoXCJ0eXBlXCIsIFwicmVjZWl2ZWRcIilcclxuICAgICAgLnNlbGVjdChcclxuICAgICAgICBgXHJcbiAgICAgICAgKixcclxuICAgICAgICBwcm9zcGVjdHMhaW5uZXIoaWQsIGxpbmtlZGluX2RhdGEpXHJcbiAgICAgIGBcclxuICAgICAgKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGZpbmQoZmlsdGVyOiBhbnkpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VDbGllbnQoKTtcclxuICAgIGxldCBxdWVyeSA9IHN1cGFiYXNlLmZyb20oXCJtZXNzYWdlc1wiKS5zZWxlY3QoXCIqXCIpO1xyXG5cclxuICAgIGlmIChmaWx0ZXIudXNlcklkKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoXCJ1c2VyX2lkXCIsIGZpbHRlci51c2VySWQpO1xyXG4gICAgfVxyXG4gICAgaWYgKGZpbHRlci50eXBlKSB7XHJcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoXCJ0eXBlXCIsIGZpbHRlci50eXBlKTtcclxuICAgIH1cclxuICAgIGlmIChmaWx0ZXIucGxhdGZvcm0pIHtcclxuICAgICAgcXVlcnkgPSBxdWVyeS5lcShcInBsYXRmb3JtXCIsIGZpbHRlci5wbGF0Zm9ybSk7XHJcbiAgICB9XHJcbiAgICBpZiAoZmlsdGVyW1wiZW1haWxEYXRhLmZyb21cIl0pIHtcclxuICAgICAgcXVlcnkgPSBxdWVyeS5lcShcImVtYWlsX2RhdGEtPj5mcm9tXCIsIGZpbHRlcltcImVtYWlsRGF0YS5mcm9tXCJdKTtcclxuICAgIH1cclxuXHJcbiAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyKFwiY3JlYXRlZF9hdFwiLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XHJcblxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgcXVlcnk7XHJcbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG4gICAgcmV0dXJuIGRhdGEgfHwgW107XHJcbiAgfSxcclxufTtcclxuXHJcbi8vIFNlYXJjaCBSZXN1bHRzIG9wZXJhdGlvbnNcclxuZXhwb3J0IGNvbnN0IHNlYXJjaFJlc3VsdE9wZXJhdGlvbnMgPSB7XHJcbiAgYXN5bmMgY3JlYXRlKGRhdGE6IE9taXQ8U2VhcmNoUmVzdWx0LCBcImlkXCIgfCBcImNyZWF0ZWRfYXRcIiB8IFwidXBkYXRlZF9hdFwiPikge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KCk7XHJcbiAgICBjb25zdCB7IGRhdGE6IHJlc3VsdCwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwic2VhcmNoX3Jlc3VsdHNcIilcclxuICAgICAgLmluc2VydChbZGF0YV0pXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZmluZEJ5Q2FtcGFpZ25JZChjYW1wYWlnbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW5DbGllbnQoKTtcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwic2VhcmNoX3Jlc3VsdHNcIilcclxuICAgICAgLnNlbGVjdChcIipcIilcclxuICAgICAgLmVxKFwiY2FtcGFpZ25faWRcIiwgY2FtcGFpZ25JZClcclxuICAgICAgLmVxKFwidXNlcl9pZFwiLCB1c2VySWQpXHJcbiAgICAgIC5vcmRlcihcImNyZWF0ZWRfYXRcIiwgeyBhc2NlbmRpbmc6IGZhbHNlIH0pO1xyXG5cclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgICByZXR1cm4gZGF0YSB8fCBbXTtcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlVc2VySWQodXNlcklkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCgpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKFwic2VhcmNoX3Jlc3VsdHNcIilcclxuICAgICAgLnNlbGVjdChcclxuICAgICAgICBgXHJcbiAgICAgICosXHJcbiAgICAgIGNhbXBhaWduX2lkIChpZCwgbmFtZSwgZGVzY3JpcHRpb24sIGNyZWF0ZWRfYXQpXHJcbiAgICBgXHJcbiAgICAgIClcclxuICAgICAgLmVxKFwidXNlcl9pZFwiLCB1c2VySWQpXHJcbiAgICAgIC5vcmRlcihcImNyZWF0ZWRfYXRcIiwgeyBhc2NlbmRpbmc6IGZhbHNlIH0pO1xyXG5cclxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgICByZXR1cm4gZGF0YSB8fCBbXTtcclxuICB9LFxyXG59O1xyXG4iXSwibmFtZXMiOlsiZ2V0U3VwYWJhc2VDbGllbnQiLCJnZXRTdXBhYmFzZUFkbWluQ2xpZW50IiwiYmNyeXB0IiwidXNlck9wZXJhdGlvbnMiLCJjcmVhdGUiLCJ1c2VyRGF0YSIsInN1cGFiYXNlIiwiY2xlYW5Vc2VyRGF0YSIsImVtYWlsIiwidG9Mb3dlckNhc2UiLCJwYXNzd29yZF9oYXNoIiwiZmlyc3RfbmFtZSIsImxhc3RfbmFtZSIsImNvbXBhbnkiLCJyb2xlIiwic3Vic2NyaXB0aW9uIiwicGxhbiIsInN0YXR1cyIsImVtYWlsX3ZlcmlmaWVkIiwidW5kZWZpbmVkIiwib25ib2FyZGluZ19jb21wbGV0ZSIsImlzX2FjdGl2ZSIsImxpbmtlZGluX2FjY291bnRzIiwiZW1haWxfYWNjb3VudHMiLCJhcGlfa2V5cyIsInNldHRpbmdzIiwidGltZXpvbmUiLCJ3b3JraW5nSG91cnMiLCJzdGFydCIsImVuZCIsIndvcmtpbmdEYXlzIiwiYXV0b21hdGlvbiIsImVuYWJsZWQiLCJjb25uZWN0aW9uUmVxdWVzdHMiLCJ3ZWxjb21lTWVzc2FnZXMiLCJmb2xsb3dVcE1lc3NhZ2VzIiwicHJvZmlsZVZpZXdzIiwibm90aWZpY2F0aW9ucyIsIndlYmhvb2siLCJ1c2FnZSIsInRvdGFsQ29ubmVjdGlvbnMiLCJ0b3RhbE1lc3NhZ2VzIiwidG90YWxDYW1wYWlnbnMiLCJ0b3RhbFByb3NwZWN0cyIsImRhdGEiLCJlcnJvciIsImZyb20iLCJpbnNlcnQiLCJzZWxlY3QiLCJzaW5nbGUiLCJjb25zb2xlIiwiRXJyb3IiLCJtZXNzYWdlIiwiZmluZEJ5RW1haWwiLCJlcSIsImNvZGUiLCJmaW5kQnlJZCIsImlkIiwidXBkYXRlIiwidXBkYXRlcyIsImRlbGV0ZSIsImZpbmRBbGwiLCJvcHRpb25zIiwicXVlcnkiLCJjb3VudCIsInNlYXJjaCIsIm9yIiwiaXNBY3RpdmUiLCJvcmRlciIsImFzY2VuZGluZyIsImxpbWl0IiwicGFnZSIsInRvIiwicmFuZ2UiLCJ1c2VycyIsIkFycmF5IiwiaXNBcnJheSIsInRvdGFsIiwiY29tcGFyZVBhc3N3b3JkIiwicGxhaW5QYXNzd29yZCIsImhhc2hlZFBhc3N3b3JkIiwiY29tcGFyZSIsImhhc2hQYXNzd29yZCIsInBhc3N3b3JkIiwic2FsdCIsImdlblNhbHQiLCJoYXNoIiwiY2FtcGFpZ25PcGVyYXRpb25zIiwiY2FtcGFpZ25EYXRhIiwiZmluZEJ5VXNlcklkIiwidXNlcklkIiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsInByb3NwZWN0T3BlcmF0aW9ucyIsInByb3NwZWN0RGF0YSIsImNhbXBhaWduSWQiLCJpdGVtcyIsImxlbmd0aCIsImxhc3RfdXBkYXRlZCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIm1lc3NhZ2VPcGVyYXRpb25zIiwibWVzc2FnZURhdGEiLCJwcm9zcGVjdF9pZCIsInBsYXRmb3JtIiwiY29udmVyc2F0aW9uSWQiLCJtYXJrQXNSZWFkIiwicmVhZF9hdCIsImFuYWx5dGljcyIsIm9wZW5lZCIsIm9wZW5lZEF0IiwiZmluZCIsImZpbHRlciIsInR5cGUiLCJzZWFyY2hSZXN1bHRPcGVyYXRpb25zIiwicmVzdWx0IiwiZmluZEJ5Q2FtcGFpZ25JZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/database.ts\n");

/***/ }),

/***/ "(api)/./lib/middleware/withAuth.ts":
/*!************************************!*\
  !*** ./lib/middleware/withAuth.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   withAdminAuth: () => (/* binding */ withAdminAuth),\n/* harmony export */   withAuth: () => (/* binding */ withAuth)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../supabase */ \"(api)/./lib/supabase.ts\");\n\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key\";\nfunction withAuth(handler) {\n    return async (req, res)=>{\n        try {\n            const token = req.headers.authorization?.replace(\"Bearer \", \"\");\n            if (!token) {\n                return res.status(401).json({\n                    success: false,\n                    error: \"Access denied. No token provided.\"\n                });\n            }\n            let decoded;\n            try {\n                decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, JWT_SECRET);\n            } catch (jwtError) {\n                console.error(\"JWT verification failed:\", jwtError);\n                return res.status(401).json({\n                    success: false,\n                    error: \"Invalid or expired token.\"\n                });\n            }\n            const supabase = (0,_supabase__WEBPACK_IMPORTED_MODULE_1__.getSupabaseAdminClient)();\n            const { data: user, error: userError } = await supabase.from(\"users\").select(\"*\").eq(\"id\", decoded.id).single();\n            if (userError || !user) {\n                return res.status(401).json({\n                    success: false,\n                    error: \"Invalid token. User not found.\"\n                });\n            }\n            if (!user.is_active) {\n                return res.status(401).json({\n                    success: false,\n                    error: \"Account is deactivated.\"\n                });\n            }\n            req.user = user;\n            return handler(req, res);\n        } catch (error) {\n            console.error(\"Auth middleware error:\", error);\n            return res.status(500).json({\n                success: false,\n                error: \"Server error during authentication.\"\n            });\n        }\n    };\n}\nfunction withAdminAuth(handler) {\n    return withAuth(async (req, res)=>{\n        if (req.user?.role !== \"admin\") {\n            return res.status(403).json({\n                success: false,\n                error: \"Access denied. Admin privileges required.\"\n            });\n        }\n        return handler(req, res);\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvbWlkZGxld2FyZS93aXRoQXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUErQjtBQUVzQjtBQUVyRCxNQUFNRSxhQUFhQyxRQUFRQyxHQUFHLENBQUNGLFVBQVUsSUFBSTtBQVd0QyxTQUFTRyxTQUFTQyxPQUE2QjtJQUNwRCxPQUFPLE9BQU9DLEtBQTJCQztRQUN2QyxJQUFJO1lBQ0YsTUFBTUMsUUFBUUYsSUFBSUcsT0FBTyxDQUFDQyxhQUFhLEVBQUVDLFFBQVEsV0FBVztZQUU1RCxJQUFJLENBQUNILE9BQU87Z0JBQ1YsT0FBT0QsSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFDMUJDLFNBQVM7b0JBQ1RDLE9BQU87Z0JBQ1Q7WUFDRjtZQUVBLElBQUlDO1lBQ0osSUFBSTtnQkFDRkEsVUFBVWpCLDBEQUFVLENBQUNTLE9BQU9QO1lBQzlCLEVBQUUsT0FBT2lCLFVBQVU7Z0JBQ2pCQyxRQUFRSixLQUFLLENBQUMsNEJBQTRCRztnQkFDMUMsT0FBT1gsSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFDMUJDLFNBQVM7b0JBQ1RDLE9BQU87Z0JBQ1Q7WUFDRjtZQUVBLE1BQU1LLFdBQVdwQixpRUFBc0JBO1lBQ3ZDLE1BQU0sRUFBRXFCLE1BQU1DLElBQUksRUFBRVAsT0FBT1EsU0FBUyxFQUFFLEdBQUcsTUFBTUgsU0FDNUNJLElBQUksQ0FBQyxTQUNMQyxNQUFNLENBQUMsS0FDUEMsRUFBRSxDQUFDLE1BQU1WLFFBQVFXLEVBQUUsRUFDbkJDLE1BQU07WUFFVCxJQUFJTCxhQUFhLENBQUNELE1BQU07Z0JBQ3RCLE9BQU9mLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQzFCQyxTQUFTO29CQUNUQyxPQUFPO2dCQUNUO1lBQ0Y7WUFFQSxJQUFJLENBQUNPLEtBQUtPLFNBQVMsRUFBRTtnQkFDbkIsT0FBT3RCLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQzFCQyxTQUFTO29CQUNUQyxPQUFPO2dCQUNUO1lBQ0Y7WUFFQVQsSUFBSWdCLElBQUksR0FBR0E7WUFDWCxPQUFPakIsUUFBUUMsS0FBS0M7UUFDdEIsRUFBRSxPQUFPUSxPQUFPO1lBQ2RJLFFBQVFKLEtBQUssQ0FBQywwQkFBMEJBO1lBRXhDLE9BQU9SLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQzFCQyxTQUFTO2dCQUNUQyxPQUFPO1lBQ1Q7UUFDRjtJQUNGO0FBQ0Y7QUFFTyxTQUFTZSxjQUFjekIsT0FBNkI7SUFDekQsT0FBT0QsU0FBUyxPQUFPRSxLQUEyQkM7UUFDaEQsSUFBSUQsSUFBSWdCLElBQUksRUFBRVMsU0FBUyxTQUFTO1lBQzlCLE9BQU94QixJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUMxQkMsU0FBUztnQkFDVEMsT0FBTztZQUNUO1FBQ0Y7UUFFQSxPQUFPVixRQUFRQyxLQUFLQztJQUN0QjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbHluY2JvdC1uZXh0anMvLi9saWIvbWlkZGxld2FyZS93aXRoQXV0aC50cz9lMTIxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcclxuaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xyXG5pbXBvcnQgeyBnZXRTdXBhYmFzZUFkbWluQ2xpZW50IH0gZnJvbSAnLi4vc3VwYWJhc2UnO1xyXG5cclxuY29uc3QgSldUX1NFQ1JFVCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgfHwgJ3lvdXItc2VjcmV0LWtleSc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEF1dGhlbnRpY2F0ZWRSZXF1ZXN0IGV4dGVuZHMgTmV4dEFwaVJlcXVlc3Qge1xyXG4gIHVzZXI/OiBhbnk7XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIEF1dGhlbnRpY2F0ZWRIYW5kbGVyID0gKFxyXG4gIHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsXHJcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2VcclxuKSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZDtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB3aXRoQXV0aChoYW5kbGVyOiBBdXRoZW50aWNhdGVkSGFuZGxlcikge1xyXG4gIHJldHVybiBhc3luYyAocmVxOiBBdXRoZW50aWNhdGVkUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbj8ucmVwbGFjZSgnQmVhcmVyICcsICcnKTtcclxuICAgICAgXHJcbiAgICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdBY2Nlc3MgZGVuaWVkLiBObyB0b2tlbiBwcm92aWRlZC4nIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgZGVjb2RlZDtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVCkgYXMgYW55O1xyXG4gICAgICB9IGNhdGNoIChqd3RFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0pXVCB2ZXJpZmljYXRpb24gZmFpbGVkOicsIGp3dEVycm9yKTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIG9yIGV4cGlyZWQgdG9rZW4uJyBcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KCk7XHJcbiAgICAgIGNvbnN0IHsgZGF0YTogdXNlciwgZXJyb3I6IHVzZXJFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgndXNlcnMnKVxyXG4gICAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAgIC5lcSgnaWQnLCBkZWNvZGVkLmlkKVxyXG4gICAgICAgIC5zaW5nbGUoKTtcclxuICAgICAgXHJcbiAgICAgIGlmICh1c2VyRXJyb3IgfHwgIXVzZXIpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHRva2VuLiBVc2VyIG5vdCBmb3VuZC4nIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXVzZXIuaXNfYWN0aXZlKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgXHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIGVycm9yOiAnQWNjb3VudCBpcyBkZWFjdGl2YXRlZC4nIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXEudXNlciA9IHVzZXI7XHJcbiAgICAgIHJldHVybiBoYW5kbGVyKHJlcSwgcmVzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dGggbWlkZGxld2FyZSBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ1NlcnZlciBlcnJvciBkdXJpbmcgYXV0aGVudGljYXRpb24uJyBcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhBZG1pbkF1dGgoaGFuZGxlcjogQXV0aGVudGljYXRlZEhhbmRsZXIpIHtcclxuICByZXR1cm4gd2l0aEF1dGgoYXN5bmMgKHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiB7XHJcbiAgICBpZiAocmVxLnVzZXI/LnJvbGUgIT09ICdhZG1pbicpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdBY2Nlc3MgZGVuaWVkLiBBZG1pbiBwcml2aWxlZ2VzIHJlcXVpcmVkLicgXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gaGFuZGxlcihyZXEsIHJlcyk7XHJcbiAgfSk7XHJcbn0iXSwibmFtZXMiOlsiand0IiwiZ2V0U3VwYWJhc2VBZG1pbkNsaWVudCIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52Iiwid2l0aEF1dGgiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwidG9rZW4iLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInJlcGxhY2UiLCJzdGF0dXMiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwiZGVjb2RlZCIsInZlcmlmeSIsImp3dEVycm9yIiwiY29uc29sZSIsInN1cGFiYXNlIiwiZGF0YSIsInVzZXIiLCJ1c2VyRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsInNpbmdsZSIsImlzX2FjdGl2ZSIsIndpdGhBZG1pbkF1dGgiLCJyb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/middleware/withAuth.ts\n");

/***/ }),

/***/ "(api)/./lib/services/emailService.ts":
/*!**************************************!*\
  !*** ./lib/services/emailService.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nclass EmailService {\n    async sendEmail(emailAccount, options) {\n        const nodemailer = __webpack_require__(/*! nodemailer */ \"nodemailer\");\n        let transportConfig;\n        console.log(`emailAccount ${JSON.stringify(emailAccount)}`);\n        // Configure based on provider\n        if (emailAccount.smtpSettings) {\n            // Custom SMTP\n            transportConfig = {\n                host: emailAccount.smtpSettings.host,\n                port: emailAccount.smtpSettings.port,\n                secure: emailAccount.smtpSettings.secure,\n                auth: {\n                    user: emailAccount.email,\n                    pass: emailAccount.encryptedPassword\n                }\n            };\n        } else if (emailAccount.provider === \"gmail\") {\n            // Gmail\n            transportConfig = {\n                service: \"gmail\",\n                auth: {\n                    user: emailAccount.email,\n                    pass: emailAccount.encryptedPassword\n                }\n            };\n        } else if (emailAccount.provider === \"outlook\") {\n            // Outlook\n            transportConfig = {\n                host: \"smtp-mail.outlook.com\",\n                port: 587,\n                secure: false,\n                auth: {\n                    user: emailAccount.email,\n                    pass: emailAccount.encryptedPassword\n                }\n            };\n        }\n        const transporter = nodemailer.createTransport(transportConfig);\n        const mailOptions = {\n            from: options.from || emailAccount.email,\n            to: Array.isArray(options.to) ? options.to.join(\", \") : options.to,\n            cc: options.cc?.join(\", \"),\n            bcc: options.bcc?.join(\", \"),\n            subject: options.subject,\n            text: options.text,\n            html: options.html,\n            inReplyTo: options.inReplyTo,\n            references: options.references?.join(\" \"),\n            attachments: options.attachments\n        };\n        const result = await transporter.sendMail(mailOptions);\n        return result.messageId;\n    }\n    async testConnection(emailAccount) {\n        try {\n            const nodemailer = __webpack_require__(/*! nodemailer */ \"nodemailer\");\n            let transportConfig;\n            if (emailAccount.smtpSettings) {\n                transportConfig = {\n                    host: emailAccount.smtpSettings.host,\n                    port: emailAccount.smtpSettings.port,\n                    secure: emailAccount.smtpSettings.secure,\n                    auth: {\n                        user: emailAccount.email,\n                        pass: emailAccount.encryptedPassword\n                    }\n                };\n            } else if (emailAccount.provider === \"gmail\") {\n                transportConfig = {\n                    service: \"gmail\",\n                    auth: {\n                        user: emailAccount.email,\n                        pass: emailAccount.encryptedPassword\n                    }\n                };\n            } else if (emailAccount.provider === \"outlook\") {\n                transportConfig = {\n                    host: \"smtp-mail.outlook.com\",\n                    port: 587,\n                    secure: false,\n                    auth: {\n                        user: emailAccount.email,\n                        pass: emailAccount.encryptedPassword\n                    }\n                };\n            }\n            const transporter = nodemailer.createTransport(transportConfig);\n            await transporter.verify();\n            return true;\n        } catch (error) {\n            console.error(\"Email connection test failed:\", error);\n            return false;\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (EmailService);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSWpCLGFBQWFrQixRQUFRLEtBQUssV0FBVztnQkFDOUNkLGtCQUFrQjtvQkFDaEJNLE1BQU07b0JBQ05DLE1BQU07b0JBQ05DLFFBQVE7b0JBQ1JDLE1BQU07d0JBQ0pDLE1BQU1kLGFBQWFlLEtBQUs7d0JBQ3hCQyxNQUFNaEIsYUFBYWlCLGlCQUFpQjtvQkFDdEM7Z0JBQ0Y7WUFDRjtZQUVBLE1BQU1HLGNBQWNsQixXQUFXbUIsZUFBZSxDQUFDakI7WUFDL0MsTUFBTWdCLFlBQVlvQixNQUFNO1lBQ3hCLE9BQU87UUFDVCxFQUFFLE9BQU9DLE9BQU87WUFDZHBDLFFBQVFvQyxLQUFLLENBQUMsaUNBQWlDQTtZQUMvQyxPQUFPO1FBQ1Q7SUFDRjtBQUNGO0FBRUEsaUVBQWUzQyxZQUFZQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbHluY2JvdC1uZXh0anMvLi9saWIvc2VydmljZXMvZW1haWxTZXJ2aWNlLnRzP2QzOTgiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGludGVyZmFjZSBFbWFpbEFjY291bnQge1xyXG4gIGVtYWlsOiBzdHJpbmc7XHJcbiAgZW5jcnlwdGVkUGFzc3dvcmQ/OiBzdHJpbmc7XHJcbiAgcHJvdmlkZXI6IFwiZ21haWxcIiB8IFwib3V0bG9va1wiIHwgXCJzbXRwXCI7XHJcbiAgc210cFNldHRpbmdzPzoge1xyXG4gICAgaG9zdDogc3RyaW5nO1xyXG4gICAgcG9ydDogbnVtYmVyO1xyXG4gICAgc2VjdXJlOiBib29sZWFuO1xyXG4gIH07XHJcbiAgaW1hcFNldHRpbmdzPzoge1xyXG4gICAgaG9zdDogc3RyaW5nO1xyXG4gICAgcG9ydDogbnVtYmVyO1xyXG4gICAgc2VjdXJlOiBib29sZWFuO1xyXG4gIH07XHJcbiAgaXNBY3RpdmU6IGJvb2xlYW47XHJcbiAgbGFzdFN5bmNBdD86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBFbWFpbE1lc3NhZ2Uge1xyXG4gIG1lc3NhZ2VJZDogc3RyaW5nO1xyXG4gIHRocmVhZElkPzogc3RyaW5nO1xyXG4gIGZyb206IHN0cmluZztcclxuICB0bzogc3RyaW5nW107XHJcbiAgY2M/OiBzdHJpbmdbXTtcclxuICBiY2M/OiBzdHJpbmdbXTtcclxuICBzdWJqZWN0OiBzdHJpbmc7XHJcbiAgY29udGVudDogc3RyaW5nO1xyXG4gIGh0bWxDb250ZW50Pzogc3RyaW5nO1xyXG4gIGRhdGU6IERhdGU7XHJcbiAgaW5SZXBseVRvPzogc3RyaW5nO1xyXG4gIHJlZmVyZW5jZXM/OiBzdHJpbmdbXTtcclxuICBhdHRhY2htZW50cz86IEFycmF5PHtcclxuICAgIGZpbGVuYW1lOiBzdHJpbmc7XHJcbiAgICBjb250ZW50VHlwZTogc3RyaW5nO1xyXG4gICAgc2l6ZTogbnVtYmVyO1xyXG4gICAgY29udGVudDogQnVmZmVyO1xyXG4gIH0+O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNlbmRFbWFpbE9wdGlvbnMge1xyXG4gIHRvOiBzdHJpbmcgfCBzdHJpbmdbXTtcclxuICBmcm9tOiBzdHJpbmc7XHJcbiAgc3ViamVjdDogc3RyaW5nO1xyXG4gIHRleHQ/OiBzdHJpbmc7XHJcbiAgaHRtbD86IHN0cmluZztcclxuICBjYz86IHN0cmluZ1tdO1xyXG4gIGJjYz86IHN0cmluZ1tdO1xyXG4gIGluUmVwbHlUbz86IHN0cmluZztcclxuICByZWZlcmVuY2VzPzogc3RyaW5nW107XHJcbiAgYXR0YWNobWVudHM/OiBBcnJheTx7XHJcbiAgICBmaWxlbmFtZTogc3RyaW5nO1xyXG4gICAgY29udGVudDogQnVmZmVyIHwgc3RyaW5nO1xyXG4gICAgY29udGVudFR5cGU/OiBzdHJpbmc7XHJcbiAgfT47XHJcbn1cclxuXHJcbmNsYXNzIEVtYWlsU2VydmljZSB7XHJcbiAgYXN5bmMgc2VuZEVtYWlsKFxyXG4gICAgZW1haWxBY2NvdW50OiBFbWFpbEFjY291bnQsXHJcbiAgICBvcHRpb25zOiBTZW5kRW1haWxPcHRpb25zXHJcbiAgKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIGNvbnN0IG5vZGVtYWlsZXIgPSByZXF1aXJlKCdub2RlbWFpbGVyJyk7XHJcbiAgICBsZXQgdHJhbnNwb3J0Q29uZmlnOiBhbnk7XHJcblxyXG4gICAgY29uc29sZS5sb2coYGVtYWlsQWNjb3VudCAke0pTT04uc3RyaW5naWZ5KGVtYWlsQWNjb3VudCl9YClcclxuXHJcbiAgICAvLyBDb25maWd1cmUgYmFzZWQgb24gcHJvdmlkZXJcclxuICAgIGlmIChlbWFpbEFjY291bnQuc210cFNldHRpbmdzKSB7XHJcbiAgICAgIC8vIEN1c3RvbSBTTVRQXHJcbiAgICAgIHRyYW5zcG9ydENvbmZpZyA9IHtcclxuICAgICAgICBob3N0OiBlbWFpbEFjY291bnQuc210cFNldHRpbmdzLmhvc3QsXHJcbiAgICAgICAgcG9ydDogZW1haWxBY2NvdW50LnNtdHBTZXR0aW5ncy5wb3J0LFxyXG4gICAgICAgIHNlY3VyZTogZW1haWxBY2NvdW50LnNtdHBTZXR0aW5ncy5zZWN1cmUsXHJcbiAgICAgICAgYXV0aDoge1xyXG4gICAgICAgICAgdXNlcjogZW1haWxBY2NvdW50LmVtYWlsLFxyXG4gICAgICAgICAgcGFzczogZW1haWxBY2NvdW50LmVuY3J5cHRlZFBhc3N3b3JkXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfSBlbHNlIGlmIChlbWFpbEFjY291bnQucHJvdmlkZXIgPT09ICdnbWFpbCcpIHtcclxuICAgICAgLy8gR21haWxcclxuICAgICAgdHJhbnNwb3J0Q29uZmlnID0ge1xyXG4gICAgICAgIHNlcnZpY2U6ICdnbWFpbCcsXHJcbiAgICAgICAgYXV0aDoge1xyXG4gICAgICAgICAgdXNlcjogZW1haWxBY2NvdW50LmVtYWlsLFxyXG4gICAgICAgICAgcGFzczogZW1haWxBY2NvdW50LmVuY3J5cHRlZFBhc3N3b3JkXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfSBlbHNlIGlmIChlbWFpbEFjY291bnQucHJvdmlkZXIgPT09ICdvdXRsb29rJykge1xyXG4gICAgICAvLyBPdXRsb29rXHJcbiAgICAgIHRyYW5zcG9ydENvbmZpZyA9IHtcclxuICAgICAgICBob3N0OiAnc210cC1tYWlsLm91dGxvb2suY29tJyxcclxuICAgICAgICBwb3J0OiA1ODcsXHJcbiAgICAgICAgc2VjdXJlOiBmYWxzZSxcclxuICAgICAgICBhdXRoOiB7XHJcbiAgICAgICAgICB1c2VyOiBlbWFpbEFjY291bnQuZW1haWwsXHJcbiAgICAgICAgICBwYXNzOiBlbWFpbEFjY291bnQuZW5jcnlwdGVkUGFzc3dvcmRcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh0cmFuc3BvcnRDb25maWcpO1xyXG5cclxuICAgIGNvbnN0IG1haWxPcHRpb25zID0ge1xyXG4gICAgICBmcm9tOiBvcHRpb25zLmZyb20gfHwgZW1haWxBY2NvdW50LmVtYWlsLFxyXG4gICAgICB0bzogQXJyYXkuaXNBcnJheShvcHRpb25zLnRvKSA/IG9wdGlvbnMudG8uam9pbihcIiwgXCIpIDogb3B0aW9ucy50byxcclxuICAgICAgY2M6IG9wdGlvbnMuY2M/LmpvaW4oXCIsIFwiKSxcclxuICAgICAgYmNjOiBvcHRpb25zLmJjYz8uam9pbihcIiwgXCIpLFxyXG4gICAgICBzdWJqZWN0OiBvcHRpb25zLnN1YmplY3QsXHJcbiAgICAgIHRleHQ6IG9wdGlvbnMudGV4dCxcclxuICAgICAgaHRtbDogb3B0aW9ucy5odG1sLFxyXG4gICAgICBpblJlcGx5VG86IG9wdGlvbnMuaW5SZXBseVRvLFxyXG4gICAgICByZWZlcmVuY2VzOiBvcHRpb25zLnJlZmVyZW5jZXM/LmpvaW4oXCIgXCIpLFxyXG4gICAgICBhdHRhY2htZW50czogb3B0aW9ucy5hdHRhY2htZW50cyxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwobWFpbE9wdGlvbnMpO1xyXG4gICAgcmV0dXJuIHJlc3VsdC5tZXNzYWdlSWQ7XHJcbiAgfVxyXG5cclxuICBhc3luYyB0ZXN0Q29ubmVjdGlvbihlbWFpbEFjY291bnQ6IEVtYWlsQWNjb3VudCk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3Qgbm9kZW1haWxlciA9IHJlcXVpcmUoJ25vZGVtYWlsZXInKTtcclxuICAgICAgbGV0IHRyYW5zcG9ydENvbmZpZzogYW55O1xyXG5cclxuICAgICAgaWYgKGVtYWlsQWNjb3VudC5zbXRwU2V0dGluZ3MpIHtcclxuICAgICAgICB0cmFuc3BvcnRDb25maWcgPSB7XHJcbiAgICAgICAgICBob3N0OiBlbWFpbEFjY291bnQuc210cFNldHRpbmdzLmhvc3QsXHJcbiAgICAgICAgICBwb3J0OiBlbWFpbEFjY291bnQuc210cFNldHRpbmdzLnBvcnQsXHJcbiAgICAgICAgICBzZWN1cmU6IGVtYWlsQWNjb3VudC5zbXRwU2V0dGluZ3Muc2VjdXJlLFxyXG4gICAgICAgICAgYXV0aDoge1xyXG4gICAgICAgICAgICB1c2VyOiBlbWFpbEFjY291bnQuZW1haWwsXHJcbiAgICAgICAgICAgIHBhc3M6IGVtYWlsQWNjb3VudC5lbmNyeXB0ZWRQYXNzd29yZFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0gZWxzZSBpZiAoZW1haWxBY2NvdW50LnByb3ZpZGVyID09PSAnZ21haWwnKSB7XHJcbiAgICAgICAgdHJhbnNwb3J0Q29uZmlnID0ge1xyXG4gICAgICAgICAgc2VydmljZTogJ2dtYWlsJyxcclxuICAgICAgICAgIGF1dGg6IHtcclxuICAgICAgICAgICAgdXNlcjogZW1haWxBY2NvdW50LmVtYWlsLFxyXG4gICAgICAgICAgICBwYXNzOiBlbWFpbEFjY291bnQuZW5jcnlwdGVkUGFzc3dvcmRcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICB9IGVsc2UgaWYgKGVtYWlsQWNjb3VudC5wcm92aWRlciA9PT0gJ291dGxvb2snKSB7XHJcbiAgICAgICAgdHJhbnNwb3J0Q29uZmlnID0ge1xyXG4gICAgICAgICAgaG9zdDogJ3NtdHAtbWFpbC5vdXRsb29rLmNvbScsXHJcbiAgICAgICAgICBwb3J0OiA1ODcsXHJcbiAgICAgICAgICBzZWN1cmU6IGZhbHNlLFxyXG4gICAgICAgICAgYXV0aDoge1xyXG4gICAgICAgICAgICB1c2VyOiBlbWFpbEFjY291bnQuZW1haWwsXHJcbiAgICAgICAgICAgIHBhc3M6IGVtYWlsQWNjb3VudC5lbmNyeXB0ZWRQYXNzd29yZFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHRyYW5zcG9ydGVyID0gbm9kZW1haWxlci5jcmVhdGVUcmFuc3BvcnQodHJhbnNwb3J0Q29uZmlnKTtcclxuICAgICAgYXdhaXQgdHJhbnNwb3J0ZXIudmVyaWZ5KCk7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVtYWlsIGNvbm5lY3Rpb24gdGVzdCBmYWlsZWQ6XCIsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRW1haWxTZXJ2aWNlO1xyXG4iXSwibmFtZXMiOlsiRW1haWxTZXJ2aWNlIiwic2VuZEVtYWlsIiwiZW1haWxBY2NvdW50Iiwib3B0aW9ucyIsIm5vZGVtYWlsZXIiLCJyZXF1aXJlIiwidHJhbnNwb3J0Q29uZmlnIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJzbXRwU2V0dGluZ3MiLCJob3N0IiwicG9ydCIsInNlY3VyZSIsImF1dGgiLCJ1c2VyIiwiZW1haWwiLCJwYXNzIiwiZW5jcnlwdGVkUGFzc3dvcmQiLCJwcm92aWRlciIsInNlcnZpY2UiLCJ0cmFuc3BvcnRlciIsImNyZWF0ZVRyYW5zcG9ydCIsIm1haWxPcHRpb25zIiwiZnJvbSIsInRvIiwiQXJyYXkiLCJpc0FycmF5Iiwiam9pbiIsImNjIiwiYmNjIiwic3ViamVjdCIsInRleHQiLCJodG1sIiwiaW5SZXBseVRvIiwicmVmZXJlbmNlcyIsImF0dGFjaG1lbnRzIiwicmVzdWx0Iiwic2VuZE1haWwiLCJtZXNzYWdlSWQiLCJ0ZXN0Q29ubmVjdGlvbiIsInZlcmlmeSIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/services/emailService.ts\n");

/***/ }),

/***/ "(api)/./lib/supabase.ts":
/*!*************************!*\
  !*** ./lib/supabase.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createClient: () => (/* binding */ getSupabaseClient),\n/* harmony export */   getSupabaseAdminClient: () => (/* binding */ getSupabaseAdminClient),\n/* harmony export */   getSupabaseClient: () => (/* binding */ getSupabaseClient),\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n\n// Client instances (lazy initialization)\nlet _supabase = null;\nlet _supabaseAdmin = null;\nfunction getSupabaseClient() {\n    if (!_supabase) {\n        const supabaseUrl = \"https://djqtqxnvgjjeeazwnyqn.supabase.co\";\n        const supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRqcXRxeG52Z2pqZWVhendueXFuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NjM4OTUsImV4cCI6MjA3NzEzOTg5NX0.zQZax1gQYZSUc30y5iGscT7J9wjVQQCZODuUrc6hPzw\";\n        if (!supabaseUrl || !supabaseAnonKey) {\n            console.warn(\"Supabase environment variables not found. Please configure Supabase integration.\");\n            // Return a mock client that won't cause errors\n            return {\n                from: ()=>({\n                        select: ()=>Promise.resolve({\n                                data: [],\n                                error: null\n                            }),\n                        insert: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        update: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        delete: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            })\n                    })\n            };\n        }\n        _supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n    }\n    return _supabase;\n}\nfunction getSupabaseAdminClient() {\n    if (!_supabaseAdmin) {\n        const supabaseUrl = \"https://djqtqxnvgjjeeazwnyqn.supabase.co\";\n        const supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n        if (!supabaseUrl || !supabaseServiceRoleKey) {\n            console.warn(\"Supabase admin environment variables not found. Please configure Supabase integration.\");\n            // Return a mock client that won't cause errors\n            return {\n                from: ()=>({\n                        select: ()=>Promise.resolve({\n                                data: [],\n                                error: null\n                            }),\n                        insert: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        update: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            }),\n                        delete: ()=>Promise.resolve({\n                                data: null,\n                                error: {\n                                    message: \"Supabase not configured\"\n                                }\n                            })\n                    })\n            };\n        }\n        _supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceRoleKey);\n    }\n    return _supabaseAdmin;\n}\n// Export lazy getters for backward compatibility\nconst supabase = new Proxy({}, {\n    get (target, prop) {\n        return getSupabaseClient()[prop];\n    }\n});\nconst supabaseAdmin = new Proxy({}, {\n    get (target, prop) {\n        return getSupabaseAdminClient()[prop];\n    }\n});\n// Export the client directly for compatibility with utils/supabase.ts\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvc3VwYWJhc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFxRDtBQUdyRCx5Q0FBeUM7QUFDekMsSUFBSUMsWUFBbUM7QUFDdkMsSUFBSUMsaUJBQXdDO0FBRXJDLFNBQVNDO0lBQ2QsSUFBSSxDQUFDRixXQUFXO1FBQ2QsTUFBTUcsY0FBY0MsMENBQW9DO1FBQ3hELE1BQU1HLGtCQUFrQkgsa05BQXlDO1FBRWpFLElBQUksQ0FBQ0QsZUFBZSxDQUFDSSxpQkFBaUI7WUFDcENFLFFBQVFDLElBQUksQ0FBQztZQUNiLCtDQUErQztZQUMvQyxPQUFPO2dCQUNMQyxNQUFNLElBQU87d0JBQ1hDLFFBQVEsSUFBTUMsUUFBUUMsT0FBTyxDQUFDO2dDQUFFQyxNQUFNLEVBQUU7Z0NBQUVDLE9BQU87NEJBQUs7d0JBQ3REQyxRQUFRLElBQU1KLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGQyxRQUFRLElBQU1OLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGRSxRQUFRLElBQU1QLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7b0JBQzVGO1lBQ0Y7UUFDRjtRQUVBbEIsWUFBWUQsbUVBQVlBLENBQUNJLGFBQWFJO0lBQ3hDO0lBRUEsT0FBT1A7QUFDVDtBQUVPLFNBQVNxQjtJQUNkLElBQUksQ0FBQ3BCLGdCQUFnQjtRQUNuQixNQUFNRSxjQUFjQywwQ0FBb0M7UUFDeEQsTUFBTWtCLHlCQUF5QmxCLFFBQVFDLEdBQUcsQ0FBQ2tCLHlCQUF5QjtRQUVwRSxJQUFJLENBQUNwQixlQUFlLENBQUNtQix3QkFBd0I7WUFDM0NiLFFBQVFDLElBQUksQ0FBQztZQUNiLCtDQUErQztZQUMvQyxPQUFPO2dCQUNMQyxNQUFNLElBQU87d0JBQ1hDLFFBQVEsSUFBTUMsUUFBUUMsT0FBTyxDQUFDO2dDQUFFQyxNQUFNLEVBQUU7Z0NBQUVDLE9BQU87NEJBQUs7d0JBQ3REQyxRQUFRLElBQU1KLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGQyxRQUFRLElBQU1OLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7d0JBQzFGRSxRQUFRLElBQU1QLFFBQVFDLE9BQU8sQ0FBQztnQ0FBRUMsTUFBTTtnQ0FBTUMsT0FBTztvQ0FBRUUsU0FBUztnQ0FBMEI7NEJBQUU7b0JBQzVGO1lBQ0Y7UUFDRjtRQUVBakIsaUJBQWlCRixtRUFBWUEsQ0FBQ0ksYUFBYW1CO0lBQzdDO0lBRUEsT0FBT3JCO0FBQ1Q7QUFFQSxpREFBaUQ7QUFDMUMsTUFBTXVCLFdBQVcsSUFBSUMsTUFBTSxDQUFDLEdBQXFCO0lBQ3REQyxLQUFJQyxNQUFNLEVBQUVDLElBQUk7UUFDZCxPQUFPMUIsbUJBQW1CLENBQUMwQixLQUE2QjtJQUMxRDtBQUNGLEdBQUc7QUFFSSxNQUFNQyxnQkFBZ0IsSUFBSUosTUFBTSxDQUFDLEdBQXFCO0lBQzNEQyxLQUFJQyxNQUFNLEVBQUVDLElBQUk7UUFDZCxPQUFPUCx3QkFBd0IsQ0FBQ08sS0FBNkI7SUFDL0Q7QUFDRixHQUFHO0FBRUgsc0VBQXNFO0FBQ3pCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbHluY2JvdC1uZXh0anMvLi9saWIvc3VwYWJhc2UudHM/Yzk5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xyXG5pbXBvcnQgdHlwZSB7IFN1cGFiYXNlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcclxuXHJcbi8vIENsaWVudCBpbnN0YW5jZXMgKGxhenkgaW5pdGlhbGl6YXRpb24pXHJcbmxldCBfc3VwYWJhc2U6IFN1cGFiYXNlQ2xpZW50IHwgbnVsbCA9IG51bGw7XHJcbmxldCBfc3VwYWJhc2VBZG1pbjogU3VwYWJhc2VDbGllbnQgfCBudWxsID0gbnVsbDtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTdXBhYmFzZUNsaWVudCgpOiBTdXBhYmFzZUNsaWVudCB7XHJcbiAgaWYgKCFfc3VwYWJhc2UpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xyXG4gICAgY29uc3Qgc3VwYWJhc2VBbm9uS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVk7XHJcblxyXG4gICAgaWYgKCFzdXBhYmFzZVVybCB8fCAhc3VwYWJhc2VBbm9uS2V5KSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignU3VwYWJhc2UgZW52aXJvbm1lbnQgdmFyaWFibGVzIG5vdCBmb3VuZC4gUGxlYXNlIGNvbmZpZ3VyZSBTdXBhYmFzZSBpbnRlZ3JhdGlvbi4nKTtcclxuICAgICAgLy8gUmV0dXJuIGEgbW9jayBjbGllbnQgdGhhdCB3b24ndCBjYXVzZSBlcnJvcnNcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBmcm9tOiAoKSA9PiAoe1xyXG4gICAgICAgICAgc2VsZWN0OiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBbXSwgZXJyb3I6IG51bGwgfSksXHJcbiAgICAgICAgICBpbnNlcnQ6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IG51bGwsIGVycm9yOiB7IG1lc3NhZ2U6ICdTdXBhYmFzZSBub3QgY29uZmlndXJlZCcgfSB9KSxcclxuICAgICAgICAgIHVwZGF0ZTogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogbnVsbCwgZXJyb3I6IHsgbWVzc2FnZTogJ1N1cGFiYXNlIG5vdCBjb25maWd1cmVkJyB9IH0pLFxyXG4gICAgICAgICAgZGVsZXRlOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBudWxsLCBlcnJvcjogeyBtZXNzYWdlOiAnU3VwYWJhc2Ugbm90IGNvbmZpZ3VyZWQnIH0gfSlcclxuICAgICAgICB9KVxyXG4gICAgICB9IGFzIGFueTtcclxuICAgIH1cclxuXHJcbiAgICBfc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSk7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBfc3VwYWJhc2U7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KCk6IFN1cGFiYXNlQ2xpZW50IHtcclxuICBpZiAoIV9zdXBhYmFzZUFkbWluKSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcclxuICAgIGNvbnN0IHN1cGFiYXNlU2VydmljZVJvbGVLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZO1xyXG5cclxuICAgIGlmICghc3VwYWJhc2VVcmwgfHwgIXN1cGFiYXNlU2VydmljZVJvbGVLZXkpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdTdXBhYmFzZSBhZG1pbiBlbnZpcm9ubWVudCB2YXJpYWJsZXMgbm90IGZvdW5kLiBQbGVhc2UgY29uZmlndXJlIFN1cGFiYXNlIGludGVncmF0aW9uLicpO1xyXG4gICAgICAvLyBSZXR1cm4gYSBtb2NrIGNsaWVudCB0aGF0IHdvbid0IGNhdXNlIGVycm9yc1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGZyb206ICgpID0+ICh7XHJcbiAgICAgICAgICBzZWxlY3Q6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IFtdLCBlcnJvcjogbnVsbCB9KSxcclxuICAgICAgICAgIGluc2VydDogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogbnVsbCwgZXJyb3I6IHsgbWVzc2FnZTogJ1N1cGFiYXNlIG5vdCBjb25maWd1cmVkJyB9IH0pLFxyXG4gICAgICAgICAgdXBkYXRlOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBudWxsLCBlcnJvcjogeyBtZXNzYWdlOiAnU3VwYWJhc2Ugbm90IGNvbmZpZ3VyZWQnIH0gfSksXHJcbiAgICAgICAgICBkZWxldGU6ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IG51bGwsIGVycm9yOiB7IG1lc3NhZ2U6ICdTdXBhYmFzZSBub3QgY29uZmlndXJlZCcgfSB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0gYXMgYW55O1xyXG4gICAgfVxyXG5cclxuICAgIF9zdXBhYmFzZUFkbWluID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZVNlcnZpY2VSb2xlS2V5KTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIF9zdXBhYmFzZUFkbWluO1xyXG59XHJcblxyXG4vLyBFeHBvcnQgbGF6eSBnZXR0ZXJzIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XHJcbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IG5ldyBQcm94eSh7fSBhcyBTdXBhYmFzZUNsaWVudCwge1xyXG4gIGdldCh0YXJnZXQsIHByb3ApIHtcclxuICAgIHJldHVybiBnZXRTdXBhYmFzZUNsaWVudCgpW3Byb3AgYXMga2V5b2YgU3VwYWJhc2VDbGllbnRdO1xyXG4gIH1cclxufSk7XHJcblxyXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VBZG1pbiA9IG5ldyBQcm94eSh7fSBhcyBTdXBhYmFzZUNsaWVudCwge1xyXG4gIGdldCh0YXJnZXQsIHByb3ApIHtcclxuICAgIHJldHVybiBnZXRTdXBhYmFzZUFkbWluQ2xpZW50KClbcHJvcCBhcyBrZXlvZiBTdXBhYmFzZUNsaWVudF07XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIEV4cG9ydCB0aGUgY2xpZW50IGRpcmVjdGx5IGZvciBjb21wYXRpYmlsaXR5IHdpdGggdXRpbHMvc3VwYWJhc2UudHNcclxuZXhwb3J0IHsgZ2V0U3VwYWJhc2VDbGllbnQgYXMgY3JlYXRlQ2xpZW50IH07Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsIl9zdXBhYmFzZSIsIl9zdXBhYmFzZUFkbWluIiwiZ2V0U3VwYWJhc2VDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImNvbnNvbGUiLCJ3YXJuIiwiZnJvbSIsInNlbGVjdCIsIlByb21pc2UiLCJyZXNvbHZlIiwiZGF0YSIsImVycm9yIiwiaW5zZXJ0IiwibWVzc2FnZSIsInVwZGF0ZSIsImRlbGV0ZSIsImdldFN1cGFiYXNlQWRtaW5DbGllbnQiLCJzdXBhYmFzZVNlcnZpY2VSb2xlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInN1cGFiYXNlIiwiUHJveHkiLCJnZXQiLCJ0YXJnZXQiLCJwcm9wIiwic3VwYWJhc2VBZG1pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/supabase.ts\n");

/***/ }),

/***/ "(api)/./pages/api/messages/index.ts":
/*!*************************************!*\
  !*** ./pages/api/messages/index.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _lib_middleware_withAuth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/middleware/withAuth */ \"(api)/./lib/middleware/withAuth.ts\");\n/* harmony import */ var _lib_database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/database */ \"(api)/./lib/database.ts\");\n/* harmony import */ var _lib_services_emailService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/services/emailService */ \"(api)/./lib/services/emailService.ts\");\n\n\n\nasync function handler(req, res) {\n    switch(req.method){\n        case \"GET\":\n            return handleGetMessages(req, res);\n        case \"POST\":\n            return handleSendMessage(req, res);\n        default:\n            res.setHeader(\"Allow\", [\n                \"GET\",\n                \"POST\"\n            ]);\n            return res.status(405).json({\n                success: false,\n                error: `Method ${req.method} not allowed`\n            });\n    }\n}\nasync function handleGetMessages(req, res) {\n    try {\n        const userId = req.user.id;\n        const { conversationId, page = 1, limit = 50, platform = \"all\" } = req.query;\n        const queryOptions = {\n            conversationId: conversationId,\n            page: Number(page),\n            limit: Number(limit)\n        };\n        // Filter by platform if specified\n        if (platform !== \"all\") {\n            queryOptions.platform = platform;\n        }\n        const messages = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.messageOperations.findByUserId(userId, queryOptions);\n        // If no conversationId, group messages by conversation\n        if (!conversationId) {\n            const conversations = new Map();\n            messages.forEach((message)=>{\n                const convId = message.conversationId;\n                if (!conversations.has(convId)) {\n                    conversations.set(convId, {\n                        conversationId: convId,\n                        prospect: message.prospects,\n                        platform: message.platform,\n                        lastMessage: message,\n                        unreadCount: 0,\n                        totalMessages: 0\n                    });\n                }\n                const conv = conversations.get(convId);\n                conv.totalMessages++;\n                // Update last message if this one is newer\n                if (new Date(message.created_at) > new Date(conv.lastMessage.created_at)) {\n                    conv.lastMessage = message;\n                }\n                // Count unread messages (received messages that haven't been read)\n                if (message.type === \"received\" && message.status !== \"read\") {\n                    conv.unreadCount++;\n                }\n            });\n            const conversationList = Array.from(conversations.values());\n            return res.json({\n                success: true,\n                conversations: conversationList\n            });\n        }\n        res.json({\n            success: true,\n            messages,\n            pagination: {\n                page: Number(page),\n                limit: Number(limit),\n                total: messages.length,\n                pages: Math.ceil(messages.length / Number(limit))\n            }\n        });\n    } catch (error) {\n        console.error(\"Error fetching messages:\", error);\n        res.status(500).json({\n            success: false,\n            error: \"Failed to fetch messages\"\n        });\n    }\n}\nasync function handleSendMessage(req, res) {\n    try {\n        const userId = req.user.id;\n        const { prospect_id, content, message_type = \"manual\", conversation_id, platform = \"linkedin\", subject, to, from, cc, bcc } = req.body;\n        // Validation\n        if (!prospect_id || !content) {\n            return res.status(400).json({\n                success: false,\n                error: \"Prospect ID and message content are required\"\n            });\n        }\n        // Additional validation for email\n        if (platform === \"email\") {\n            if (!subject) {\n                return res.status(400).json({\n                    success: false,\n                    error: \"Subject is required for email messages\"\n                });\n            }\n            if (!to) {\n                return res.status(400).json({\n                    success: false,\n                    error: \"Recipient email is required\"\n                });\n            }\n        }\n        // Verify prospect belongs to user\n        const prospect = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.prospectOperations.findById(prospect_id, userId);\n        if (!prospect) {\n            return res.status(404).json({\n                success: false,\n                error: \"Prospect not found\"\n            });\n        }\n        // Generate conversation ID if not provided\n        const finalConversationId = conversation_id || `${userId}_${prospect_id}`;\n        let emailMessageId;\n        // Handle email sending\n        if (platform === \"email\") {\n            try {\n                // Get user's email account\n                const user = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.userOperations.findById(userId);\n                if (!user || !user.email_accounts || user.email_accounts.length === 0) {\n                    return res.status(400).json({\n                        success: false,\n                        error: \"No email account configured. Please add your email credentials in Settings.\"\n                    });\n                }\n                const emailAccount = user.email_accounts.find((acc)=>acc.isActive) || user.email_accounts[0];\n                const emailService = new _lib_services_emailService__WEBPACK_IMPORTED_MODULE_2__[\"default\"]();\n                emailMessageId = await emailService.sendEmail(emailAccount, {\n                    to: to,\n                    from: from || emailAccount.email,\n                    subject: subject,\n                    text: content,\n                    html: content.replace(/\\n/g, \"<br>\"),\n                    cc: cc,\n                    bcc: bcc\n                });\n            } catch (emailError) {\n                console.error(\"Error sending email:\", emailError);\n                return res.status(500).json({\n                    success: false,\n                    error: \"Failed to send email. Please check your email configuration.\"\n                });\n            }\n        }\n        // Create new message\n        const message = await _lib_database__WEBPACK_IMPORTED_MODULE_1__.messageOperations.create({\n            user_id: userId,\n            prospect_id: prospect_id,\n            conversation_id: finalConversationId,\n            type: \"sent\",\n            message_type: message_type,\n            content: content.trim(),\n            subject: platform === \"email\" ? subject : undefined,\n            platform: platform,\n            email_data: platform === \"email\" ? {\n                to: to,\n                from: from || (await _lib_database__WEBPACK_IMPORTED_MODULE_1__.userOperations.findById(userId))?.email_accounts?.[0]?.email || \"\",\n                cc: cc,\n                bcc: bcc,\n                messageId: emailMessageId,\n                threadId: finalConversationId\n            } : undefined,\n            status: \"sent\",\n            sent_at: new Date().toISOString(),\n            automated: message_type !== \"manual\",\n            ai_generated: false,\n            retry_count: 0,\n            metadata: {\n                characterCount: content.length,\n                wordCount: content.split(/\\s+/).length,\n                platform: platform\n            },\n            attachments: [],\n            analytics: {\n                opened: false,\n                openedAt: undefined,\n                clickedLinks: [],\n                responseReceived: false,\n                responseTime: undefined,\n                sentiment: \"neutral\",\n                leadQuality: \"cold\"\n            },\n            tags: [],\n            is_archived: false,\n            is_starred: false,\n            is_important: false\n        });\n        // Update prospect status if this is their first message\n        if (prospect.status === \"connected\" || prospect.status === \"new\") {\n            await _lib_database__WEBPACK_IMPORTED_MODULE_1__.prospectOperations.update(prospect_id, userId, {\n                status: platform === \"email\" ? \"message_sent\" : \"message_sent\",\n                last_updated: new Date().toISOString()\n            });\n        }\n        // Add interaction to prospect\n        const updatedInteractions = [\n            ...prospect.interactions,\n            {\n                type: platform === \"email\" ? \"email\" : \"message\",\n                content: content,\n                subject: platform === \"email\" ? subject : undefined,\n                platform: platform,\n                timestamp: new Date().toISOString(),\n                automated: message_type !== \"manual\"\n            }\n        ];\n        await _lib_database__WEBPACK_IMPORTED_MODULE_1__.prospectOperations.update(prospect_id, userId, {\n            interactions: updatedInteractions\n        });\n        console.log(`${platform === \"email\" ? \"Email\" : \"Message\"} sent to prospect: ${prospect.linkedin_data.name}`);\n        res.status(201).json({\n            success: true,\n            message: `${platform === \"email\" ? \"Email\" : \"Message\"} sent successfully`,\n            data: message\n        });\n    } catch (error) {\n        console.error(\"Error sending message/email:\", error);\n        res.status(500).json({\n            success: false,\n            error: \"Failed to send message/email\"\n        });\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_middleware_withAuth__WEBPACK_IMPORTED_MODULE_0__.withAuth)(handler));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTdEMsYUFBYSxVQUFVc0MsVUFBVXVCO2dCQUMxQzdELFVBQVVBO2dCQUNWMkYsV0FBVyxJQUFJdkUsT0FBTzhDLFdBQVc7Z0JBQ2pDQyxXQUFXL0IsaUJBQWlCO1lBQzlCO1NBQ0Q7UUFFRCxNQUFNeEQsNkRBQWtCQSxDQUFDMkcsTUFBTSxDQUFDckQsYUFBYXhDLFFBQVE7WUFDbkRnRyxjQUFjRDtRQUNoQjtRQUVBeEQsUUFBUTJELEdBQUcsQ0FBQyxDQUFDLEVBQUU1RixhQUFhLFVBQVUsVUFBVSxVQUFVLG1CQUFtQixFQUFFYSxTQUFTZ0YsYUFBYSxDQUFDQyxJQUFJLENBQUMsQ0FBQztRQUU1RzdHLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDbkJDLFNBQVM7WUFDVGlCLFNBQVMsQ0FBQyxFQUFFVCxhQUFhLFVBQVUsVUFBVSxVQUFVLGtCQUFrQixDQUFDO1lBQzFFK0YsTUFBTXRGO1FBQ1I7SUFFRixFQUFFLE9BQU9oQixPQUFPO1FBQ2R3QyxRQUFReEMsS0FBSyxDQUFDLGdDQUFnQ0E7UUFDOUNSLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDbkJDLFNBQVM7WUFDVEMsT0FBTztRQUNUO0lBQ0Y7QUFDRjtBQUVBLGlFQUFlZixrRUFBUUEsQ0FBQ0ssUUFBUUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2x5bmNib3QtbmV4dGpzLy4vcGFnZXMvYXBpL21lc3NhZ2VzL2luZGV4LnRzPzNmMmEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XHJcbmltcG9ydCB7IHdpdGhBdXRoLCBBdXRoZW50aWNhdGVkUmVxdWVzdCB9IGZyb20gJy4uLy4uLy4uL2xpYi9taWRkbGV3YXJlL3dpdGhBdXRoJztcclxuaW1wb3J0IHsgbWVzc2FnZU9wZXJhdGlvbnMsIHByb3NwZWN0T3BlcmF0aW9ucywgdXNlck9wZXJhdGlvbnMgfSBmcm9tICcuLi8uLi8uLi9saWIvZGF0YWJhc2UnO1xyXG5pbXBvcnQgRW1haWxTZXJ2aWNlLCB7IHR5cGUgRW1haWxBY2NvdW50IH0gZnJvbSAnLi4vLi4vLi4vbGliL3NlcnZpY2VzL2VtYWlsU2VydmljZSc7XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XHJcblxyXG4gIHN3aXRjaCAocmVxLm1ldGhvZCkge1xyXG4gICAgY2FzZSAnR0VUJzpcclxuICAgICAgcmV0dXJuIGhhbmRsZUdldE1lc3NhZ2VzKHJlcSwgcmVzKTtcclxuICAgIGNhc2UgJ1BPU1QnOlxyXG4gICAgICByZXR1cm4gaGFuZGxlU2VuZE1lc3NhZ2UocmVxLCByZXMpO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCBbJ0dFVCcsICdQT1NUJ10pO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBgTWV0aG9kICR7cmVxLm1ldGhvZH0gbm90IGFsbG93ZWRgXHJcbiAgICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0TWVzc2FnZXMocmVxOiBBdXRoZW50aWNhdGVkUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdXNlcklkID0gcmVxLnVzZXIuaWQ7XHJcbiAgICBjb25zdCB7IGNvbnZlcnNhdGlvbklkLCBwYWdlID0gMSwgbGltaXQgPSA1MCwgcGxhdGZvcm0gPSAnYWxsJyB9ID0gcmVxLnF1ZXJ5O1xyXG4gICAgXHJcbiAgICBjb25zdCBxdWVyeU9wdGlvbnM6IGFueSA9IHtcclxuICAgICAgY29udmVyc2F0aW9uSWQ6IGNvbnZlcnNhdGlvbklkIGFzIHN0cmluZyxcclxuICAgICAgcGFnZTogTnVtYmVyKHBhZ2UpLFxyXG4gICAgICBsaW1pdDogTnVtYmVyKGxpbWl0KVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBGaWx0ZXIgYnkgcGxhdGZvcm0gaWYgc3BlY2lmaWVkXHJcbiAgICBpZiAocGxhdGZvcm0gIT09ICdhbGwnKSB7XHJcbiAgICAgIHF1ZXJ5T3B0aW9ucy5wbGF0Zm9ybSA9IHBsYXRmb3JtIGFzIHN0cmluZztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IG1lc3NhZ2VPcGVyYXRpb25zLmZpbmRCeVVzZXJJZCh1c2VySWQsIHF1ZXJ5T3B0aW9ucyk7XHJcblxyXG4gICAgLy8gSWYgbm8gY29udmVyc2F0aW9uSWQsIGdyb3VwIG1lc3NhZ2VzIGJ5IGNvbnZlcnNhdGlvblxyXG4gICAgaWYgKCFjb252ZXJzYXRpb25JZCkge1xyXG4gICAgICBjb25zdCBjb252ZXJzYXRpb25zID0gbmV3IE1hcCgpO1xyXG4gICAgICBcclxuICAgICAgbWVzc2FnZXMuZm9yRWFjaCgobWVzc2FnZTogYW55KSA9PiB7XHJcbiAgICAgICAgY29uc3QgY29udklkID0gbWVzc2FnZS5jb252ZXJzYXRpb25JZDtcclxuICAgICAgICBpZiAoIWNvbnZlcnNhdGlvbnMuaGFzKGNvbnZJZCkpIHtcclxuICAgICAgICAgIGNvbnZlcnNhdGlvbnMuc2V0KGNvbnZJZCwge1xyXG4gICAgICAgICAgICBjb252ZXJzYXRpb25JZDogY29udklkLFxyXG4gICAgICAgICAgICBwcm9zcGVjdDogbWVzc2FnZS5wcm9zcGVjdHMsXHJcbiAgICAgICAgICAgIHBsYXRmb3JtOiBtZXNzYWdlLnBsYXRmb3JtLFxyXG4gICAgICAgICAgICBsYXN0TWVzc2FnZTogbWVzc2FnZSxcclxuICAgICAgICAgICAgdW5yZWFkQ291bnQ6IDAsXHJcbiAgICAgICAgICAgIHRvdGFsTWVzc2FnZXM6IDBcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBjb252ID0gY29udmVyc2F0aW9ucy5nZXQoY29udklkKTtcclxuICAgICAgICBjb252LnRvdGFsTWVzc2FnZXMrKztcclxuICAgICAgICBcclxuICAgICAgICAvLyBVcGRhdGUgbGFzdCBtZXNzYWdlIGlmIHRoaXMgb25lIGlzIG5ld2VyXHJcbiAgICAgICAgaWYgKG5ldyBEYXRlKG1lc3NhZ2UuY3JlYXRlZF9hdCkgPiBuZXcgRGF0ZShjb252Lmxhc3RNZXNzYWdlLmNyZWF0ZWRfYXQpKSB7XHJcbiAgICAgICAgICBjb252Lmxhc3RNZXNzYWdlID0gbWVzc2FnZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ291bnQgdW5yZWFkIG1lc3NhZ2VzIChyZWNlaXZlZCBtZXNzYWdlcyB0aGF0IGhhdmVuJ3QgYmVlbiByZWFkKVxyXG4gICAgICAgIGlmIChtZXNzYWdlLnR5cGUgPT09ICdyZWNlaXZlZCcgJiYgbWVzc2FnZS5zdGF0dXMgIT09ICdyZWFkJykge1xyXG4gICAgICAgICAgY29udi51bnJlYWRDb3VudCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBjb252ZXJzYXRpb25MaXN0ID0gQXJyYXkuZnJvbShjb252ZXJzYXRpb25zLnZhbHVlcygpKTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiByZXMuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBjb252ZXJzYXRpb25zOiBjb252ZXJzYXRpb25MaXN0XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbWVzc2FnZXMsXHJcbiAgICAgIHBhZ2luYXRpb246IHtcclxuICAgICAgICBwYWdlOiBOdW1iZXIocGFnZSksXHJcbiAgICAgICAgbGltaXQ6IE51bWJlcihsaW1pdCksXHJcbiAgICAgICAgdG90YWw6IG1lc3NhZ2VzLmxlbmd0aCxcclxuICAgICAgICBwYWdlczogTWF0aC5jZWlsKG1lc3NhZ2VzLmxlbmd0aCAvIE51bWJlcihsaW1pdCkpXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgbWVzc2FnZXM6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIG1lc3NhZ2VzJyBcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlU2VuZE1lc3NhZ2UocmVxOiBBdXRoZW50aWNhdGVkUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdXNlcklkID0gcmVxLnVzZXIuaWQ7XHJcbiAgICBjb25zdCB7IFxyXG4gICAgICBwcm9zcGVjdF9pZCwgXHJcbiAgICAgIGNvbnRlbnQsIFxyXG4gICAgICBtZXNzYWdlX3R5cGUgPSAnbWFudWFsJywgXHJcbiAgICAgIGNvbnZlcnNhdGlvbl9pZCwgXHJcbiAgICAgIHBsYXRmb3JtID0gJ2xpbmtlZGluJyxcclxuICAgICAgc3ViamVjdCxcclxuICAgICAgdG8sXHJcbiAgICAgIGZyb20sXHJcbiAgICAgIGNjLFxyXG4gICAgICBiY2NcclxuICAgIH0gPSByZXEuYm9keTtcclxuXHJcbiAgICAvLyBWYWxpZGF0aW9uXHJcbiAgICBpZiAoIXByb3NwZWN0X2lkIHx8ICFjb250ZW50KSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnUHJvc3BlY3QgSUQgYW5kIG1lc3NhZ2UgY29udGVudCBhcmUgcmVxdWlyZWQnIFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBZGRpdGlvbmFsIHZhbGlkYXRpb24gZm9yIGVtYWlsXHJcbiAgICBpZiAocGxhdGZvcm0gPT09ICdlbWFpbCcpIHtcclxuICAgICAgaWYgKCFzdWJqZWN0KSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIGVycm9yOiAnU3ViamVjdCBpcyByZXF1aXJlZCBmb3IgZW1haWwgbWVzc2FnZXMnIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghdG8pIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdSZWNpcGllbnQgZW1haWwgaXMgcmVxdWlyZWQnIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBWZXJpZnkgcHJvc3BlY3QgYmVsb25ncyB0byB1c2VyXHJcbiAgICBjb25zdCBwcm9zcGVjdCA9IGF3YWl0IHByb3NwZWN0T3BlcmF0aW9ucy5maW5kQnlJZChwcm9zcGVjdF9pZCwgdXNlcklkKTtcclxuICAgIGlmICghcHJvc3BlY3QpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdQcm9zcGVjdCBub3QgZm91bmQnIFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBjb252ZXJzYXRpb24gSUQgaWYgbm90IHByb3ZpZGVkXHJcbiAgICBjb25zdCBmaW5hbENvbnZlcnNhdGlvbklkID0gY29udmVyc2F0aW9uX2lkIHx8IGAke3VzZXJJZH1fJHtwcm9zcGVjdF9pZH1gO1xyXG5cclxuICAgIGxldCBlbWFpbE1lc3NhZ2VJZDogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG4gICAgXHJcbiAgICAvLyBIYW5kbGUgZW1haWwgc2VuZGluZ1xyXG4gICAgaWYgKHBsYXRmb3JtID09PSAnZW1haWwnKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgLy8gR2V0IHVzZXIncyBlbWFpbCBhY2NvdW50XHJcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHVzZXJPcGVyYXRpb25zLmZpbmRCeUlkKHVzZXJJZCk7XHJcbiAgICAgICAgaWYgKCF1c2VyIHx8ICF1c2VyLmVtYWlsX2FjY291bnRzIHx8IHVzZXIuZW1haWxfYWNjb3VudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgZXJyb3I6ICdObyBlbWFpbCBhY2NvdW50IGNvbmZpZ3VyZWQuIFBsZWFzZSBhZGQgeW91ciBlbWFpbCBjcmVkZW50aWFscyBpbiBTZXR0aW5ncy4nXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGVtYWlsQWNjb3VudCA9IHVzZXIuZW1haWxfYWNjb3VudHMuZmluZChhY2MgPT4gYWNjLmlzQWN0aXZlKSB8fCB1c2VyLmVtYWlsX2FjY291bnRzWzBdO1xyXG4gICAgICAgIGNvbnN0IGVtYWlsU2VydmljZSA9IG5ldyBFbWFpbFNlcnZpY2UoKTtcclxuXHJcbiAgICAgICAgZW1haWxNZXNzYWdlSWQgPSBhd2FpdCBlbWFpbFNlcnZpY2Uuc2VuZEVtYWlsKGVtYWlsQWNjb3VudCwge1xyXG4gICAgICAgICAgdG86IHRvLFxyXG4gICAgICAgICAgZnJvbTogZnJvbSB8fCBlbWFpbEFjY291bnQuZW1haWwsXHJcbiAgICAgICAgICBzdWJqZWN0OiBzdWJqZWN0LFxyXG4gICAgICAgICAgdGV4dDogY29udGVudCxcclxuICAgICAgICAgIGh0bWw6IGNvbnRlbnQucmVwbGFjZSgvXFxuL2csICc8YnI+JyksXHJcbiAgICAgICAgICBjYzogY2MsXHJcbiAgICAgICAgICBiY2M6IGJjY1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGNhdGNoIChlbWFpbEVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VuZGluZyBlbWFpbDonLCBlbWFpbEVycm9yKTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byBzZW5kIGVtYWlsLiBQbGVhc2UgY2hlY2sgeW91ciBlbWFpbCBjb25maWd1cmF0aW9uLidcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gQ3JlYXRlIG5ldyBtZXNzYWdlXHJcbiAgICBjb25zdCBtZXNzYWdlID0gYXdhaXQgbWVzc2FnZU9wZXJhdGlvbnMuY3JlYXRlKHtcclxuICAgICAgdXNlcl9pZDogdXNlcklkLFxyXG4gICAgICBwcm9zcGVjdF9pZDogcHJvc3BlY3RfaWQsXHJcbiAgICAgIGNvbnZlcnNhdGlvbl9pZDogZmluYWxDb252ZXJzYXRpb25JZCxcclxuICAgICAgdHlwZTogJ3NlbnQnLFxyXG4gICAgICBtZXNzYWdlX3R5cGU6IG1lc3NhZ2VfdHlwZSxcclxuICAgICAgY29udGVudDogY29udGVudC50cmltKCksXHJcbiAgICAgIHN1YmplY3Q6IHBsYXRmb3JtID09PSAnZW1haWwnID8gc3ViamVjdCA6IHVuZGVmaW5lZCxcclxuICAgICAgcGxhdGZvcm06IHBsYXRmb3JtLFxyXG4gICAgICBlbWFpbF9kYXRhOiBwbGF0Zm9ybSA9PT0gJ2VtYWlsJyA/IHtcclxuICAgICAgICB0bzogdG8sXHJcbiAgICAgICAgZnJvbTogZnJvbSB8fCAoYXdhaXQgdXNlck9wZXJhdGlvbnMuZmluZEJ5SWQodXNlcklkKSk/LmVtYWlsX2FjY291bnRzPy5bMF0/LmVtYWlsIHx8ICcnLFxyXG4gICAgICAgIGNjOiBjYyxcclxuICAgICAgICBiY2M6IGJjYyxcclxuICAgICAgICBtZXNzYWdlSWQ6IGVtYWlsTWVzc2FnZUlkLFxyXG4gICAgICAgIHRocmVhZElkOiBmaW5hbENvbnZlcnNhdGlvbklkXHJcbiAgICAgIH0gOiB1bmRlZmluZWQsXHJcbiAgICAgIHN0YXR1czogJ3NlbnQnLFxyXG4gICAgICBzZW50X2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIGF1dG9tYXRlZDogbWVzc2FnZV90eXBlICE9PSAnbWFudWFsJyxcclxuICAgICAgYWlfZ2VuZXJhdGVkOiBmYWxzZSxcclxuICAgICAgcmV0cnlfY291bnQ6IDAsXHJcbiAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgY2hhcmFjdGVyQ291bnQ6IGNvbnRlbnQubGVuZ3RoLFxyXG4gICAgICAgIHdvcmRDb3VudDogY29udGVudC5zcGxpdCgvXFxzKy8pLmxlbmd0aCxcclxuICAgICAgICBwbGF0Zm9ybTogcGxhdGZvcm1cclxuICAgICAgfSxcclxuICAgICAgYXR0YWNobWVudHM6IFtdLFxyXG4gICAgICBhbmFseXRpY3M6IHtcclxuICAgICAgICBvcGVuZWQ6IGZhbHNlLFxyXG4gICAgICAgIG9wZW5lZEF0OiB1bmRlZmluZWQsXHJcbiAgICAgICAgY2xpY2tlZExpbmtzOiBbXSxcclxuICAgICAgICByZXNwb25zZVJlY2VpdmVkOiBmYWxzZSxcclxuICAgICAgICByZXNwb25zZVRpbWU6IHVuZGVmaW5lZCxcclxuICAgICAgICBzZW50aW1lbnQ6ICduZXV0cmFsJyxcclxuICAgICAgICBsZWFkUXVhbGl0eTogJ2NvbGQnXHJcbiAgICAgIH0sXHJcbiAgICAgIHRhZ3M6IFtdLFxyXG4gICAgICBpc19hcmNoaXZlZDogZmFsc2UsXHJcbiAgICAgIGlzX3N0YXJyZWQ6IGZhbHNlLFxyXG4gICAgICBpc19pbXBvcnRhbnQ6IGZhbHNlXHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgLy8gVXBkYXRlIHByb3NwZWN0IHN0YXR1cyBpZiB0aGlzIGlzIHRoZWlyIGZpcnN0IG1lc3NhZ2VcclxuICAgIGlmIChwcm9zcGVjdC5zdGF0dXMgPT09ICdjb25uZWN0ZWQnIHx8IHByb3NwZWN0LnN0YXR1cyA9PT0gJ25ldycpIHtcclxuICAgICAgYXdhaXQgcHJvc3BlY3RPcGVyYXRpb25zLnVwZGF0ZShwcm9zcGVjdF9pZCwgdXNlcklkLCB7XHJcbiAgICAgICAgc3RhdHVzOiBwbGF0Zm9ybSA9PT0gJ2VtYWlsJyA/ICdtZXNzYWdlX3NlbnQnIDogJ21lc3NhZ2Vfc2VudCcsXHJcbiAgICAgICAgbGFzdF91cGRhdGVkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIGludGVyYWN0aW9uIHRvIHByb3NwZWN0XHJcbiAgICBjb25zdCB1cGRhdGVkSW50ZXJhY3Rpb25zID0gW1xyXG4gICAgICAuLi5wcm9zcGVjdC5pbnRlcmFjdGlvbnMsXHJcbiAgICAgIHtcclxuICAgICAgICB0eXBlOiBwbGF0Zm9ybSA9PT0gJ2VtYWlsJyA/ICdlbWFpbCcgOiAnbWVzc2FnZScsXHJcbiAgICAgICAgY29udGVudDogY29udGVudCxcclxuICAgICAgICBzdWJqZWN0OiBwbGF0Zm9ybSA9PT0gJ2VtYWlsJyA/IHN1YmplY3QgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgcGxhdGZvcm06IHBsYXRmb3JtLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGF1dG9tYXRlZDogbWVzc2FnZV90eXBlICE9PSAnbWFudWFsJ1xyXG4gICAgICB9XHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICBhd2FpdCBwcm9zcGVjdE9wZXJhdGlvbnMudXBkYXRlKHByb3NwZWN0X2lkLCB1c2VySWQsIHtcclxuICAgICAgaW50ZXJhY3Rpb25zOiB1cGRhdGVkSW50ZXJhY3Rpb25zXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhgJHtwbGF0Zm9ybSA9PT0gJ2VtYWlsJyA/ICdFbWFpbCcgOiAnTWVzc2FnZSd9IHNlbnQgdG8gcHJvc3BlY3Q6ICR7cHJvc3BlY3QubGlua2VkaW5fZGF0YS5uYW1lfWApO1xyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbWVzc2FnZTogYCR7cGxhdGZvcm0gPT09ICdlbWFpbCcgPyAnRW1haWwnIDogJ01lc3NhZ2UnfSBzZW50IHN1Y2Nlc3NmdWxseWAsXHJcbiAgICAgIGRhdGE6IG1lc3NhZ2VcclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VuZGluZyBtZXNzYWdlL2VtYWlsOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ0ZhaWxlZCB0byBzZW5kIG1lc3NhZ2UvZW1haWwnIFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCB3aXRoQXV0aChoYW5kbGVyKTsiXSwibmFtZXMiOlsid2l0aEF1dGgiLCJtZXNzYWdlT3BlcmF0aW9ucyIsInByb3NwZWN0T3BlcmF0aW9ucyIsInVzZXJPcGVyYXRpb25zIiwiRW1haWxTZXJ2aWNlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsImhhbmRsZUdldE1lc3NhZ2VzIiwiaGFuZGxlU2VuZE1lc3NhZ2UiLCJzZXRIZWFkZXIiLCJzdGF0dXMiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwidXNlcklkIiwidXNlciIsImlkIiwiY29udmVyc2F0aW9uSWQiLCJwYWdlIiwibGltaXQiLCJwbGF0Zm9ybSIsInF1ZXJ5IiwicXVlcnlPcHRpb25zIiwiTnVtYmVyIiwibWVzc2FnZXMiLCJmaW5kQnlVc2VySWQiLCJjb252ZXJzYXRpb25zIiwiTWFwIiwiZm9yRWFjaCIsIm1lc3NhZ2UiLCJjb252SWQiLCJoYXMiLCJzZXQiLCJwcm9zcGVjdCIsInByb3NwZWN0cyIsImxhc3RNZXNzYWdlIiwidW5yZWFkQ291bnQiLCJ0b3RhbE1lc3NhZ2VzIiwiY29udiIsImdldCIsIkRhdGUiLCJjcmVhdGVkX2F0IiwidHlwZSIsImNvbnZlcnNhdGlvbkxpc3QiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJwYWdpbmF0aW9uIiwidG90YWwiLCJsZW5ndGgiLCJwYWdlcyIsIk1hdGgiLCJjZWlsIiwiY29uc29sZSIsInByb3NwZWN0X2lkIiwiY29udGVudCIsIm1lc3NhZ2VfdHlwZSIsImNvbnZlcnNhdGlvbl9pZCIsInN1YmplY3QiLCJ0byIsImNjIiwiYmNjIiwiYm9keSIsImZpbmRCeUlkIiwiZmluYWxDb252ZXJzYXRpb25JZCIsImVtYWlsTWVzc2FnZUlkIiwiZW1haWxfYWNjb3VudHMiLCJlbWFpbEFjY291bnQiLCJmaW5kIiwiYWNjIiwiaXNBY3RpdmUiLCJlbWFpbFNlcnZpY2UiLCJzZW5kRW1haWwiLCJlbWFpbCIsInRleHQiLCJodG1sIiwicmVwbGFjZSIsImVtYWlsRXJyb3IiLCJjcmVhdGUiLCJ1c2VyX2lkIiwidHJpbSIsInVuZGVmaW5lZCIsImVtYWlsX2RhdGEiLCJtZXNzYWdlSWQiLCJ0aHJlYWRJZCIsInNlbnRfYXQiLCJ0b0lTT1N0cmluZyIsImF1dG9tYXRlZCIsImFpX2dlbmVyYXRlZCIsInJldHJ5X2NvdW50IiwibWV0YWRhdGEiLCJjaGFyYWN0ZXJDb3VudCIsIndvcmRDb3VudCIsInNwbGl0IiwiYXR0YWNobWVudHMiLCJhbmFseXRpY3MiLCJvcGVuZWQiLCJvcGVuZWRBdCIsImNsaWNrZWRMaW5rcyIsInJlc3BvbnNlUmVjZWl2ZWQiLCJyZXNwb25zZVRpbWUiLCJzZW50aW1lbnQiLCJsZWFkUXVhbGl0eSIsInRhZ3MiLCJpc19hcmNoaXZlZCIsImlzX3N0YXJyZWQiLCJpc19pbXBvcnRhbnQiLCJ1cGRhdGUiLCJsYXN0X3VwZGF0ZWQiLCJ1cGRhdGVkSW50ZXJhY3Rpb25zIiwiaW50ZXJhY3Rpb25zIiwidGltZXN0YW1wIiwibG9nIiwibGlua2VkaW5fZGF0YSIsIm5hbWUiLCJkYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/messages/index.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmessages&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cmessages%5Cindex.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();