"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_api_lib_encryption_ts";
exports.ids = ["_api_lib_encryption_ts"];
exports.modules = {

/***/ "(api)/./lib/encryption.ts":
/*!***************************!*\
  !*** ./lib/encryption.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decrypt: () => (/* binding */ decrypt),\n/* harmony export */   encrypt: () => (/* binding */ encrypt)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nconst ALGORITHM = \"aes-256-cbc\";\nconst ENCRYPTION_KEY = process.env.ENCRYPTION_KEY || \"default-32-character-secret-key\";\nconst IV_LENGTH = 16;\nfunction encrypt(text) {\n    const iv = crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(IV_LENGTH);\n    const key = crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash(\"sha256\").update(ENCRYPTION_KEY).digest();\n    const cipher = crypto__WEBPACK_IMPORTED_MODULE_0___default().createCipheriv(ALGORITHM, key, iv);\n    let encrypted = cipher.update(text, \"utf8\", \"hex\");\n    encrypted += cipher.final(\"hex\");\n    return iv.toString(\"hex\") + \":\" + encrypted;\n}\nfunction decrypt(text) {\n    const parts = text.split(\":\");\n    const iv = Buffer.from(parts[0], \"hex\");\n    const encryptedText = parts[1];\n    const key = crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash(\"sha256\").update(ENCRYPTION_KEY).digest();\n    const decipher = crypto__WEBPACK_IMPORTED_MODULE_0___default().createDecipheriv(ALGORITHM, key, iv);\n    let decrypted = decipher.update(encryptedText, \"hex\", \"utf8\");\n    decrypted += decipher.final(\"utf8\");\n    return decrypted;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvZW5jcnlwdGlvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTRCO0FBRTVCLE1BQU1DLFlBQVk7QUFDbEIsTUFBTUMsaUJBQWlCQyxRQUFRQyxHQUFHLENBQUNGLGNBQWMsSUFBSTtBQUNyRCxNQUFNRyxZQUFZO0FBRVgsU0FBU0MsUUFBUUMsSUFBWTtJQUNsQyxNQUFNQyxLQUFLUix5REFBa0IsQ0FBQ0s7SUFDOUIsTUFBTUssTUFBTVYsd0RBQWlCLENBQUMsVUFBVVksTUFBTSxDQUFDVixnQkFBZ0JXLE1BQU07SUFDckUsTUFBTUMsU0FBU2QsNERBQXFCLENBQUNDLFdBQVdTLEtBQUtGO0lBQ3JELElBQUlRLFlBQVlGLE9BQU9GLE1BQU0sQ0FBQ0wsTUFBTSxRQUFRO0lBQzVDUyxhQUFhRixPQUFPRyxLQUFLLENBQUM7SUFDMUIsT0FBT1QsR0FBR1UsUUFBUSxDQUFDLFNBQVMsTUFBTUY7QUFDcEM7QUFFTyxTQUFTRyxRQUFRWixJQUFZO0lBQ2xDLE1BQU1hLFFBQVFiLEtBQUtjLEtBQUssQ0FBQztJQUN6QixNQUFNYixLQUFLYyxPQUFPQyxJQUFJLENBQUNILEtBQUssQ0FBQyxFQUFFLEVBQUU7SUFDakMsTUFBTUksZ0JBQWdCSixLQUFLLENBQUMsRUFBRTtJQUM5QixNQUFNVixNQUFNVix3REFBaUIsQ0FBQyxVQUFVWSxNQUFNLENBQUNWLGdCQUFnQlcsTUFBTTtJQUNyRSxNQUFNWSxXQUFXekIsOERBQXVCLENBQUNDLFdBQVdTLEtBQUtGO0lBQ3pELElBQUltQixZQUFZRixTQUFTYixNQUFNLENBQUNZLGVBQWUsT0FBTztJQUN0REcsYUFBYUYsU0FBU1IsS0FBSyxDQUFDO0lBQzVCLE9BQU9VO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9seW5jYm90LW5leHRqcy8uL2xpYi9lbmNyeXB0aW9uLnRzPzMzNzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xuXG5jb25zdCBBTEdPUklUSE0gPSAnYWVzLTI1Ni1jYmMnO1xuY29uc3QgRU5DUllQVElPTl9LRVkgPSBwcm9jZXNzLmVudi5FTkNSWVBUSU9OX0tFWSB8fCAnZGVmYXVsdC0zMi1jaGFyYWN0ZXItc2VjcmV0LWtleSc7XG5jb25zdCBJVl9MRU5HVEggPSAxNjtcblxuZXhwb3J0IGZ1bmN0aW9uIGVuY3J5cHQodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgaXYgPSBjcnlwdG8ucmFuZG9tQnl0ZXMoSVZfTEVOR1RIKTtcbiAgY29uc3Qga2V5ID0gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZShFTkNSWVBUSU9OX0tFWSkuZGlnZXN0KCk7XG4gIGNvbnN0IGNpcGhlciA9IGNyeXB0by5jcmVhdGVDaXBoZXJpdihBTEdPUklUSE0sIGtleSwgaXYpO1xuICBsZXQgZW5jcnlwdGVkID0gY2lwaGVyLnVwZGF0ZSh0ZXh0LCAndXRmOCcsICdoZXgnKTtcbiAgZW5jcnlwdGVkICs9IGNpcGhlci5maW5hbCgnaGV4Jyk7XG4gIHJldHVybiBpdi50b1N0cmluZygnaGV4JykgKyAnOicgKyBlbmNyeXB0ZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWNyeXB0KHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IHBhcnRzID0gdGV4dC5zcGxpdCgnOicpO1xuICBjb25zdCBpdiA9IEJ1ZmZlci5mcm9tKHBhcnRzWzBdLCAnaGV4Jyk7XG4gIGNvbnN0IGVuY3J5cHRlZFRleHQgPSBwYXJ0c1sxXTtcbiAgY29uc3Qga2V5ID0gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZShFTkNSWVBUSU9OX0tFWSkuZGlnZXN0KCk7XG4gIGNvbnN0IGRlY2lwaGVyID0gY3J5cHRvLmNyZWF0ZURlY2lwaGVyaXYoQUxHT1JJVEhNLCBrZXksIGl2KTtcbiAgbGV0IGRlY3J5cHRlZCA9IGRlY2lwaGVyLnVwZGF0ZShlbmNyeXB0ZWRUZXh0LCAnaGV4JywgJ3V0ZjgnKTtcbiAgZGVjcnlwdGVkICs9IGRlY2lwaGVyLmZpbmFsKCd1dGY4Jyk7XG4gIHJldHVybiBkZWNyeXB0ZWQ7XG59XG4iXSwibmFtZXMiOlsiY3J5cHRvIiwiQUxHT1JJVEhNIiwiRU5DUllQVElPTl9LRVkiLCJwcm9jZXNzIiwiZW52IiwiSVZfTEVOR1RIIiwiZW5jcnlwdCIsInRleHQiLCJpdiIsInJhbmRvbUJ5dGVzIiwia2V5IiwiY3JlYXRlSGFzaCIsInVwZGF0ZSIsImRpZ2VzdCIsImNpcGhlciIsImNyZWF0ZUNpcGhlcml2IiwiZW5jcnlwdGVkIiwiZmluYWwiLCJ0b1N0cmluZyIsImRlY3J5cHQiLCJwYXJ0cyIsInNwbGl0IiwiQnVmZmVyIiwiZnJvbSIsImVuY3J5cHRlZFRleHQiLCJkZWNpcGhlciIsImNyZWF0ZURlY2lwaGVyaXYiLCJkZWNyeXB0ZWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/encryption.ts\n");

/***/ })

};
;